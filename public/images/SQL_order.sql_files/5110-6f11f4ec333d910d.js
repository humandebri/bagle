!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0c8a9246-07c2-48bc-9b20-b368e883fd4f",e._sentryDebugIdIdentifier="sentry-dbid-0c8a9246-07c2-48bc-9b20-b368e883fd4f")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5110],{134:(e,t,a)=>{a.d(t,{YX:()=>d,_4:()=>c,gI:()=>o,ge:()=>i,lB:()=>l});var s=a(80263),n=a(53239),r=a(2);let l=e=>{let{children:t,header:a,footer:n}=e;return(0,s.jsxs)(i,{"data-sentry-element":"FormPanelContainer","data-sentry-component":"FormPanel","data-sentry-source-file":"FormPanel.tsx",children:[a&&(0,s.jsx)(o,{children:a}),(0,s.jsx)(d,{className:"divide-y","data-sentry-element":"FormPanelContent","data-sentry-source-file":"FormPanel.tsx",children:t}),n&&(0,s.jsx)(c,{children:n})]})},i=(0,n.forwardRef)((e,t)=>{let{children:a,...n}=e;return(0,s.jsx)("div",{ref:t,...n,className:(0,r.cn)("bg-surface-100 border overflow-hidden rounded-md shadow max-w-full",n.className),children:a})});i.displayName=i.displayName;let o=(0,n.forwardRef)((e,t)=>{let{children:a,...n}=e;return(0,s.jsx)("div",{ref:t,...n,className:(0,r.cn)("border-default border-b px-8 py-4",n.className),children:a})});o.displayName=o.displayName;let d=(0,n.forwardRef)((e,t)=>{let{children:a,...n}=e;return(0,s.jsx)("div",{ref:t,...n,className:(0,r.cn)("divide-border flex flex-col gap-0",n.className),children:a})});d.displayName=d.displayName;let c=(0,n.forwardRef)((e,t)=>{let{children:a,...n}=e;return(0,s.jsx)("div",{ref:t,...n,className:(0,r.cn)("border-t",n.className),children:a})});c.displayName=c.displayName},2081:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(80263),n=a(64238),r=a(81372),l=a(53239),i=a(90206),o=a(16601),d=a(2);let c=e=>{var t;let{text:a,asyncText:c,iconOnly:u=!1,children:m,onClick:p,copyLabel:x="Copy",copiedLabel:h="Copied",...g}=e,[y,f]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(!y)return;let e=setTimeout(()=>f(!1),2e3);return()=>clearTimeout(e)},[y]),(0,s.jsx)(o.$,{onClick:async e=>{let t=c?await c():a;f(!0),await (0,i.lW)(t),null==p||p(e)},...g,className:(0,d.cn)({"px-1":u},g.className),icon:y?(0,s.jsx)(n.A,{strokeWidth:2,className:"text-brand"}):null!=(t=g.icon)?t:(0,s.jsx)(r.A,{}),"data-sentry-element":"Button","data-sentry-component":"CopyButton","data-sentry-source-file":"CopyButton.tsx",children:!u&&(0,s.jsx)(s.Fragment,{children:null!=m?m:y?h:x})})}},5969:(e,t,a)=>{a.d(t,{DE:()=>o,sj:()=>l,y9:()=>r});var s=a(80263),n=a(53239);let r=e=>{let{children:t,id:a,header:n,disabled:r,className:l}=e;return(0,s.jsxs)("div",{id:a,className:["grid grid-cols-12 gap-6 px-4 md:px-8 py-4 md:py-8","".concat(r?" opacity-30":" opacity-100"),"".concat(l)].join(" "),"data-sentry-component":"FormSection","data-sentry-source-file":"FormSection.tsx",children:[n,t]})},l=e=>{let{children:t,className:a="",description:n}=e;return void 0!==n?(0,s.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(a),children:[(0,s.jsx)("label",{className:"text-foreground text-sm",children:t}),n]}):(0,s.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(a),children:t})},i=()=>(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2","data-sentry-component":"Shimmer","data-sentry-source-file":"FormSection.tsx",children:[(0,s.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,s.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,s.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]}),o=e=>{let{children:t,loading:a=!0,fullWidth:r,className:l}=e;return(0,s.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(r&&"!col-span-12","\n        ").concat(l,"\n      "),"data-sentry-component":"FormSectionContent","data-sentry-source-file":"FormSection.tsx",children:a?n.Children.map(t,()=>(0,s.jsx)(i,{})):t})}},8563:(e,t,a)=>{a.d(t,{Q:()=>i});var s=a(56947),n=a(3807),r=a(42719);async function l(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let[s,r]=await Promise.all([(0,n.Jt)("/platform/organizations/{slug}/members",{params:{path:{slug:a}},signal:t}),(0,n.Jt)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:a}},signal:t})]),{data:l,error:i}=s,{data:o,error:d}=r;return i&&(0,n.H4)(i),d&&(0,n.H4)(d),[...l,...o.invitations.map(e=>({...{invited_at:e.invited_at,invited_id:e.id,mfa_enabled:!1,username:e.invited_email.slice(0,1),primary_email:e.invited_email},role_ids:[e.role_id]}))]}let i=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(r.O.members(t),e=>{let{signal:a}=e;return l({slug:t},a)},{enabled:a&&void 0!==t,...n})}},10951:(e,t,a)=>{a.d(t,{n:()=>i});var s=a(56947),n=a(3807),r=a(78266);async function l(e,t){let{slug:a}=e;if(!a)throw Error("Organization slug is required");let{data:s,error:r}=await (0,n.Jt)("/platform/organizations/{slug}/oauth/apps",{params:{path:{slug:a},query:{type:"authorized"}}});return r&&(0,n.H4)(r),s}let i=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(r.R.authorizedApps(t),e=>{let{signal:a}=e;return l({slug:t},a)},{enabled:a&&void 0!==t,...n})}},16993:(e,t,a)=>{a.d(t,{xf:()=>g,sD:()=>v,Oe:()=>N,DG:()=>b,hw:()=>y});var s=a(80263),n=a(23278),r=a(98667),l=a(64238),i=a(53239),o=a(79279),d=a(76403),c=a(2),u=a(38952),m=a(50854);let p=i.createContext(null),x=(0,c.cn)("relative text-foreground-lighter text-left px-2 py-1.5 rounded","hover:text-foreground hover:!bg-overlay-hover w-full flex items-center space-x-2","peer-data-[value=true]:bg-overlay-hover peer-data-[value=true]:text-strong");function h(){let e=i.useContext(p);if(!e)throw Error("useMultiSelect must be used within a MultiSelectProvider");return e}function g(e){var t;let{values:a=[],onValuesChange:n,disabled:r,dir:l,size:o,className:d,children:u,...x}=e,h=i.useRef(null),[g,y]=i.useState(!1),[f,j]=i.useState(""),[v,b]=i.useState(-1),N=i.useCallback(e=>{a.includes(e)?n(a.filter(t=>t!==e)||[]):n([...a,e])},[a]);t=()=>{g&&y(!g)},(0,i.useEffect)(()=>{let e=e=>{!h.current||h.current.contains(e.target)||t(e)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[h,t]);let S=i.useCallback(e=>{switch(e.key){case"Backspace":case"Delete":a.length>0&&0===f.length&&(-1!==v&&v<a.length?(n(a.filter(e=>e!==a[v])),b(v-1<0?0:v-1)):n(a.filter(e=>e!==a[a.length-1])));break;case"Escape":if(-1!==v?b(-1):y(!1),h.current){let e=h.current.querySelector('button[role="combobox"]');e&&e.focus()}break;case"Enter":y(!0)}},[a,f,v]);return(0,s.jsx)(p.Provider,{value:{values:a,toggleValue:N,onValuesChange:n,open:g,setOpen:y,inputValue:f,setInputValue:j,activeIndex:v,setActiveIndex:b,size:o||"small",disabled:r},"data-sentry-element":"unknown","data-sentry-component":"MultiSelector","data-sentry-source-file":"multi-select.tsx",children:(0,s.jsx)(m.uB,{ref:h,onKeyDown:S,className:(0,c.cn)("relative w-auto overflow-visible bg-transparent flex flex-col",d),dir:l,...x,"data-sentry-element":"Command","data-sentry-source-file":"multi-select.tsx",children:u})})}(0,o.F)("",{variants:{size:{...d.vs}},defaultVariants:{size:d.FE}});let y=i.forwardRef((e,t)=>{let{label:a,persistLabel:l=!1,className:o,deletableBadge:d=!0,badgeLimit:m=9999,showIcon:p=!0,mode:x="combobox",children:g,...y}=e,{activeIndex:f,values:v,setInputValue:b,toggleValue:N,disabled:S,setOpen:A}=h(),w=i.useRef(null);i.useImperativeHandle(t,()=>w.current);let _=i.useRef(null),C=i.useRef(null),[I,E]=i.useState([]),[T,R]=i.useState(0),[k,M]=i.useState(!1),P="wrap"===m,D="number"==typeof m,L="inline-combobox"===x;i.useEffect(()=>{(null==w?void 0:w.current)&&C.current&&(P?(E(v),R(0)):(E(v.slice(0,m)),R(Math.max(0,v.length-m))))},[v,m]);let O="rounded shrink-0 px-1.5",z=i.useCallback(e=>{A(!0),b(""),L&&(e.stopPropagation(),e.preventDefault(),setTimeout(()=>{var e;null==(e=_.current)||e.focus()},100))},[]);return(0,s.jsxs)("button",{ref:w,onClick:e=>!k&&z(e),disabled:S,type:"button",role:"combobox",className:(0,c.cn)("flex w-full min-w-[200px] min-h-[40px] items-center justify-between rounded-md border","border-alternative bg-foreground/[.026] px-3 py-2 text-sm","ring-offset-background placeholder:text-muted-foreground","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50","hover:border-primary transition-colors duration-200",o),...y,children:[(0,s.jsxs)("div",{ref:C,className:(0,c.cn)("flex gap-1 -ml-1 overflow-hidden flex-1",P&&"flex-wrap",!P&&"overflow-x-auto scrollbar-thin scrollbar-track-transparent transition-colors scrollbar-thumb-muted-foreground dark:scrollbar-thumb-muted scrollbar-thumb-rounded-lg"),children:[I.map(e=>(0,s.jsxs)(u.E,{className:O,children:[e,d&&(0,s.jsx)("div",{onMouseEnter:()=>M(!0),onMouseLeave:()=>M(!1),onClick:t=>{t.stopPropagation(),N(e),M(!1)},className:"ml-1 text-foreground-lighter hover:text-foreground-light transition-colors pointer-events-auto",children:(0,s.jsx)(n.A,{size:12})})]},e)),T>0&&(0,s.jsx)(u.E,{className:O,children:D&&m<1?"".concat(T," item").concat(T>1?"s":""," selected"):"+".concat(T)}),(0,s.jsx)("span",{className:(0,c.cn)("text-foreground-muted whitespace-nowrap leading-[1.375rem] ml-1 opacity-0 transition-opacity hidden",!L&&(l||0===v.length)&&"opacity-100 visible inline"),children:a}),L&&(0,s.jsx)(j,{ref:_,showSearchIcon:!1,onValueChange:-1===f?b:void 0,placeholder:a,autoFocus:!1,wrapperClassName:(0,c.cn)("px-0 flex-1 border-none truncate",P&&"min-w-[85px]"),className:"py-0 px-1 truncate"})]}),p&&(0,s.jsx)(r.A,{size:16,strokeWidth:2,className:"text-foreground-lighter shrink-0 ml-1.5"})]})});y.displayName="MultiSelectorTrigger",g.Trigger=y;let f=(0,o.F)("bg-control border",{variants:{size:{...d.vs}},defaultVariants:{size:d.FE}}),j=i.forwardRef((e,t)=>{let{className:a,wrapperClassName:n,showResetIcon:r,showSearchIcon:l,...o}=e,{open:d,setOpen:u,inputValue:p,setInputValue:x,activeIndex:g,setActiveIndex:y,size:j,disabled:v}=h(),b=i.useRef(null);i.useImperativeHandle(t,()=>b.current);let N=()=>{setTimeout(()=>{(null==b?void 0:b.current)&&d&&b.current.focus()},100)};return(0,i.useEffect)(()=>{if(N(),!d){var e;null==(e=b.current)||e.blur()}},[d]),(0,s.jsx)(m.G7,{ref:b,value:p,onValueChange:-1===g?x:void 0,onFocus:()=>u(!0),onClick:()=>y(-1),tabIndex:d?0:-1,disabled:v,showSearchIcon:l,showResetIcon:r,handleReset:()=>{x(""),N()},wrapperClassName:n,className:(0,c.cn)(f({size:j}),"text-sm bg-transparent h-full flex-grow border-none outline-none placeholder:text-foreground-muted flex-1",-1!==g&&"caret-transparent",a),...o})});j.displayName="MultiSelectorInput",g.Input=j;let v=i.forwardRef((e,t)=>{let{className:a,children:n}=e,{open:r}=h();return(0,s.jsx)("div",{ref:t,className:(0,c.cn)("absolute w-full bg-overlay shadow-md z-10 border border-overlay top-[calc(100%+0.25rem)] rounded-md transition-all -translate-y-3",r?"opacity-100 translate-y-0 visible duration-150 ease-[.76,0,.23,1]":"opacity-0 -translate-y-3 invisible duration-0",a),children:r&&n})});v.displayName="MultiSelectorContent",g.Content=v;let b=i.forwardRef((e,t)=>{let{className:a,children:n,creatable:r=!1}=e,{open:l,inputValue:i,setInputValue:o,toggleValue:d}=h(),u=n?Array.isArray(n)?n:"object"==typeof n&&"props"in n?n.props.children:[]:[],p=u.filter(e=>!!e.props.value).map(e=>e.props.value.toLowerCase()).some(e=>e===i.toLowerCase());return(0,s.jsxs)(m.oI,{ref:t,className:(0,c.cn)("p-2 flex flex-col gap-2 scrollbar-thin scrollbar-track-transparent transition-colors","scrollbar-thumb-muted-foreground dark:scrollbar-thumb-muted","scrollbar-thumb-rounded-lg w-full max-h-[300px] overflow-y-auto",a),children:[n,r&&i.length>0&&!p?(0,s.jsxs)(m.h_,{role:"option",onSelect:()=>{l&&d(i),o("")},className:x,children:['Create "',i,'"']}):r&&0===u.length?(0,s.jsx)("div",{className:"p-2 py-1.5 text-xs text-foreground-lighter font-italic",children:"Type to add a value"}):(0,s.jsx)(m.xL,{children:(0,s.jsx)("span",{className:"text-foreground-muted",children:"No results found"})})]})});b.displayName="MultiSelectorList",g.List=b;let N=i.forwardRef((e,t)=>{let{className:a,value:n,children:r,...i}=e,{values:o,setInputValue:d,toggleValue:u,open:p}=h(),g=o.includes(n);return(0,s.jsxs)(m.h_,{ref:t,tabIndex:p?0:-1,role:"option",onSelect:()=>{p&&u(n),d("")},className:(0,c.cn)(x,a),...i,children:[(0,s.jsx)("div",{className:(0,c.cn)("flex items-center justify-center","peer h-4 w-4 shrink-0 rounded border border-control bg-control/25 ring-offset-background","transition-colors duration-150 ease-in-out","hover:border-strong","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-foreground data-[state=checked]:text-background",g?"bg-foreground text-background":"[&_svg]:invisible"),children:(0,s.jsx)(l.A,{className:"h-3 w-3",strokeWidth:4})}),(0,s.jsx)("div",{className:"text-xs flex-grow leading-none pointer-events-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:pointer-events-none peer-disabled:opacity-50",children:r})]})});N.displayName="MultiSelectorItem",g.Item=N},23014:(e,t,a)=>{a.d(t,{h2:()=>l});var s=a(56028),n=a(12532);let r=(0,s.BX)({panelKey:void 0,setPanelKey:e=>{r.panelKey=e}}),l=e=>(0,n.s)(r,e)},23104:(e,t,a)=>{a.d(t,{O:()=>s});let s={rolesV2:e=>["organization-members",e,"roles-v2"],invitations:e=>["organization-members",e,"invitations"],invitation:(e,t)=>["organization-members",e,"invitations",t],token:(e,t)=>["organization-members",e,"token",t]}},24059:(e,t,a)=>{a.d(t,{A:()=>m});var s=a(80263),n=a(16477),r=a(99923),l=a(66452),i=a(63320),o=a.n(i),d=a(53239),c=a(16601);let u=(0,d.forwardRef)((e,t)=>{let{icon:a,title:i,description:u,url:m,urlLabel:p="Read more",defaultVisibility:x=!1,hideCollapse:h=!1,button:g,className:y="",block:f=!1}=e,[j,v]=(0,d.useState)(x);return(0,s.jsx)("div",{ref:t,role:"alert",className:"".concat(f?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(y),children:(0,s.jsxs)("div",{className:"flex flex-col px-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[a&&(0,s.jsx)("span",{className:"text-foreground-lighter",children:a}),(0,s.jsx)("div",{className:"flex-grow",children:(0,s.jsx)("h5",{className:"text-sm text-foreground",children:i})})]}),u&&!h?(0,s.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>v(!j),children:j?(0,s.jsx)(n.A,{size:14,strokeWidth:1.5}):(0,s.jsx)(r.A,{size:14,strokeWidth:1.5})}):null]}),(u||m||g)&&(0,s.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(j?"mt-3":""),style:{maxHeight:500*!!j},children:[(0,s.jsx)("div",{className:"text-foreground-light text-sm",children:u}),m&&(0,s.jsx)("div",{children:(0,s.jsx)(c.$,{asChild:!0,type:"default",icon:(0,s.jsx)(l.A,{}),children:(0,s.jsx)(o(),{href:m,target:"_blank",rel:"noreferrer",children:p})})}),g&&(0,s.jsx)("div",{children:g})]})]})})});u.displayName="InformationBox";let m=u},39703:(e,t,a)=>{a.d(t,{U:()=>r});var s=a(53434),n=a.n(s);let r=e=>{let t=n()(),a=n()(e.from).hour(t.hour()).minute(t.minute()).second(t.second()),s=n()(e.to).hour(t.hour()).minute(t.minute()).second(t.second());return a.date()!==s.date()?{from:a.utc().toISOString(),to:s.utc().toISOString()}:a.date()===t.date()?{from:a.set("hour",0).set("minute",0).set("second",0).utc().toISOString(),to:s.utc().toISOString()}:{from:a.utc().toISOString(),to:s.set("hour",23).set("minute",59).set("second",59).utc().toISOString()}}},46873:(e,t,a)=>{a.d(t,{Wu:()=>d,ZB:()=>o,Zp:()=>l,aR:()=>i,wL:()=>c});var s=a(80263),n=a(53239),r=a(2);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-surface-100 text-card-foreground shadow-sm",a),...n})});l.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 py-4 px-6 border-b",a),...n})});i.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("h3",{ref:t,className:(0,r.cn)("text-xs font-mono uppercase",a),...n})});o.displayName="CardTitle",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-foreground-muted",a),...n})}).displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("py-4 px-6 border-b last:border-none",a),...n})});d.displayName="CardContent";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)(" flex items-center py-4 px-6",a),...n})});c.displayName="CardFooter"},47781:(e,t,a)=>{a.d(t,{K:()=>h,T:()=>f});var s=a(80263),n=a(53239),r=a(3732),l=a(2),i=a(53434),o=a.n(i),d=a(27344),c=a.n(d),u=a(37361),m=a.n(u);o().extend(c()),o().extend(m());let p=e=>o().unix(Number(e)/1e3/1e3).toISOString(),x=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},h=e=>{let{utcTimestamp:t,format:a}=e,s=x(t)?p(t):t;return o().utc(s).local().format(a)},g=e=>{let{utcTimestamp:t,format:a}=e,s=x(t)?p(t):t;return o().utc(s).format(a)},y=e=>{let{utcTimestamp:t}=e,a=x(t)?p(t):t;return o().utc(a).fromNow()},f=e=>{let{utcTimestamp:t,className:a,displayAs:i="local",format:o="DD MMM  HH:mm:ss",labelFormat:d="DD MMM HH:mm:ss"}=e,c=h({utcTimestamp:t,format:o}),u=g({utcTimestamp:t,format:o}),m=y({utcTimestamp:t}),[p,x]=(0,n.useState)("start"),f=(0,n.useRef)(null),j=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,n.useEffect)(()=>{let e=()=>{if(f.current){let e=f.current.getBoundingClientRect(),t=window.innerHeight;x(e.top<t/2?"start":"end")}};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let v=e=>{let{label:t,value:a}=e,[r,i]=(0,n.useState)(!1);return(0,s.jsxs)("div",{onPointerDown:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault(),navigator.clipboard.writeText(a),i(!0),setTimeout(()=>{i(!1)},1e3)},className:(0,l.cn)("relative cursor-pointer flex gap-y-2 gap-x-0.5 hover:bg-surface-100 px-2 py-1 group",{"bg-surface-100":r}),"data-sentry-component":"TooltipRow","data-sentry-source-file":"index.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-2 text-left truncate",children:[(0,s.jsx)("p",{children:t}),(0,s.jsx)("div",{className:"border-t w-full border-dashed"})]}),(0,s.jsxs)("div",{className:"relative flex items-center gap-x-2 flex-grow",children:[(0,s.jsx)("div",{className:"border-t w-full border-dashed z-10"}),r&&(0,s.jsx)("span",{className:"flex items-center justify-end w-full absolute inset-0 flex items-right text-brand-600 bg-surface-100",children:"Copied!"}),(0,s.jsx)("span",{className:"flex items-center gap-x-2 justify-end whitespace-nowrap",children:a})]})]})};return(0,s.jsxs)(r.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"TimestampInfo","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(r.k$,{asChild:!0,ref:f,className:"text-xs ".concat(a," border-b border-transparent hover:border-dashed hover:border-foreground-light"),"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"index.tsx",children:(0,s.jsx)("span",{children:"local"===i?h({utcTimestamp:t,format:d}):g({utcTimestamp:t,format:d})})}),(0,s.jsxs)(r.ZI,{align:p,side:"right",className:"font-mono p-0 py-1 min-w-80","data-sentry-element":"TooltipContent","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(v,{label:"UTC",value:u,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(v,{label:j,value:c,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(v,{label:"Relative",value:m,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(v,{label:"Timestamp",value:String(t),"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"})]})]})}},53755:(e,t,a)=>{a.d(t,{I:()=>u});var s=a(80263),n=a(53239),r=a(10738),l=a(16601),i=a(2),o=a(83405),d=a(44728),c=a(27863);let u=e=>{let{title:t,options:a=[],activeOptions:u=[],valueKey:m,labelKey:p,iconKey:x="icon",name:h="default",variant:g="rectangular",buttonType:y,disabled:f,labelClass:j,className:v,maxHeightClass:b="h-[205px]",clearButtonText:N="Clear",onSaveFilters:S}=e,[A,w]=(0,n.useState)(!1),[_,C]=(0,n.useState)([]),I=u.map(e=>{let t=a.find(t=>t[m]===e);return t&&t[p]?t[p]:""});return(0,n.useEffect)(()=>{!A&&u.length>0&&C(u)},[A,u]),(0,s.jsxs)(r.AM,{open:A,onOpenChange:w,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"FilterPopover","data-sentry-source-file":"FilterPopover.tsx",children:[(0,s.jsx)(r.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:(0,s.jsx)(l.$,{asChild:!0,disabled:f,type:null!=y?y:u.length>0?"default":"dashed",onClick:()=>w(!1),className:"rounded"===g?"rounded-full":"","data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:h}),u.length>0&&(0,s.jsx)("span",{className:"mr-1",children:":"}),u.length>=3?(0,s.jsxs)("span",{children:[I[0]," and ",u.length-1," others"]}):u.length>0?(0,s.jsx)("span",{children:I.join(", ")}):null]})})}),(0,s.jsxs)(r.hl,{className:(0,i.cn)("p-0 w-44",v),align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:[(0,s.jsx)("div",{className:"border-b border-overlay bg-surface-200 rounded-t pb-1 px-3",children:(0,s.jsx)("span",{className:"text-xs text-foreground-light",children:null!=t?t:"Select ".concat(h.toLowerCase())})}),(0,s.jsx)(o.FK,{className:a.length>7?b:"","data-sentry-element":"ScrollArea","data-sentry-source-file":"FilterPopover.tsx",children:(0,s.jsx)("div",{className:"p-3 flex flex-col gap-y-2",children:a.map(e=>{let t=e[m],a=x?e[x]:void 0;return(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)(d.S,{id:t,checked:_.includes(t),onCheckedChange:()=>{_.includes(t)?C(_.filter(e=>e!==t)):C(_.concat(t))}}),(0,s.jsxs)(c.J,{htmlFor:e[m],className:(0,i.cn)("flex items-center gap-x-2 text-xs",j),children:[a&&(0,s.jsx)("img",{src:a,alt:e[p],className:(0,i.cn)("w-4 h-4",e.iconClass)}),(0,s.jsx)("span",{children:e[p]})]})]},t)})})}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-overlay bg-surface-200 py-2 px-3",children:[(0,s.jsx)(l.$,{size:"tiny",type:"default",onClick:()=>{S([]),C([]),w(!1)},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:N}),(0,s.jsx)(l.$,{type:"primary",onClick:()=>{let e=a.map(e=>e[m]);S(_.sort((t,a)=>e.indexOf(t)-e.indexOf(a))),w(!1)},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:"Save"})]})]})]})}},55589:(e,t,a)=>{a.d(t,{f:()=>d});var s=a(80263),n=a(53434),r=a.n(n),l=a(5969),i=a(35091),o=a(71171);let d=e=>{let{selectedLog:t,onClose:a}=e;return(0,s.jsxs)(i.Ay,{size:"large",header:'"'.concat(null==t?void 0:t.action.name,'" on ').concat(r()(null==t?void 0:t.occurred_at).format("DD MMM YYYY, HH:mm:ss")),visible:void 0!==t,onCancel:a,cancelText:"Close","data-sentry-element":"SidePanel","data-sentry-component":"LogDetailsPanel","data-sentry-source-file":"LogDetailsPanel.tsx",children:[(0,s.jsx)(l.y9,{header:(0,s.jsx)(l.sj,{children:"General"}),"data-sentry-element":"FormSection","data-sentry-source-file":"LogDetailsPanel.tsx",children:(0,s.jsx)(l.DE,{loading:!1,"data-sentry-element":"FormSectionContent","data-sentry-source-file":"LogDetailsPanel.tsx",children:(0,s.jsx)(o.A,{readOnly:!0,size:"small",label:"Occurred at",value:null==t?void 0:t.occurred_at,descriptionText:r()(null==t?void 0:t.occurred_at).format("DD MMM YYYY, HH:mm:ss (ZZ)"),"data-sentry-element":"Input","data-sentry-source-file":"LogDetailsPanel.tsx"})})}),(0,s.jsx)(i.Ay.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"LogDetailsPanel.tsx"}),(0,s.jsx)(l.y9,{header:(0,s.jsx)(l.sj,{children:"Actor"}),"data-sentry-element":"FormSection","data-sentry-source-file":"LogDetailsPanel.tsx",children:(0,s.jsxs)(l.DE,{loading:!1,"data-sentry-element":"FormSectionContent","data-sentry-source-file":"LogDetailsPanel.tsx",children:[(0,s.jsx)(o.A,{readOnly:!0,size:"small",label:"Actor ID",value:null==t?void 0:t.actor.id,"data-sentry-element":"Input","data-sentry-source-file":"LogDetailsPanel.tsx"}),(0,s.jsx)(o.A.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==t?void 0:t.actor.metadata,null,2),"data-sentry-element":"unknown","data-sentry-source-file":"LogDetailsPanel.tsx"})]})}),(0,s.jsx)(i.Ay.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"LogDetailsPanel.tsx"}),(0,s.jsx)(l.y9,{header:(0,s.jsx)(l.sj,{children:"Action"}),"data-sentry-element":"FormSection","data-sentry-source-file":"LogDetailsPanel.tsx",children:(0,s.jsxs)(l.DE,{loading:!1,"data-sentry-element":"FormSectionContent","data-sentry-source-file":"LogDetailsPanel.tsx",children:[(0,s.jsx)(o.A,{readOnly:!0,size:"small",label:"Name",value:null==t?void 0:t.action.name,"data-sentry-element":"Input","data-sentry-source-file":"LogDetailsPanel.tsx"}),(0,s.jsx)(o.A.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==t?void 0:t.action.metadata,null,2),"data-sentry-element":"unknown","data-sentry-source-file":"LogDetailsPanel.tsx"})]})}),(0,s.jsx)(i.Ay.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"LogDetailsPanel.tsx"}),(0,s.jsx)(l.y9,{header:(0,s.jsx)(l.sj,{children:"Target"}),"data-sentry-element":"FormSection","data-sentry-source-file":"LogDetailsPanel.tsx",children:(0,s.jsxs)(l.DE,{loading:!1,"data-sentry-element":"FormSectionContent","data-sentry-source-file":"LogDetailsPanel.tsx",children:[(0,s.jsx)(o.A,{readOnly:!0,size:"small",label:"Name",value:null==t?void 0:t.target.description,"data-sentry-element":"Input","data-sentry-source-file":"LogDetailsPanel.tsx"}),(0,s.jsx)(o.A.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==t?void 0:t.target.metadata,null,2),"data-sentry-element":"unknown","data-sentry-source-file":"LogDetailsPanel.tsx"})]})})]})}},59168:(e,t,a)=>{a.d(t,{p:()=>u});var s=a(80263),n=a(87467),r=a(53239),l=a(2),i=a(49189),o=a(16601),d=a(77690);function c(e){let{icon:t,className:a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-foreground-light",a),"data-sentry-component":"InputIconContainer","data-sentry-source-file":"InputIconContainer.tsx",children:t})}let u=(0,r.forwardRef)((e,t)=>{let{copy:a,showCopyOnHover:u=!1,icon:m,reveal:p=!1,actions:x,onCopy:h,iconContainerClassName:g,containerClassName:y,...f}=e,[j,v]=(0,r.useState)("Copy"),[b,N]=(0,r.useState)(!0),S=(0,d.A)("input"),A=[];return m&&A.push(S.with_icon),(0,s.jsxs)("div",{className:(0,l.cn)("relative group",y),children:[(0,s.jsx)(i.p,{ref:t,...f,onCopy:h,value:p&&b?"**** **** **** ****":f.value,className:(0,l.cn)(...A,f.className)}),m&&(0,s.jsx)(c,{icon:m,className:g}),a||x?(0,s.jsxs)("div",{className:S.actions_container,children:[a&&!(p&&b)?(0,s.jsx)(o.$,{size:"tiny",type:"default",className:(0,l.cn)(u&&"opacity-0 group-hover:opacity-100 transition"),icon:(0,s.jsx)(n.A,{size:16,className:"text-foreground-muted"}),onClick:()=>(function(e){var t;null==(t=navigator.clipboard.writeText(e))||t.then(function(){v("Copied"),setTimeout(function(){v("Copy")},3e3),null==h||h()},function(){v("Failed to copy")})})(f.value),children:j}):null,p&&b?(0,s.jsx)(o.$,{size:"tiny",type:"default",onClick:function(){N(!1)},children:"Reveal"}):null,x&&x]}):null]})})},63496:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(80263),n=a(3732);let r=e=>{let{projectUpdateDisabled:t,projectNotActive:a=!1,children:r,tooltip:l}=e;return(0,s.jsxs)(n.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"ProjectUpdateDisabledTooltip","data-sentry-source-file":"ProjectUpdateDisabledTooltip.tsx",children:[(0,s.jsx)(n.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"ProjectUpdateDisabledTooltip.tsx",children:r}),(t||a)&&(0,s.jsx)(n.ZI,{side:"bottom",className:"w-72 text-center",children:t?l||"Subscription changes are currently disabled. Our engineers are working on a fix.":a?"Unable to update subscription as project is currently not active":""})]})}},69763:(e,t,a)=>{a.d(t,{F:()=>m});var s=a(80263),n=a(53239),r=a(77690),l=a(89977),i=a(10860),o=a(61645),d=a(89714),c=a(23278);let u={danger:(0,s.jsx)(l.A,{strokeWidth:1.5,size:18}),success:(0,s.jsx)(i.A,{strokeWidth:1.5,size:18}),warning:(0,s.jsx)(o.A,{strokeWidth:1.5,size:18}),info:(0,s.jsx)(d.A,{strokeWidth:1.5,size:18}),neutral:(0,s.jsx)(s.Fragment,{})};function m(e){let{variant:t="neutral",className:a,title:l,withIcon:i,closable:o,children:d,icon:m,actions:p}=e,x=(0,r.A)("alert"),[h,g]=(0,n.useState)(!0),y=[x.base];y.push(x.variant[t].base),a&&y.push(a);let f=[x.description,x.variant[t].description],j=[x.close];return(0,s.jsx)(s.Fragment,{children:h&&(0,s.jsxs)("div",{className:y.join(" "),children:[i?(0,s.jsx)("div",{className:x.variant[t].icon,children:i&&u[t]}):null,m&&m,(0,s.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:[x.variant[t].header,x.header].join(" "),children:l}),(0,s.jsx)("div",{className:f.join(" "),children:d})]}),p]}),o&&(0,s.jsx)("button",{"aria-label":"Close alert",onClick:()=>g(!1),className:j.join(" "),children:(0,s.jsx)(c.A,{strokeWidth:2,size:16})})]})})}},70639:(e,t,a)=>{a.d(t,{Ay:()=>i});var s=a(80263),n=a(90709);a(53239);var r=a(77690);let l=e=>{let{open:t,children:a,className:r,...l}=e;return(0,s.jsx)(n.bL,{asChild:l.asChild,defaultOpen:l.defaultOpen,open:t,onOpenChange:l.onOpenChange,disabled:l.disabled,className:r,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:a})};l.Trigger=function(e){let{children:t,asChild:a}=e;return(0,s.jsx)(n.l9,{asChild:a,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},l.Content=function(e){let{asChild:t,children:a,className:l}=e,i=(0,r.A)("collapsible");return(0,s.jsx)(n.UC,{asChild:t,className:[i.content,l].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:a})};let i=l},78266:(e,t,a)=>{a.d(t,{R:()=>s});let s={oauthApps:e=>[e,"oauth-apps"],authorizedApps:e=>[e,"authorized-apps"]}},79989:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(80263),n=a(60045),r=a(64238);let l=e=>{let{description:t,hasReadScope:a,hasWriteScope:n}=e;if(a||n){let e=[a?"Read":null,n?"Write":null].filter(Boolean).map(e=>(0,s.jsx)("span",{className:"font-semibold text-foreground",children:e},e)).reduce((e,t)=>(0,s.jsxs)(s.Fragment,{children:[e,(0,s.jsx)("span",{children:" and "}),t]}));return(0,s.jsxs)("div",{className:"first:border-t border-b flex flex-row space-x-1 text-sm text-foreground-light py-2 px-1",children:[(0,s.jsx)("div",{className:"pt-0.5",children:(0,s.jsx)(r.A,{stroke:"green",height:18,width:18,strokeWidth:1.5})}),(0,s.jsxs)("div",{children:[e," ",t]})]})}return null},i=e=>{let{icon:t,name:a,domain:r,scopes:i}=e;return(0,s.jsxs)("div",{className:"flex gap-y-4 flex-col","data-sentry-component":"AuthorizeRequesterDetails","data-sentry-source-file":"AuthorizeRequesterDetails.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-x-4 items-center",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-center bg-no-repeat bg-cover flex items-center justify-center rounded-md border border-control",style:{backgroundImage:t?"url('".concat(t,"')"):"none"},children:!t&&(0,s.jsx)("p",{className:"text-foreground-light text-lg",children:a[0]})})}),(0,s.jsxs)("p",{className:"text-foreground",children:[a," (",r,") is requesting API access to an organization."]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Permissions"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following scopes will apply for the"," ",(0,s.jsx)("span",{className:"text-amber-900",children:"selected organization and all of its projects."})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(l,{description:"access to analytics logs.",hasReadScope:i.includes(n.gx.ANALYTICS_READ),hasWriteScope:i.includes(n.gx.ANALYTICS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to auth configurations and SSO providers.",hasReadScope:i.includes(n.gx.AUTH_READ),hasWriteScope:i.includes(n.gx.AUTH_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",hasReadScope:i.includes(n.gx.DATABASE_READ),hasWriteScope:i.includes(n.gx.DATABASE_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to custom domains and vanity subdomains.",hasReadScope:i.includes(n.gx.DOMAINS_READ),hasWriteScope:i.includes(n.gx.DOMAINS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to edge functions.",hasReadScope:i.includes(n.gx.EDGE_FUNCTIONS_READ),hasWriteScope:i.includes(n.gx.EDGE_FUNCTIONS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to environments/branches.",hasReadScope:i.includes(n.gx.ENVIRONMENT_READ),hasWriteScope:i.includes(n.gx.ENVIRONMENT_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to the organization and all its members.",hasReadScope:i.includes(n.gx.ORGANIZATIONS_READ),hasWriteScope:i.includes(n.gx.ORGANIZATIONS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to metadata, its upgrade status, network restrictions and network bans.",hasReadScope:i.includes(n.gx.PROJECTS_READ),hasWriteScope:i.includes(n.gx.PROJECTS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to PostgREST configurations.",hasReadScope:i.includes(n.gx.REST_READ),hasWriteScope:i.includes(n.gx.REST_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to API keys, secrets and pgsodium configurations.",hasReadScope:i.includes(n.gx.SECRETS_READ),hasWriteScope:i.includes(n.gx.SECRETS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,s.jsx)(l,{description:"access to storage buckets and files.",hasReadScope:i.includes(n.gx.STORAGE_READ),hasWriteScope:i.includes(n.gx.STORAGE_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"})]})]})]})}},80109:(e,t,a)=>{a.d(t,{A:()=>o});var s=a(80263),n=a(53239),r=a(92809),l=a(34214);function i(e,t){if(!t.error)return delete e[t.key],e;if(t)return{...e,[t.key]:t.error};throw Error()}function o(e){let{validate:t,...a}=e,[o,d]=(0,n.useReducer)(i,null),c=(0,r.Wx)({validateOnBlur:!0,...a,validationSchema:a.validationSchema,initialValues:a.initialValues,onSubmit:a.onSubmit,validate:t||function(){return o}});return(0,s.jsx)("form",{id:a.id,name:a.name,onSubmit:c.handleSubmit,className:a.className,style:a.style,method:"POST","data-sentry-component":"Form","data-sentry-source-file":"Form.tsx",children:(0,s.jsx)(l.h,{values:c.values,errors:c.errors,formContextOnChange:c.handleChange,handleBlur:c.handleBlur,touched:c.touched,fieldLevelValidation:function(e,t){d({key:e,error:t})},"data-sentry-element":"FormContextProvider","data-sentry-source-file":"Form.tsx",children:a.children({errors:c.errors,touched:c.touched,isSubmitting:c.isSubmitting,isValidating:c.isValidating,submitCount:c.submitCount,initialValues:c.initialValues,values:c.values,handleReset:c.handleReset,resetForm:c.resetForm,setFieldValue:c.setFieldValue})})})}},81370:(e,t,a)=>{a.d(t,{I:()=>i});var s=a(80263),n=a(53239),r=a(3732);let l=(0,n.forwardRef)((e,t)=>(0,s.jsx)("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...e,children:(0,s.jsx)("path",{d:"M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0ZM9 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM6.75 8a.75.75 0 0 0 0 1.5h.75v1.75a.75.75 0 0 0 1.5 0v-2.5A.75.75 0 0 0 8.25 8h-1.5Z",fillRule:"evenodd",clipRule:"evenodd"})})),i=(0,n.forwardRef)((e,t)=>{let{...a}=e;return(0,s.jsxs)(r.m_,{children:[(0,s.jsx)(r.k$,{type:"button",role:"button",className:"flex [&_svg]:data-[state=delayed-open]:fill-foreground-lighter [&_svg]:data-[state=instant-open]:fill-foreground-lighter",children:(0,s.jsx)(l,{strokeWidth:2,className:"transition-colors fill-foreground-muted w-4 h-4"})}),(0,s.jsx)(r.ZI,{...a})]})})},95110:(e,t,a)=>{a.d(t,{je:()=>s2,JW:()=>aw,jj:()=>rN,Ii:()=>aO,I9:()=>aZ,ZN:()=>st,It:()=>nP,vD:()=>rh,_U:()=>sO});var s=a(80263),n=a(96591),r=a(95207),l=a(45479),i=a(25718),o=a(2),d=a(22392),c=a(60045),u=a(93274),m=a(65904),p=a(53434),x=a.n(p),h=a(53239),g=a(73969),y=a(3732),f=a(38952),j=function(e){return e.DRAFT="draft",e.PAID="paid",e.VOID="void",e.UNCOLLECTIBLE="uncollectible",e.OPEN="open",e.ISSUED="issued",e}({});let v={[j.DRAFT]:{label:"Upcoming",badgeVariant:"warning"},[j.PAID]:{label:"Paid",badgeVariant:"brand"},[j.VOID]:{label:"Forgiven",badgeVariant:"brand"},[j.UNCOLLECTIBLE]:{label:"Outstanding",badgeVariant:"destructive"},[j.OPEN]:{label:"Outstanding",badgeVariant:"destructive"},[j.ISSUED]:{label:"Outstanding",badgeVariant:"destructive"}},b=e=>{let{status:t,paymentAttempted:a}=e,n=v[t];return(0,s.jsxs)(y.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"InvoiceStatusBadge","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:[(0,s.jsx)(y.k$,{"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:(0,s.jsx)(f.E,{size:"small",className:"capitalize",variant:(null==n?void 0:n.badgeVariant)||"default","data-sentry-element":"Badge","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:(null==n?void 0:n.label)||t})}),(0,s.jsxs)(y.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:[[j.OPEN,j.ISSUED,j.UNCOLLECTIBLE].includes(t)&&(a?(0,s.jsx)("p",{className:"text-xs text-foreground",children:'We were not able to collect the payment. Make sure you have a valid payment method and enough funds. Outstanding invoices may cause restrictions. You can manually pay the invoice using the "Pay Now" button.'}):(0,s.jsx)("p",{className:"text-xs text-foreground",children:'The invoice will soon be charged for. In case you pay via invoice instead of card, please make sure to make the payment in a timely manner. You can also pay the invoice using your card now using the "Pay Now" button.'})),t===j.DRAFT&&(0,s.jsx)("p",{className:"text-xs text-foreground",children:"The invoice will soon be finalized and charged for."}),t===j.PAID&&(0,s.jsx)("p",{className:"text-xs text-foreground",children:"The invoice has been paid successfully. No action is required on your side."}),t===j.VOID&&(0,s.jsx)("p",{className:"text-xs text-foreground",children:"This invoice has been forgiven. No action is required on your side."})]})]})};var N=a(33794),S=a(98474),A=a(79319),w=a(75859),_=a(3807),C=a(84755);async function I(e,t){let{invoiceId:a,slug:s}=e;if(!a)throw Error("Invoice ID is required");if(!s)throw Error("Slug is required");let{data:n,error:r}=await (0,_.Jt)("/platform/organizations/{slug}/billing/invoices/{invoiceId}",{params:{path:{invoiceId:a,slug:s}},signal:t});return r&&(0,_.H4)(r),n}var E=a(56947);async function T(e,t){let{slug:a}=e;if(!a)throw Error("Slug is required");let s=await (0,_.d5)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:a}},signal:t,parseAs:"text"});if(s.error)throw s.error;return Number(s.response.headers.get("X-Total-Count"))}let R=function(e){let{slug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(C.x.count(t),e=>{let{signal:a}=e;return T({slug:t},a)},{enabled:a&&void 0!==t,...s})};async function k(e,t){let{slug:a,offset:s=0,limit:n=10}=e;if(!a)throw Error("Org slug is required");let{data:r,error:l}=await (0,_.Jt)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:a},query:{offset:s.toString(),limit:n.toString()}},signal:t});return l&&(0,_.H4)(l),r}let M=function(e){let{slug:t,offset:a,limit:s}=e,{enabled:n=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(C.x.list(t,a),e=>{let{signal:n}=e;return k({slug:t,offset:a,limit:s},n)},{enabled:n&&void 0!==t,...r})};var P=a(90206),D=a(47136),L=a(10822),O=a(48277),z=a(28894),F=a(16601),U=a(62719),B=a(32144),G=a(80251);async function H(e){let{slug:t,invoiceId:a}=e;if(!t)throw Error("Org slug is required");if(!a)throw Error("Invoice ID is required");let{data:s,error:n}=await (0,_.Jt)("/platform/organizations/{slug}/billing/invoices/{invoiceId}/payment-link",{params:{path:{slug:t,invoiceId:a}}});return n&&(0,_.H4)(n),s}let V=function(){let{onError:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,B.jE)();return(0,G.n)(e=>H(e),{async onError(t,s,n){await Promise.all([a.invalidateQueries(C.x.listAndCount(s.slug))]),void 0===e?g.oR.error(t.message):e(t,s,n)},...t})},Y=e=>{let{slug:t,invoiceId:a}=e,{mutate:n,isLoading:r}=V({onSuccess(e){g.oR.success("Redirecting to payment gateway..."),window.location.href=e.redirectUrl}});return(0,s.jsx)(F.$,{onClick:function(){n({slug:t,invoiceId:a})},loading:r,disabled:r,"data-sentry-element":"Button","data-sentry-component":"InvoicePayButton","data-sentry-source-file":"InvoicePayButton.tsx",children:"Pay Now"})},q=()=>{let[e,t]=(0,h.useState)(1),a=(0,i.a)(),{slug:n}=null!=a?a:{},r=(e-1)*5,{data:l,isError:o}=R({slug:n},{enabled:(null==a?void 0:a.managed_by)==="supabase"}),{data:d,error:c,isLoading:u,isError:m,isSuccess:p}=M({slug:n,offset:r,limit:5},{enabled:(null==a?void 0:a.managed_by)==="supabase"}),y=d||[];(0,h.useEffect)(()=>{t(1)},[n]);let f=async e=>{try{let t=await I({invoiceId:e,slug:n});(null==t?void 0:t.invoice_pdf)&&window.open(t.invoice_pdf,"_blank")}catch(e){g.oR.error("Failed to fetch the selected invoice: ".concat(e.message))}};return(null==a?void 0:a.managed_by)!==void 0&&(null==a?void 0:a.managed_by)!=="supabase"?(0,s.jsx)(w.A,{partner:null==a?void 0:a.managed_by,resource:"Invoices",cta:{installationId:null==a?void 0:a.partner_id,path:"/invoices"}}):(0,s.jsx)("div",{className:"overflow-hidden md:overflow-auto overflow-x-scroll","data-sentry-component":"InvoicesSettings","data-sentry-source-file":"InvoicesSettings.tsx",children:(0,s.jsx)(N.A,{head:[(0,s.jsx)(N.A.th,{},"header-icon"),(0,s.jsx)(N.A.th,{children:"Date"},"header-date"),(0,s.jsx)(N.A.th,{children:"Amount"},"header-amount"),(0,s.jsx)(N.A.th,{children:"Invoice number"},"header-invoice"),(0,s.jsx)(N.A.th,{className:"flex items-center",children:"Status"},"header-status"),(0,s.jsx)(N.A.th,{className:"text-right"},"header-download")],body:u?Array(6).fill(0).map((e,t)=>(0,s.jsxs)(N.A.tr,{children:[(0,s.jsx)(N.A.td,{children:5!==t&&(0,s.jsx)(D.A,{size:"24"})}),(0,s.jsx)(N.A.td,{colSpan:5,children:(0,s.jsx)(U.A,{})})]},"loading-".concat(t))):m?(0,s.jsx)(N.A.tr,{className:"rounded-b",children:(0,s.jsx)(N.A.td,{colSpan:6,className:"!p-0 !rounded-b overflow-hidden",children:(0,s.jsx)(S.A,{className:"border-0 rounded-none",error:c,subject:"Failed to retrieve invoices"})})}):0===y.length?(0,s.jsx)(N.A.tr,{children:(0,s.jsx)(N.A.td,{colSpan:6,className:"p-3 py-12 text-center",children:(0,s.jsx)("p",{className:"text-foreground-light",children:u?"Checking for invoices":"No invoices for this organization yet"})})}):(0,s.jsxs)(s.Fragment,{children:[y.map(e=>(0,s.jsxs)(N.A.tr,{children:[(0,s.jsx)(N.A.td,{children:(0,s.jsx)(D.A,{size:"24"})}),(0,s.jsx)(N.A.td,{children:(0,s.jsx)("p",{children:x()(1e3*e.period_end).format("MMM DD, YYYY")})}),(0,s.jsx)(N.A.td,{children:(0,s.jsx)("p",{children:(0,P.vv)(e.amount_due/100)})}),(0,s.jsx)(N.A.td,{children:(0,s.jsx)("p",{children:e.number})}),(0,s.jsx)(N.A.td,{children:(0,s.jsx)(b,{status:e.status,paymentAttempted:e.payment_attempted})}),(0,s.jsx)(N.A.td,{className:"align-right",children:(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[e.amount_due>0&&[j.UNCOLLECTIBLE,j.OPEN,j.ISSUED].includes(e.status)&&(0,s.jsx)(Y,{slug:n,invoiceId:e.id}),(0,s.jsx)(A.G,{type:"outline",className:"w-7",icon:(0,s.jsx)(L.A,{size:16,strokeWidth:1.5}),onClick:()=>f(e.id),tooltip:{content:{side:"bottom",text:"Download invoice"}}})]})})]},e.id)),(0,s.jsx)(N.A.tr,{children:(0,s.jsx)(N.A.td,{colSpan:6,children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm opacity-50",children:o?"Failed to retrieve total number of invoices":"Showing ".concat(r+1," to ").concat(r+y.length," out of ").concat(l," invoices")}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(F.$,{icon:(0,s.jsx)(O.A,{}),type:"default",size:"tiny",disabled:1===e,onClick:async()=>t(e-1)}),(0,s.jsx)(F.$,{icon:(0,s.jsx)(z.A,{}),type:"default",size:"tiny",disabled:5*e>=(null!=l?l:0),onClick:async()=>t(e+1)})]})]})})},"navigation")]}),"data-sentry-element":"Table","data-sentry-source-file":"InvoicesSettings.tsx"})})},W=()=>{let e=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions");return(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"InvoicesSection","data-sentry-source-file":"InvoicesSection.tsx",children:[(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"InvoicesSection.tsx",children:(0,s.jsxs)("div",{className:"sticky space-y-2 top-12 pr-6",children:[(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Past Invoices"}),(0,s.jsx)("p",{className:"prose text-sm",children:"You get an invoice every time you change your plan or when your monthly billing cycle resets."})]})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"InvoicesSection.tsx",children:e?(0,s.jsx)(q,{}):(0,s.jsx)(u.A,{resourceText:"view this organization's upcoming invoice"})})]})};var $=a(82489),J=a(64829),Z=a(134),K=a(5969),Q=a(17234),X=a(42719);async function ee(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:s,error:n}=await (0,_.Jt)("/platform/organizations/{slug}/customer",{params:{path:{slug:a}},signal:t});return n&&(0,_.H4)(n),s}let et=function(e){let{slug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,m.SE)(c.aG.BILLING_READ,"stripe.customer");return(0,E.I)(X.O.customerProfile(t),e=>{let{signal:a}=e;return ee({slug:t},a)},{enabled:a&&n&&void 0!==t,...s})};async function ea(e){let{slug:t,address:a}=e;if(!t)return console.error("Slug is required");let{data:s,error:n}=await (0,_.yJ)("/platform/organizations/{slug}/customer",{params:{path:{slug:t}},body:{address:a}});if(n)throw(0,_.H4)(n);return s}let es=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>ea(e),{async onSuccess(t,a,n){let{address:r,slug:l}=a;s.setQueriesData(X.O.customerProfile(l),e=>e?{...e,address:r}:e),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to update customer profile: ".concat(e.message)):t(e,a,s)},...a})};var en=a(80109),er=a(71171),el=a(98040);let ei=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard & McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"RE",name:"R\xe9union"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SH",name:"St Helena"},{code:"KN",name:"St Kitts and Nevis"},{code:"LC",name:"St Lucia"},{code:"MF",name:"St Martin"},{code:"PM",name:"St Pierre and Miquelon"},{code:"VC",name:"St Vincent and the Grenadines"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard & Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad & Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks & Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"VI",name:"US Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States of America"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WF",name:"Wallis & Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},{code:"AX",name:"\xc5land Islands"}],eo=()=>{var e;let{slug:t}=(0,$.g)(),a=(0,i.a)(),n=(0,m.SE)(c.aG.BILLING_READ,"stripe.customer"),l=(0,m.SE)(c.aG.BILLING_WRITE,"stripe.customer"),{data:o,error:d,isLoading:p,isSuccess:x,isError:y}=et({slug:t},{enabled:n}),{mutate:f,isLoading:j}=es(),v="billing-address-form",{city:b,country:N,line1:A,line2:_,postal_code:C,state:I}=null!=(e=null==o?void 0:o.address)?e:{},E=async(e,a)=>{let{resetForm:s}=a;if(!t)return console.error("Slug is required");f({slug:t,address:e.line1?e:null},{onSuccess:()=>{g.oR.success("Successfully updated billing address"),s({values:e,initialValues:e})}})};return(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingAddress","data-sentry-source-file":"BillingAddress.tsx",children:[(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingAddress.tsx",children:(0,s.jsxs)("div",{className:"sticky space-y-2 top-12 pr-3",children:[(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Address"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"This will be reflected in every upcoming invoice, past invoices are not affected"})]})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingAddress.tsx",children:(null==a?void 0:a.managed_by)!==void 0&&(null==a?void 0:a.managed_by)!=="supabase"?(0,s.jsx)(w.A,{partner:null==a?void 0:a.managed_by,resource:"Billing Addresses",cta:{installationId:null==a?void 0:a.partner_id}}):n?(0,s.jsxs)(s.Fragment,{children:[p&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),y&&(0,s.jsx)(S.A,{subject:"Failed to retrieve organization customer profile",error:d}),x&&(0,s.jsx)(en.A,{validateOnBlur:!0,id:v,initialValues:{city:b,country:N,line1:A,line2:_,postal_code:C,state:I},validate:e=>{let t={};return(e.line1||e.line2||e.postal_code||e.state||e.city)&&!e.country&&(t.country="Please select a country"),(e.country||e.line2||e.postal_code||e.state||e.city)&&!e.line1&&(t.line1="Please provide an address line"),t},onSubmit:E,children:e=>{let{values:t,initialValues:a,handleReset:n,resetForm:r}=e,i=JSON.stringify(t)!==JSON.stringify(a);return(0,h.useEffect)(()=>{if(x&&void 0!==o){var e;let{city:t,country:a,line1:s,line2:n,postal_code:l,state:i}=null!=(e=null==o?void 0:o.address)?e:{},d={city:t,country:a,line1:s,line2:n,postal_code:l,state:i};r({values:d,initialValues:d})}},[x]),(0,s.jsx)(Z.lB,{footer:(0,s.jsx)("div",{className:"flex py-4 px-8",children:(0,s.jsx)(J.I,{form:v,isSubmitting:j,hasChanges:i,handleReset:n,helper:l?void 0:"You need additional permissions to manage this organization's billing address"})}),children:(0,s.jsx)(K.y9,{children:(0,s.jsxs)(K.DE,{fullWidth:!0,loading:!1,className:"!gap-2",children:[(0,s.jsx)(er.A,{id:"line1",name:"line1",placeholder:"Address line 1",disabled:!l}),(0,s.jsx)(er.A,{id:"line2",name:"line2",placeholder:"Address line 2",disabled:!l}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)(el.A,{className:"w-full",id:"country",name:"country",placeholder:"Country",disabled:!l,children:[(0,s.jsx)(el.A.Option,{label:"---",value:"",children:"---"},"empty"),ei.map(e=>(0,s.jsx)(el.A.Option,{label:e.name,value:e.code,children:e.name},e.code))]}),(0,s.jsx)(er.A,{className:"w-full",id:"postal_code",name:"postal_code",placeholder:"Postal code",disabled:!l})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(er.A,{className:"w-full",id:"city",name:"city",placeholder:"City",disabled:!l}),(0,s.jsx)(er.A,{className:"w-full",id:"state",name:"state",placeholder:"State",disabled:!l})]})]})})})}})]}):(0,s.jsx)(u.A,{resourceText:"view this organization's billing address"})})]})};var ed=a(63320),ec=a.n(ed);async function eu(e,t){let{orgSlug:a}=e;if(!a)throw Error("orgSlug is required");let{data:s,error:n}=await (0,_.Jt)("/platform/organizations/{slug}/billing/invoices/upcoming",{params:{path:{slug:a}},headers:{Version:"2"},signal:t});return n&&(0,_.H4)(n),s}let em=function(e){let{orgSlug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(C.x.orgUpcomingPreview(t),e=>{let{signal:a}=e;return eu({orgSlug:t},a)},{enabled:a&&void 0!==t,...s})};var ep=a(20969),ex=a(77188);let eh=[ex.Lb.DATABASE_SIZE,ex.Lb.EGRESS,ex.Lb.STORAGE_SIZE],eg=[ex.Lb.FUNCTION_INVOCATIONS,ex.Lb.LOG_DRAIN_EVENTS,ex.Lb.MONTHLY_ACTIVE_USERS,ex.Lb.MONTHLY_ACTIVE_SSO_USERS,ex.Lb.MONTHLY_ACTIVE_THIRD_PARTY_USERS,ex.Lb.REALTIME_MESSAGE_COUNT,ex.Lb.REALTIME_PEAK_CONNECTIONS,ex.Lb.STORAGE_IMAGES_TRANSFORMED],ey=(e,t)=>{if(eh.includes(e)){let e=+(t.usage/1e9).toFixed(2).toLocaleString();return t.usage>0&&0===e?"<0.01":e}return t.hours&&!eg.includes(e)?t.usage.toLocaleString()+" ("+Math.round(t.usage/t.hours).toLocaleString()+"x"+t.hours.toLocaleString()+" hours)":t.usage.toLocaleString()},ef=e=>eh.includes(e)?"GB":e.startsWith("COMPUTE_HOURS")||[ex.Lb.CUSTOM_DOMAIN,ex.Lb.IPV4,ex.Lb.PITR_7,ex.Lb.PITR_14,ex.Lb.PITR_28,ex.Lb.LOG_DRAIN,ex.Lb.AUTH_MFA_PHONE,ex.Lb.AUTH_MFA_WEB_AUTHN].includes(e)?"Hours":null,ej=(e,t)=>{let a=["Current plan limits are not enough for me","I want better customer support from Supabase","I am migrating from a previous project"];return void 0===e||void 0===t||("free"===e&&"pro"===t?(a.push("Need more compute"),a.push("I want access to additional features like branching, daily backups, custom domain and PITR")):"team"===t&&a.push("I want access to SOC2 and HIPAA compliance")),a.push("None of the above"),a};var ev=a(81370);let eb={[ex.Lb.MONTHLY_ACTIVE_USERS]:"/docs/guides/platform/manage-your-usage/monthly-active-users",[ex.Lb.MONTHLY_ACTIVE_SSO_USERS]:"/docs/guides/platform/manage-your-usage/monthly-active-users-sso",[ex.Lb.MONTHLY_ACTIVE_THIRD_PARTY_USERS]:"/docs/guides/platform/manage-your-usage/monthly-active-users-third-party",[ex.Lb.AUTH_MFA_PHONE]:"/docs/guides/platform/manage-your-usage/advanced-mfa-phone",[ex.Lb.EGRESS]:"/docs/guides/platform/manage-your-usage/egress",[ex.Lb.FUNCTION_INVOCATIONS]:"/docs/guides/platform/manage-your-usage/edge-function-invocations",[ex.Lb.STORAGE_SIZE]:"/docs/guides/platform/manage-your-usage/storage-size",[ex.Lb.STORAGE_IMAGES_TRANSFORMED]:"/docs/guides/platform/manage-your-usage/storage-image-transformations",[ex.Lb.REALTIME_MESSAGE_COUNT]:"/docs/guides/platform/manage-your-usage/realtime-messages",[ex.Lb.REALTIME_PEAK_CONNECTIONS]:"/docs/guides/platform/manage-your-usage/realtime-peak-connections",[ex.Lb.CUSTOM_DOMAIN]:"/docs/guides/platform/manage-your-usage/custom-domains",[ex.Lb.IPV4]:"/docs/guides/platform/manage-your-usage/ipv4",[ex.Lb.PITR_7]:"/docs/guides/platform/manage-your-usage/point-in-time-recovery",[ex.Lb.PITR_14]:"/docs/guides/platform/manage-your-usage/point-in-time-recovery",[ex.Lb.PITR_28]:"/docs/guides/platform/manage-your-usage/point-in-time-recovery",[ex.Lb.DISK_SIZE_GB_HOURS_GP3]:"/docs/guides/platform/manage-your-usage/disk-size",[ex.Lb.DISK_SIZE_GB_HOURS_IO2]:"/docs/guides/platform/manage-your-usage/disk-size",[ex.Lb.DISK_IOPS_GP3]:"/docs/guides/platform/manage-your-usage/disk-iops",[ex.Lb.DISK_IOPS_IO2]:"/docs/guides/platform/manage-your-usage/disk-iops",[ex.Lb.DISK_THROUGHPUT_GP3]:"/docs/guides/platform/manage-your-usage/disk-throughput",[ex.Lb.LOG_DRAIN]:"/docs/guides/platform/manage-your-usage/log-drains"};function eN(e){let{amountBeforeDiscount:t,amount:a}=e;return t&&a<t?(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-foreground-light line-through mr-2",children:(0,P.vv)(t)}),(0,s.jsx)("span",{children:(0,P.vv)(a)})]}):(0,P.vv)(a)}function eS(e){var t;let{computeItems:a,tooltip:n,title:r,computeCredits:l}=e,i=a.flatMap(e=>e.breakdown.map(t=>({...t,computeType:e.description,computeCosts:t.amount}))).sort((e,t)=>t.computeCosts-e.computeCosts),o=Math.max(0,a.reduce((e,t)=>e+t.amount_before_discount,0)),d=Math.max(0,a.reduce((e,t)=>{var a;return e+(null!=(a=t.amount)?a:0)},0)+(null!=(t=null==l?void 0:l.amount)?t:0));return a.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"UpcomingInvoice.tsx",children:[(0,s.jsxs)(ep.nA,{className:"!py-2 px-0 flex items-center gap-1","data-sentry-element":"TableCell","data-sentry-source-file":"UpcomingInvoice.tsx",children:[(0,s.jsx)("span",{children:r}),(0,s.jsx)(ev.I,{className:"max-w-sm","data-sentry-element":"InfoTooltip","data-sentry-source-file":"UpcomingInvoice.tsx",children:n})]}),(0,s.jsx)(ep.nA,{className:"text-right py-2 px-0","data-sentry-element":"TableCell","data-sentry-source-file":"UpcomingInvoice.tsx",children:(0,s.jsx)(eN,{amount:d,amountBeforeDiscount:o,"data-sentry-element":"InvoiceLineItemAmount","data-sentry-source-file":"UpcomingInvoice.tsx"})})]}),i.map(e=>(0,s.jsxs)(ep.Hj,{className:"text-foreground-light text-xs",children:[(0,s.jsxs)(ep.nA,{className:"!py-2 px-0 pl-6",children:[e.project_name," (",e.computeType," - ",e.usage," Hours)"]}),(0,s.jsx)(ep.nA,{className:"!py-2 px-0 text-right",children:(0,P.vv)(e.computeCosts)})]},e.project_ref)),l&&(0,s.jsxs)(ep.Hj,{className:"text-foreground-light text-xs",children:[(0,s.jsx)(ep.nA,{className:"!py-2 px-0 pl-6",children:"Compute Credits"}),(0,s.jsx)(ep.nA,{className:"!py-2 px-0 text-right",children:(0,P.vv)(l.amount)})]})]}):null}let eA=e=>{var t,a,n,r,l,i,o;let{slug:d}=e,{data:c,error:u,isLoading:m,isError:p,isSuccess:x}=em({orgSlug:d}),h=(null==c||null==(t=c.lines)?void 0:t.filter(e=>{var t,a;return(null==(t=e.description)?void 0:t.toLowerCase().includes("compute"))&&e.breakdown&&(null==(a=e.breakdown)?void 0:a.length)>0}))||[],g=null!=(l=null==c||null==(a=c.lines)?void 0:a.find(e=>e.description.startsWith("Compute Credits")))?l:null,y=null==c||null==(n=c.lines)?void 0:n.find(e=>{var t;return null==(t=e.description)?void 0:t.toLowerCase().includes("plan")}),f=h.filter(e=>{var t,a;return!(null==(t=e.metadata)?void 0:t.is_branch)&&!(null==(a=e.metadata)?void 0:a.is_read_replica)}),j=h.filter(e=>{var t;return null==(t=e.metadata)?void 0:t.is_branch}),v=h.filter(e=>{var t;return null==(t=e.metadata)?void 0:t.is_read_replica}),b=(null==c||null==(r=c.lines)?void 0:r.filter(e=>{var t,a;return!(null==(t=e.description)?void 0:t.toLowerCase().includes("compute"))&&!(null==(a=e.description)?void 0:a.toLowerCase().includes("plan"))}))||[];return(0,s.jsxs)(s.Fragment,{children:[m&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),p&&(0,s.jsx)(S.A,{subject:"Failed to retrieve upcoming invoice",error:u}),x&&(0,s.jsx)("div",{children:(0,s.jsx)("div",{children:(0,s.jsxs)(ep.XI,{className:"w-full text-sm",children:[(0,s.jsxs)(ep.BF,{children:[(0,s.jsxs)(ep.Hj,{children:[(0,s.jsx)(ep.nA,{className:"!py-2 px-0",children:null==y?void 0:y.description}),(0,s.jsx)(ep.nA,{className:"text-right py-2 px-0",children:null==y?"-":(0,s.jsx)(eN,{amount:y.amount,amountBeforeDiscount:y.amount_before_discount})})]}),(0,s.jsx)(eS,{computeItems:f,title:"Compute",computeCredits:g,tooltip:(0,s.jsxs)("p",{className:"prose text-xs",children:["The first project is covered by Compute Credits. Additional projects incur compute costs starting at $10/month, independent of activity. See"," ",(0,s.jsx)(ec(),{href:"/docs/guides/platform/manage-your-usage/compute",target:"_blank",children:"docs"}),"."]})}),(0,s.jsx)(eS,{title:"Replica Compute",computeItems:v,tooltip:(0,s.jsxs)("p",{className:"prose text-xs",children:["Each Read Replica is a dedicated database. You are charged for its resources: Compute, Disk Size, provisioned Disk IOPS, provisioned Disk Throughput, and IPv4. See"," ",(0,s.jsx)(ec(),{href:"/docs/guides/platform/manage-your-usage/read-replicas",target:"_blank",children:"docs"}),"."]})}),j.length>0&&(0,s.jsxs)(ep.Hj,{children:[(0,s.jsx)(ep.nA,{className:"py-2 px-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{children:"Branching"}),(0,s.jsxs)(ev.I,{className:"max-w-sm",children:[(0,s.jsx)("ul",{className:"ml-6 list-disc",children:j.flatMap(e=>e.breakdown).map(e=>(0,s.jsxs)("li",{children:[e.project_name," (",e.usage," Hours)"]},"branching-breakdown-".concat(e.project_ref)))}),(0,s.jsxs)("p",{className:"mt-2",children:["See"," ",(0,s.jsx)(ec(),{className:"underline",href:"https://supabase.com/docs/guides/platform/manage-your-usage/branching",target:"_blank",children:"docs"})," ","on how billing for Branching works."]})]})]})}),(0,s.jsx)(ep.nA,{className:"text-right py-2 px-0",children:(0,s.jsx)(eN,{amount:j.reduce((e,t)=>e+t.amount,0),amountBeforeDiscount:j.reduce((e,t)=>{var a;return e+(null!=(a=t.amount_before_discount)?a:0)},0)})})]}),b.map(e=>{var t;return(0,s.jsxs)(ep.Hj,{children:[(0,s.jsx)(ep.nA,{className:"py-2 px-0",children:(0,s.jsxs)("div",{className:"gap-1 flex items-center",children:[(0,s.jsx)("span",{children:null!=(t=e.description)?t:"Unknown"}),(e.breakdown&&e.breakdown.length>0||null!=e.usage_metric)&&(0,s.jsxs)(ev.I,{className:"max-w-sm",children:[e.unit_price_desc&&(0,s.jsxs)("p",{className:"mb-2",children:["Pricing: ",e.unit_price_desc]}),e.breakdown&&e.breakdown.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["Projects using ",e.description,":"]}),(0,s.jsx)("ul",{className:"ml-6 list-disc",children:e.breakdown.map(t=>(0,s.jsxs)("li",{children:[(0,s.jsx)(ec(),{className:"underline",href:"/project/".concat(t.project_ref),target:"_blank",children:t.project_name})," ",e.usage_metric&&(0,s.jsxs)("span",{children:["(",ey(e.usage_metric,t)," ",ef(e.usage_metric),")"]})]},"".concat(e.description,"-breakdown-").concat(t.project_ref)))})]}),e.usage_metric&&null!=eb[e.usage_metric]&&(0,s.jsxs)("p",{className:"mt-2",children:["See"," ",(0,s.jsx)(ec(),{className:"underline",href:eb[e.usage_metric],target:"_blank",children:"docs"})," ","on how billing for ",e.description," works and"," ",(0,s.jsx)(ec(),{className:"underline",href:"/organization/".concat(d,"/usage"),children:"usage page"})," ","for a detailed breakdown."]})]})]})}),(0,s.jsx)(ep.nA,{className:"text-right py-2 px-0",children:(0,s.jsx)(eN,{amount:e.amount,amountBeforeDiscount:e.amount_before_discount})})]},e.description)})]}),(0,s.jsxs)(ep.Gg,{children:[(0,s.jsxs)(ep.Hj,{children:[(0,s.jsxs)(ep.nA,{className:"font-medium py-2 px-0 flex items-center",children:[(0,s.jsx)("span",{className:"mr-2",children:"Current Costs"}),(0,s.jsx)(ev.I,{children:"Costs accumulated from the beginning of the billing cycle up to now."})]}),(0,s.jsx)(ep.nA,{className:"text-right font-medium py-2 px-0",children:null!=(i=(0,P.vv)(null==c?void 0:c.amount_total))?i:"-"})]}),(0,s.jsxs)(ep.Hj,{children:[(0,s.jsxs)(ep.nA,{className:"font-medium py-2 px-0 flex items-center",children:[(0,s.jsx)("span",{className:"mr-2",children:"Projected Costs"}),(0,s.jsx)(ev.I,{className:"max-w-xs",children:"Projected costs at the end of the billing cycle. Includes predictable costs for Compute Hours, IPv4, Custom Domain and Point-In-Time-Recovery, but no costs for metrics like MAU, storage or function invocations. Final amounts may vary depending on your usage."})]}),(0,s.jsx)(ep.nA,{className:"text-right font-medium py-2 px-0",children:null!=(o=(0,P.vv)(null==c?void 0:c.amount_projected))?o:"-"})]})]})]})})})]})};var ew=a(98911);let e_=()=>{var e,t;let{slug:a}=(0,$.g)(),n=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions"),{data:i,error:o,isLoading:p,isError:h}=(0,d.j5)({orgSlug:a},{enabled:n}),g=(0,l.x)("billing:invoices"),y=x().unix(null!=(e=null==i?void 0:i.current_period_start)?e:0).utc(),f=x().unix(null!=(t=null==i?void 0:i.current_period_end)?t:0).utc(),j=f.diff(x()(),"days"),v=f.diff(y,"days");return(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingBreakdown","data-sentry-source-file":"BillingBreakdown.tsx",children:[(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingBreakdown.tsx",children:(0,s.jsxs)("div",{className:"sticky space-y-2 top-12 pr-6",children:[(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Upcoming Invoice"}),(0,s.jsx)("div",{className:"py-2",children:(0,s.jsx)(ew.A,{type:"horizontal",value:v-j,max:v,barClass:"bg-foreground",labelBottom:"".concat(y.format("MMMM DD")," - ").concat(f.format("MMMM DD")),bgClass:"bg-surface-300",labelBottomClass:"!text-foreground-light p-1 m-0",labelTop:i?"".concat(j," ").concat(1===j?"day":"days"," left"):"",labelTopClass:"p-1 m-0","data-sentry-element":"SparkBar","data-sentry-source-file":"BillingBreakdown.tsx"})}),(0,s.jsxs)("p",{className:"prose text-sm",children:["Your upcoming invoice (excluding credits) will continue to update until the end of your billing cycle on ",f.format("MMMM DD"),". For a more detailed breakdown, visit the ",(0,s.jsx)(ec(),{href:"/org/".concat(a,"/usage"),"data-sentry-element":"Link","data-sentry-source-file":"BillingBreakdown.tsx",children:"usage page."})]}),(0,s.jsx)("br",{}),(0,s.jsx)("p",{className:"text-sm text-foreground-light mt-4",children:"Add-on changes or new projects may take up to an hour to appear."})]})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingBreakdown.tsx",children:n?(0,s.jsxs)(s.Fragment,{children:[p&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),h&&(0,s.jsx)(S.A,{subject:"Failed to retrieve subscription",error:o}),g&&(0,s.jsx)(eA,{slug:a})]}):(0,s.jsx)(u.A,{resourceText:"view this organization's upcoming invoice"})})]})};var eC=a(32981),eI=a(87494),eE=a(39353),eT=a(85669),eR=a(18570),ek=a(49189),eM=a(27787),eP=a(16993);let eD="org-billing-email",eL=eE.z.object({billingEmail:eE.z.string().email("Please provide a valid email address").optional(),additionalBillingEmails:eE.z.string().email({message:"invalid_email"}).array().default([])}),eO=()=>{var e,t;let{slug:a}=(0,$.g)(),n=(0,i.a)(),{name:l,billing_email:o}=null!=n?n:{},d=(0,m.SE)(c.aG.UPDATE,"organizations"),p=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions"),{data:x,isLoading:y}=et({slug:a},{enabled:p}),f=(0,eI.mN)({resolver:(0,eC.u)(eL),defaultValues:{billingEmail:null!=o?o:"",additionalBillingEmails:null!=(e=null==x?void 0:x.additional_emails)?e:[]}}),{additionalBillingEmails:j}=f.watch(),{errors:v}=f.formState,b=null!=(t=v.additionalBillingEmails)?t:[],{mutate:N,isLoading:S}=(0,eR.N)(),A=async e=>d?a?l?void N({slug:a,name:l,billing_email:e.billingEmail,additional_billing_emails:e.additionalBillingEmails},{onSuccess:()=>{g.oR.success("Successfully saved settings"),f.reset(e)}}):console.error("Organization name is required"):console.error("Slug is required"):g.oR.error("You do not have the required permissions to update this organization");return(0,h.useEffect)(()=>{if(x){var e;f.reset({billingEmail:o,additionalBillingEmails:null!=(e=x.additional_emails)?e:[]})}},[x]),(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingEmail","data-sentry-source-file":"BillingEmail.tsx",children:[(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingEmail.tsx",children:(0,s.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Email Recipient"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"All billing correspondence will go to this email"})]})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingEmail.tsx",children:p?(0,s.jsx)(eT.lV,{...f,children:(0,s.jsx)("form",{id:eD,onSubmit:f.handleSubmit(A),children:(0,s.jsx)(Z.lB,{footer:(0,s.jsx)("div",{className:"flex py-4 px-8",children:(0,s.jsx)(J.I,{form:eD,isSubmitting:S,hasChanges:f.formState.isDirty,handleReset:f.reset,disabled:!d,helper:d?void 0:"You need additional permissions to update billing emails"})}),children:(0,s.jsx)(K.y9,{children:(0,s.jsxs)(K.DE,{fullWidth:!0,loading:y,children:[(0,s.jsx)(eT.zB,{control:f.control,name:"billingEmail",render:e=>{let{field:t}=e;return(0,s.jsxs)(eM.M,{label:"Email address",children:[(0,s.jsx)(eT.MJ,{children:(0,s.jsx)(ek.p,{type:"email",...t,placeholder:"Email",disabled:!d})}),(0,s.jsx)(eT.C5,{})]})}}),(0,s.jsx)(eT.zB,{control:f.control,name:"additionalBillingEmails",render:e=>{let{field:t}=e;return(0,s.jsxs)(eM.M,{hideMessage:!0,label:(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("span",{children:"Additional emails"}),(0,s.jsx)(ev.I,{side:"bottom",children:"These email addresses will be CC'd in automated invoice or payment failure emails. Payment receipts will still only go to the primary billing address."})]}),children:[(0,s.jsx)(eT.MJ,{children:(0,s.jsxs)(eP.xf,{values:t.value,onValuesChange:t.onChange,children:[(0,s.jsx)(eP.hw,{deletableBadge:!0,showIcon:!1,mode:"inline-combobox",label:"Add additional recipients",badgeLimit:"wrap"}),(0,s.jsx)(eP.sD,{children:(0,s.jsx)(eP.DG,{creatable:!0})})]})}),Array.isArray(b)&&b.length>0&&(0,s.jsx)("div",{className:"flex flex-col gap-y-1 mt-2",children:b.map((e,t)=>(0,s.jsxs)("p",{className:"text-sm text-destructive",children:['"',j[t],'" is not a valid email address']},"email-error-".concat(t)))})]})}})]})})})})}):(0,s.jsx)(u.A,{resourceText:"view this organization's email recipients"})})]})};var ez=a(66452),eF=a(796),eU=a(42005),eB=a.n(eU),eG=a(24726),eH=a(58897),eV=a(23014),eY=a(69763),eq=a(63496),eW=a(10358),e$=a(60237);async function eJ(e){let{slug:t,tier:a,paymentMethod:s}=e;if(!t)throw Error("slug is required");if(!a)throw Error("tier is required");let n={tier:a};void 0!==s&&(n.payment_method=s);let{error:r,data:l}=await (0,_.yJ)("/platform/organizations/{slug}/billing/subscription",{body:{payment_method:n.payment_method,tier:n.tier},params:{path:{slug:t}}});return r&&(0,_.H4)(r),l}let eZ=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>eJ(e),{async onSuccess(t,a,n){let{slug:r}=a;await new Promise(e=>setTimeout(e,2e3)),await Promise.all([s.invalidateQueries(e$.s.orgSubscription(r)),s.invalidateQueries(e$.s.orgPlans(r)),s.invalidateQueries(eW.E.orgUsage(r)),s.invalidateQueries(C.x.orgUpcomingPreview(r)),s.invalidateQueries(X.O.detail(r)),s.invalidateQueries(X.O.list())]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to update subscription: ".concat(e.message)):t(e,a,s)},...a})};var eK=a(23755),eQ=a(35091),eX=a(70639);let e0=[{name:"Spend cap enabled",value:"on",imageUrl:"".concat(eH.o2,"/img/spend-cap-on.png"),imageUrlLight:"".concat(eH.o2,"/img/spend-cap-on--light.png")},{name:"Spend cap disabled",value:"off",imageUrl:"".concat(eH.o2,"/img/spend-cap-off.png"),imageUrlLight:"".concat(eH.o2,"/img/spend-cap-off--light.png")}],e2=()=>{var e;let{slug:t}=(0,$.g)(),{resolvedTheme:a}=(0,eF.D)(),[n,r]=(0,h.useState)(!1),[l,i]=(0,h.useState)(),u=(0,m.SE)(c.aG.BILLING_WRITE,"stripe.subscriptions"),p=(0,eV.h2)(),x="costControl"===p.panelKey,y=()=>p.setPanelKey(void 0),{data:f,isLoading:j}=(0,d.j5)({orgSlug:t}),{mutate:v,isLoading:b}=eZ({onSuccess:()=>{g.oR.success("Successfully ".concat(w?"enabled":"disabled"," spend cap")),y()},onError:e=>{g.oR.error("Failed to toggle spend cap: ".concat(e.message))}}),S=(null==f||null==(e=f.plan)?void 0:e.id)==="free",A=!(null==f?void 0:f.usage_billing_enabled),w=!A&&"on"===l,_=l!==(A?"on":"off");(0,h.useEffect)(()=>{x&&void 0!==f&&i(A?"on":"off")},[x,j,f,A]);let C=async()=>{if(!t)return console.error("Org slug is required");v({slug:t,tier:"on"===l?eH.V$.PRO:eH.V$.PAYG})};return(0,s.jsx)(eQ.Ay,{size:"large",loading:j||b,disabled:S||j||!_||b||!u,visible:x,onCancel:y,onConfirm:C,header:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{children:"Spend cap"}),(0,s.jsx)(F.$,{asChild:!0,type:"default",icon:(0,s.jsx)(ez.A,{strokeWidth:1.5}),children:(0,s.jsx)(ec(),{href:"https://supabase.com/docs/guides/platform/cost-control#spend-cap",target:"_blank",rel:"noreferrer",children:"About spend cap"})})]}),tooltip:u?void 0:"You do not have permission to update spend cap","data-sentry-element":"SidePanel","data-sentry-component":"SpendCapSidePanel","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,s.jsx)(eQ.Ay.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,s.jsxs)("div",{className:"py-6 space-y-4",children:[(0,s.jsx)("p",{className:"text-sm",children:"Use the spend cap to manage project usage and costs, and control whether the project can exceed the included quota allowance of any billed line item in a billing cycle"}),(0,s.jsxs)(eX.Ay,{open:n,onOpenChange:r,"data-sentry-element":"Collapsible","data-sentry-source-file":"SpendCapSidePanel.tsx",children:[(0,s.jsx)(eX.Ay.Trigger,{asChild:!0,"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)(z.A,{strokeWidth:1.5,size:16,className:n?"rotate-90":"","data-sentry-element":"ChevronRight","data-sentry-source-file":"SpendCapSidePanel.tsx"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"How are each resource charged after exceeding the included quota?"})]})}),(0,s.jsx)(eX.Ay.Content,{asChild:!0,"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,s.jsx)(N.A,{className:"mt-4",head:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.A.th,{children:(0,s.jsx)("p",{className:"text-xs",children:"Item"})}),(0,s.jsx)(N.A.th,{children:(0,s.jsx)("p",{className:"text-xs",children:"Rate"})})]}),body:["database","auth","storage","realtime","edge_functions"].map(e=>{let t=eK.z[e],a=t.features.filter(e=>e.usage_based);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(N.A.tr,{children:[(0,s.jsx)(N.A.td,{children:(0,s.jsx)("p",{className:"text-xs text-foreground",children:t.title})}),(0,s.jsx)(N.A.td,{children:null})]},e),a.map(e=>(0,s.jsxs)(N.A.tr,{children:[(0,s.jsx)(N.A.td,{children:(0,s.jsx)("p",{className:"text-xs pl-4",children:e.title})}),(0,s.jsx)(N.A.td,{children:(0,s.jsx)("p",{className:"text-xs pl-4",children:e.plans.pro})})]},e.title))]})}),"data-sentry-element":"Table","data-sentry-source-file":"SpendCapSidePanel.tsx"})})]}),S&&(0,s.jsx)(eY.F,{withIcon:!0,variant:"info",title:"Toggling of the spend cap is only available on the Pro Plan",actions:(0,s.jsx)(F.$,{type:"default",onClick:()=>p.setPanelKey("subscriptionPlan"),children:"View available plans"}),children:"Upgrade your plan to disable the spend cap"}),(0,s.jsx)("div",{className:"!mt-8 pb-4",children:(0,s.jsx)("div",{className:"flex gap-3",children:e0.map(e=>{let t=l===e.value;return(0,s.jsxs)("div",{className:(0,o.cn)("col-span-4 group space-y-1",S&&"opacity-75"),onClick:()=>!S&&i(e.value),children:[(0,s.jsx)(eB(),{alt:"Spend Cap",className:(0,o.cn)("relative rounded-xl transition border bg-no-repeat bg-center bg-cover w-[160px] h-[96px]",t?"border-foreground":"border-foreground-muted opacity-50 group-hover:border-foreground-lighter group-hover:opacity-100",!S&&"cursor-pointer",!S&&!t&&"group-hover:border-foreground-light"),width:160,height:96,src:(null==a?void 0:a.includes("dark"))?e.imageUrl:e.imageUrlLight}),(0,s.jsx)("p",{className:(0,o.cn)("text-sm transition",!S&&"group-hover:text-foreground",t?"text-foreground":"text-foreground-light"),children:e.name})]},e.value)})})}),"on"===l?(0,s.jsx)(eY.F,{withIcon:!0,variant:"warning",title:"Your projects could become unresponsive or enter read only mode",children:"Exceeding the included quota allowance with spend cap enabled can cause your projects to become unresponsive or enter read only mode."}):(0,s.jsx)(eY.F,{withIcon:!0,variant:"info",title:"Charges apply for usage beyond included quota allowance",children:"Your projects will always remain responsive and active, and charges only apply when exceeding the included quota limit."}),_&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-sm",children:"on"===l?"Upon clicking confirm, spend cap will be enabled for your organization and you will no longer be charged any extra for usage.":"Upon clicking confirm, spend cap will be disabled for your organization and you will be charged for any usage beyond the included quota."}),(0,s.jsx)("p",{className:"text-sm",children:"Toggling spend cap triggers an invoice and there might be prorated charges for any usage beyond the Pro Plans quota during this billing cycle."})]})]})})})},e1=e=>{var t;let{}=e,{slug:a}=(0,$.g)(),{resolvedTheme:n}=(0,eF.D)(),l=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions"),i=(0,eV.h2)(),o=(0,eG._)("disableProjectCreationAndUpdate"),{data:p,error:x,isLoading:h,isSuccess:g,isError:y}=(0,d.j5)({orgSlug:a},{enabled:l}),f=null==p?void 0:p.plan,j=null!=(t=null==p?void 0:p.usage_billing_enabled)&&t,v=!o&&!["team","enterprise"].includes((null==f?void 0:f.id)||"");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"CostControl.tsx",children:[(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"CostControl.tsx",children:(0,s.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Cost Control"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light m-0",children:["Allow scaling beyond your plan's"," ",(0,s.jsx)(ec(),{href:"/org/".concat(a,"/usage"),className:"text-green-900 transition hover:text-green-1000","data-sentry-element":"Link","data-sentry-source-file":"CostControl.tsx",children:"included quota"}),"."]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,s.jsx)("div",{children:(0,s.jsx)(ec(),{href:"https://supabase.com/docs/guides/platform/cost-control#spend-cap",target:"_blank",rel:"noreferrer","data-sentry-element":"Link","data-sentry-source-file":"CostControl.tsx",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,s.jsx)("p",{className:"text-sm m-0",children:"Spend cap"}),(0,s.jsx)(ez.A,{size:16,strokeWidth:1.5,"data-sentry-element":"ExternalLink","data-sentry-source-file":"CostControl.tsx"})]})})})]})]})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"CostControl.tsx",children:l?(0,s.jsxs)(s.Fragment,{children:[h&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),y&&(0,s.jsx)(S.A,{subject:"Failed to retrieve subscription",error:x}),g&&(0,s.jsxs)("div",{className:"space-y-6",children:[["team","enterprise"].includes((null==f?void 0:f.id)||"")?(0,s.jsxs)(eY.F,{withIcon:!0,variant:"info",title:"You will be charged for any additional usage on the ".concat((null==f?void 0:f.name)||""," plan"),children:[(null==f?void 0:f.name)||""," plan requires you to have spend cap off at all times. Your projects will never become unresponsive. Only when your"," ",(0,s.jsx)(ec(),{href:"/org/".concat(a,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included usage"})," ","is exceeded will you be charged for any additional usage."]}):(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"If you need to go beyond the included quota, simply switch off your spend cap to pay for additional usage."}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"rounded-md bg-surface-200 w-[160px] h-[96px] shadow",children:(0,s.jsx)(eB(),{alt:"Spend Cap",width:160,height:96,src:j?"".concat(eH.o2,"/img/spend-cap-off").concat((null==n?void 0:n.includes("dark"))?"":"--light",".png?v=3"):"".concat(eH.o2,"/img/spend-cap-on").concat((null==n?void 0:n.includes("dark"))?"":"--light",".png?v=3")})})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"mb-1",children:["Spend cap is ",j?"disabled":"enabled"]}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:j?(0,s.jsx)("span",{children:"You will be charged for usage beyond the included quota."}):(0,s.jsx)("span",{children:"You won't be charged any extra for usage. However, your projects could become unresponsive or enter read only mode if you exceed the included quota."})}),(0,s.jsx)(eq.A,{projectUpdateDisabled:o,children:(0,s.jsx)(F.$,{type:"default",className:"mt-4 pointer-events-auto",disabled:!v,onClick:()=>i.setPanelKey("costControl"),children:"Change spend cap"})})]})]})]})]}):(0,s.jsx)(u.A,{resourceText:"update this organization's cost control"})})]}),(0,s.jsx)(e2,{"data-sentry-element":"SpendCapSidePanel","data-sentry-source-file":"CostControl.tsx"})]})};var e4=a(26090),e3=a(25344),e5=a(24781),e6=a(65325),e8=a(89714);async function e9(e){let{payment_method_id:t,amount:a,slug:s,hcaptchaToken:n}=e;if(!t)throw Error("Payment method id required");if(!n)throw Error("Captcha not submitted");if(!s)throw Error("Slug is required");let{data:r,error:l}=await (0,_.bE)("/platform/organizations/{slug}/billing/credits/top-up",{params:{path:{slug:s}},body:{payment_method_id:t,amount:a,hcaptcha_token:n}});return l&&(0,_.H4)(l),r}let e7=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,G.n)(e=>e9(e),{async onSuccess(t,a,s){await (null==e?void 0:e(t,a,s))},async onError(e,a,s){void 0===t?g.oR.error("Failed to top up credits: ".concat(e.message)):t(e,a,s)},...a})};var te=a(96277),tt=a(34587),ta=a(98883),ts=a(99667),tn=a(55335);async function tr(e){let{slug:t,hcaptchaToken:a}=e,{data:s,error:n}=await (0,_.bE)("/platform/organizations/{slug}/payments/setup-intent",{params:{path:{slug:t}},body:{hcaptchaToken:a}});return n&&(0,_.H4)(n),s}let tl=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,G.n)(e=>tr(e),{async onSuccess(t,a,s){await (null==e?void 0:e(t,a,s))},async onError(e,a,s){void 0===t?g.oR.error("Failed to setup intent: ".concat(e.message)):t(e,a,s)},...a})};async function ti(e){let{slug:t,paymentMethodId:a}=e;if(!t)throw Error("Slug is required");let{data:s,error:n}=await (0,_.yJ)("/platform/organizations/{slug}/payments/default",{body:{payment_method_id:a},params:{path:{slug:t}}});if(n)throw(0,_.H4)(n);return s}let to=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>ti(e),{async onSuccess(t,a,n){let{slug:r,paymentMethodId:l}=a;s.setQueriesData(X.O.paymentMethods(r),e=>e?{...e,defaultPaymentMethodId:l,data:e.data.map(e=>({...e,is_default:e.id===l}))}:e),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to mark payment method as default: ".concat(e.message)):t(e,a,s)},...a})};var td=a(44728),tc=a(27863);let tu=e=>{let{returnUrl:t,onCancel:a,onConfirm:n,showSetDefaultCheckbox:r=!1,autoMarkAsDefaultPaymentMethod:l=!1}=e,o=(0,e3.useStripe)(),d=(0,e3.useElements)(),c=(0,i.a)(),[u,m]=(0,h.useState)(!1),[p,x]=(0,h.useState)(r),y=(0,B.jE)(),{mutateAsync:f}=to(),j=async e=>{if(e.preventDefault(),!o||!d)return void console.error("Stripe.js has not loaded");m(!0),void 0!==document&&document.body.classList.add("!pointer-events-auto");let{error:a,setupIntent:s}=await o.confirmSetup({elements:d,redirect:"if_required",confirmParams:{return_url:t}});if(a){var r;m(!1),g.oR.error(null!=(r=null==a?void 0:a.message)?r:" Failed to save card details")}else{if((p||l)&&c&&"string"==typeof(null==s?void 0:s.payment_method))try{await f({slug:c.slug,paymentMethodId:s.payment_method}),await y.invalidateQueries(X.O.paymentMethods(c.slug)),y.setQueriesData(X.O.paymentMethods(c.slug),e=>e?{...e,defaultPaymentMethodId:s.payment_method,data:e.data.map(e=>({...e,is_default:e.id===s.payment_method}))}:e)}catch(e){g.oR.error("Failed to set payment method as default")}else c&&await y.invalidateQueries(X.O.paymentMethods(c.slug));m(!1),n()}void 0!==document&&document.body.classList.remove("!pointer-events-auto")};return(0,s.jsxs)("div",{"data-sentry-component":"AddPaymentMethodForm","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,s.jsxs)(tn.A.Content,{className:"transition ".concat(u?"pointer-events-none opacity-75":"opacity-100"),"data-sentry-element":"unknown","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,s.jsx)(e3.PaymentElement,{className:"[.p-LinkAutofillPrompt]:pt-0","data-sentry-element":"PaymentElement","data-sentry-source-file":"AddPaymentMethodForm.tsx"}),r&&(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mt-4 mb-2",children:[(0,s.jsx)(td.S,{id:"save-as-default",checked:p,onCheckedChange:e=>{"boolean"==typeof e&&x(e)}}),(0,s.jsx)(tc.J,{htmlFor:"save-as-default",className:"text-foreground-light",children:"Save as default payment method"})]})]}),(0,s.jsx)(tn.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"AddPaymentMethodForm.tsx"}),(0,s.jsxs)(tn.A.Content,{className:"flex items-center space-x-2","data-sentry-element":"unknown","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,s.jsx)(F.$,{htmlType:"button",size:"small",type:"default",onClick:a,block:!0,disabled:u,"data-sentry-element":"Button","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:"Cancel"}),(0,s.jsx)(F.$,{block:!0,htmlType:"button",size:"small",type:"primary",loading:u,disabled:u,onClick:j,"data-sentry-element":"Button","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:"Add payment method"})]})]})},tm=(0,e5.c)(eH.WS),tp=e=>{let{visible:t,returnUrl:a,onCancel:n,onConfirm:r,showSetDefaultCheckbox:l,autoMarkAsDefaultPaymentMethod:o}=e,{resolvedTheme:d}=(0,eF.D)(),[c,u]=(0,h.useState)(),m=(0,i.a)(),p=(0,te.F)(),[x,y]=(0,h.useState)(null),[f,j]=(0,h.useState)(null),{mutate:v}=tl({onSuccess:e=>{u(e)},onError:e=>{g.oR.error("Failed to setup intent: ".concat(e.message))}}),b=(0,h.useCallback)(e=>{j(e)},[]);(0,h.useEffect)(()=>{let e=async e=>{let t=null==m?void 0:m.slug;return t?e?void(u(void 0),v({slug:t,hcaptchaToken:e})):console.error("HCaptcha token required"):console.error("Slug is required")};(async()=>{if(t&&f&&p){let t=x;try{if(!t){var a;let e=await f.execute({async:!0});t=null!=(a=null==e?void 0:e.response)?a:null}}catch(e){return}await e(null!=t?t:void 0),N()}})()},[t,f,p]);let N=()=>{y(null),null==f||f.resetCaptcha()},S={clientSecret:c?c.client_secret:"",appearance:{theme:(null==d?void 0:d.includes("dark"))?"night":"flat",labels:"floating"}},A=()=>(u(void 0),n());return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e4.A,{ref:b,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{A(),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{y(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{y(null)},"data-sentry-element":"HCaptcha","data-sentry-source-file":"AddNewPaymentMethodModal.tsx"}),(0,s.jsx)(tn.A,{hideFooter:!0,size:"medium",visible:t&&void 0!==c,header:"Add new payment method",onCancel:A,className:"PAYMENT","data-sentry-element":"Modal","data-sentry-source-file":"AddNewPaymentMethodModal.tsx",children:(0,s.jsx)(e3.Elements,{stripe:tm,options:S,"data-sentry-element":"Elements","data-sentry-source-file":"AddNewPaymentMethodModal.tsx",children:(0,s.jsx)(tu,{returnUrl:a,onCancel:A,onConfirm:()=>(u(void 0),r()),showSetDefaultCheckbox:l,autoMarkAsDefaultPaymentMethod:o,"data-sentry-element":"AddPaymentMethodForm","data-sentry-source-file":"AddNewPaymentMethodModal.tsx"})})})]})};async function tx(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:s,error:n}=await (0,_.Jt)("/platform/organizations/{slug}/payments",{params:{path:{slug:a}},headers:{Version:"2"},signal:t});return n&&(0,_.H4)(n),s}let th=function(e){let{slug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,m.SE)(c.aG.BILLING_READ,"stripe.payment_methods");return(0,E.I)(X.O.paymentMethods(t),e=>{let{signal:a}=e;return tx({slug:t},a)},{enabled:a&&void 0!==t&&n,...s})};var tg=a(42073),ty=a(85652),tf=a(97318);let tj=e=>{let{selectedPaymentMethod:t,onSelectPaymentMethod:a,layout:n="vertical"}=e,r=(0,i.a)(),l=null==r?void 0:r.slug,[o,d]=(0,h.useState)(!1),{data:u,isLoading:p,refetch:x}=th({slug:l}),y=(0,m.SE)(c.aG.BILLING_WRITE,"stripe.payment_methods");return(0,h.useEffect)(()=>{if((null==u?void 0:u.data)&&u.data.length>0){let e=u.data.some(e=>e.id===t);if(!t||!e){let e=u.data.find(e=>e.is_default);void 0!==e?a(e.id):a(u.data[0].id)}}},[t,u,a]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:p?(0,s.jsxs)("div",{className:"flex items-center px-4 py-2 space-x-4 border rounded-md border-strong bg-surface-200",children:[(0,s.jsx)(tg.A,{className:"animate-spin",size:14}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Retrieving payment methods"})]}):(null==u?void 0:u.data.length)===0?(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border border-dashed rounded-md bg-alternative",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-foreground-light",children:[(0,s.jsx)(e6.A,{size:16,strokeWidth:1.5}),(0,s.jsx)("p",{className:"text-sm",children:"No payment methods"})]}),(0,s.jsx)(A.G,{type:"default",disabled:!y,icon:(0,s.jsx)(ty.A,{}),onClick:()=>d(!0),htmlType:"button",tooltip:{content:{side:"bottom",text:y?void 0:(0,s.jsx)("div",{className:"w-48 text-center",children:(0,s.jsx)("span",{children:"You need additional permissions to add new payment methods to this organization"})})}},children:"Add new"})]}):(0,s.jsxs)(el.A,{layout:n,label:"Payment method",value:t,onChange:a,className:"flex items-center",children:[null==u?void 0:u.data.map(e=>{let t="•••• •••• •••• ".concat(e.card.last4);return(0,s.jsx)(el.A.Option,{label:t,value:e.id,addOnBefore:()=>(0,s.jsx)("img",{alt:"Credit Card Brand",src:"".concat(eH.o2,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),children:(0,s.jsx)("div",{children:t})},e.id)}),(0,s.jsxs)("div",{className:"flex items-center px-3 py-2 space-x-2 transition cursor-pointer group hover:bg-surface-300",onClick:()=>d(!0),children:[(0,s.jsx)(tf.A,{size:16}),(0,s.jsx)("p",{className:"transition text-foreground-light group-hover:text-foreground",children:"Add new payment method"})]})]})}),(0,s.jsx)(tp,{visible:o,returnUrl:"".concat((0,P.AP)(),"/org/").concat(null==r?void 0:r.slug,"/billing?panel=subscriptionPlan&source=paymentMethod"),onCancel:()=>d(!1),autoMarkAsDefaultPaymentMethod:!0,onConfirm:async()=>{var e;d(!1),g.oR.success("Successfully added new payment method");let{data:t}=await x();(null==t||null==(e=t.data)?void 0:e.length)&&a((null==t?void 0:t.data.reduce((e,t)=>e.created>t.created?e:t,t.data[0])).id)},"data-sentry-element":"AddNewPaymentMethodModal","data-sentry-source-file":"PaymentMethodSelection.tsx"})]})},tv=(0,e5.c)(eH.WS),tb=eE.z.object({amount:eE.z.coerce.number().gte(100,"Amount must be between $100 - $999.").lte(999,"Amount must be between $100 - $999.").int("Amount must be a whole number."),paymentMethod:eE.z.string()}),tN=e=>{let{slug:t}=e,{resolvedTheme:a}=(0,eF.D)(),n=(0,B.jE)(),r=(0,m.SE)(c.aG.BILLING_WRITE,"stripe.subscriptions"),l=(0,m.Lh)(),{mutateAsync:i,isLoading:o,error:d}=e7({}),u=(0,eI.mN)({resolver:(0,eC.u)(tb),defaultValues:{amount:100,paymentMethod:""}}),[p,x]=(0,h.useState)(!1),[y,f]=(0,h.useState)(!1),j=(0,te.F)(),[v,b]=(0,h.useState)(null),[N,S]=(0,h.useState)(null),w=(0,h.useCallback)(e=>{S(e)},[]),_=()=>{b(null),null==N||N.resetCaptcha()},C=async()=>{if(p&&N&&j){let t=v;try{if(!t){var e;let a=await N.execute({async:!0});t=null!=(e=null==a?void 0:a.response)?e:null,b(t)}}catch(e){}return t}};(0,h.useEffect)(()=>{C()},[p,N,j]);let[I,E]=(0,h.useState)(""),[T,R]=(0,h.useState)(),k=async e=>{let{amount:a,paymentMethod:s}=e;R(void 0);let n=await C();await i({slug:t,amount:a,payment_method_id:s,hcaptchaToken:n},{onSuccess:e=>{"succeeded"===e.status?L():E(e.payment_intent_secret||""),_()}})},M=(0,h.useMemo)(()=>({clientSecret:I,appearance:{theme:(null==a?void 0:a.includes("dark"))?"night":"flat",labels:"floating"}}),[I,a]),P=e=>{x(e),e||(S(null),R(void 0),E(""))},D=e=>{var t;E(""),R(e),(null==(t=e.paymentIntent)?void 0:t.status)==="succeeded"&&L()},L=async()=>{P(!1),await n.invalidateQueries(e$.s.orgSubscription(t)),g.oR.success("Successfully topped up balance. It may take a minute to reflect in your account.")};return(0,s.jsx)("div",{className:"flex items-center justify-end py-4 px-8","data-sentry-component":"CreditTopUp","data-sentry-source-file":"CreditTopUp.tsx",children:(0,s.jsxs)(tt.lG,{open:p,onOpenChange:e=>P(e),"data-sentry-element":"Dialog","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,s.jsx)(tt.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreditTopUp.tsx",children:(0,s.jsx)(A.G,{type:"default",className:"pointer-events-auto",disabled:!r||!l,tooltip:{content:{side:"bottom",text:l&&!r?"You need additional permissions to top up credits":void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"CreditTopUp.tsx",children:"Top Up"})}),(0,s.jsxs)(tt.Cf,{onInteractOutside:e=>e.preventDefault(),"data-sentry-element":"DialogContent","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,s.jsx)(e4.A,{ref:w,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{b(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{b(null)},"data-sentry-element":"HCaptcha","data-sentry-source-file":"CreditTopUp.tsx"}),(0,s.jsxs)(tt.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,s.jsx)(tt.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"CreditTopUp.tsx",children:"Top Up Credits"}),(0,s.jsx)(tt.rr,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"CreditTopUp.tsx",children:"On successful payment, an invoice will be issued and you'll be granted credits. Credits will be applied to future invoices only and are not refundable. The topped up credits do not expire."})]}),(0,s.jsx)(tt.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreditTopUp.tsx"}),(0,s.jsx)(eT.lV,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreditTopUp.tsx",children:(0,s.jsxs)("form",{id:"credit-top-up",onSubmit:u.handleSubmit(k),children:[(0,s.jsxs)(tt.OO,{className:"flex flex-col gap-2","data-sentry-element":"DialogSection","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,s.jsx)(eT.zB,{control:u.control,name:"amount",render:e=>{let{field:t}=e;return(0,s.jsx)(eM.M,{label:"Amount (USD)",className:"gap-1",children:(0,s.jsx)(ek.p,{...t,type:"number",placeholder:"100"})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreditTopUp.tsx"}),(0,s.jsx)(eT.zB,{control:u.control,name:"paymentMethod",render:()=>(0,s.jsx)(tj,{onSelectPaymentMethod:e=>u.setValue("paymentMethod",e),selectedPaymentMethod:u.getValues("paymentMethod")}),"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreditTopUp.tsx"}),(0,s.jsxs)("p",{className:"prose text-sm",children:["For larger discounted credit packages, please"," ",(0,s.jsx)(ec(),{href:"/support/new?slug=".concat(t,"&subject=").concat(encodeURIComponent("I would like to inquire about larger credit packages"),"&category=").concat(c.S.SALES_ENQUIRY),target:"_blank","data-sentry-element":"Link","data-sentry-source-file":"CreditTopUp.tsx",children:"reach out."})]}),T&&T.error&&(0,s.jsxs)(ta.Fc,{variant:"destructive",children:[(0,s.jsx)(e6.A,{className:"h-4 w-4"}),(0,s.jsx)(ta.XL,{children:"Error confirming payment"}),(0,s.jsx)(ta.TN,{children:T.error.message})]}),(null==T?void 0:T.paymentIntent)&&"processing"===T.paymentIntent.status&&(0,s.jsxs)(ta.Fc,{variant:"default",children:[(0,s.jsx)(e8.A,{className:"h-4 w-4"}),(0,s.jsx)(ta.XL,{children:"Payment processing"}),(0,s.jsx)(ta.TN,{children:"Your payment is processing and we are waiting for a confirmation from your card issuer. If the payment goes through you'll automatically be credited. Please check back later."})]}),d&&(0,s.jsxs)(ta.Fc,{variant:"destructive",children:[(0,s.jsx)(e6.A,{className:"h-4 w-4"}),(0,s.jsx)(ta.XL,{children:"Error topping up balance"}),(0,s.jsx)(ta.TN,{children:d.message})]})]}),!(null==T?void 0:T.paymentIntent)&&(0,s.jsx)(tt.Es,{children:(0,s.jsx)(F.$,{htmlType:"submit",type:"primary",loading:o||y,children:"Top Up"})})]})}),tv&&I&&(0,s.jsx)(e3.Elements,{stripe:tv,options:M,children:(0,s.jsx)(tS,{paymentIntentSecret:I,onPaymentIntentConfirm:e=>D(e),onLoadingChange:e=>f(e),paymentMethodId:u.getValues().paymentMethod})})]})]})})},tS=e=>{let{paymentIntentSecret:t,onPaymentIntentConfirm:a,onLoadingChange:n,paymentMethodId:r}=e,l=(0,e3.useStripe)();return(0,h.useEffect)(()=>{l&&t&&(n(!0),l.confirmCardPayment(t,{payment_method:r}).then(e=>{a(e),n(!1)}).catch(e=>{n(!1)}))},[t,l]),(0,s.jsx)(ts.$,{loading:!0,"data-sentry-element":"LoadingLine","data-sentry-component":"PaymentConfirmation","data-sentry-source-file":"CreditTopUp.tsx"})},tA=()=>{var e;let{slug:t}=(0,$.g)(),a=(0,eG._)("creditTopUp"),n=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions"),{data:l,error:i,isLoading:o,isError:p,isSuccess:x}=(0,d.j5)({orgSlug:t},{enabled:n}),h=(null!=(e=null==l?void 0:l.customer_balance)?e:0)/100,g=h<0,y=h>0,f=g&&0!==h?h.toFixed(2).toString().replace("-",""):h.toFixed(2);return(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"CreditBalance","data-sentry-source-file":"CreditBalance.tsx",children:[(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"CreditBalance.tsx",children:(0,s.jsxs)("div",{className:"sticky space-y-2 top-12 pr-3",children:[(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Credit Balance"})}),(0,s.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Credits will be applied to future invoices, before charging your payment method. If your credit balance runs out, your default payment method will be charged."})]})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"CreditBalance.tsx",children:n?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Z.lB,{footer:a?(0,s.jsx)(tN,{slug:t}):null,children:(0,s.jsx)(K.y9,{children:(0,s.jsxs)(K.DE,{fullWidth:!0,loading:o,children:[p&&(0,s.jsx)(S.A,{subject:"Failed to retrieve organization customer profile",error:i}),x&&(0,s.jsxs)("div",{className:"flex w-full justify-between items-center",children:[(0,s.jsx)("span",{children:"Balance"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[y&&(0,s.jsx)("h4",{className:"opacity-50",children:"-"}),(0,s.jsx)("h4",{className:"opacity-50",children:"$"}),(0,s.jsx)("h2",{className:"text-2xl relative",children:f}),g&&(0,s.jsx)("h4",{className:"opacity-50",children:"/credits"})]})]})]})})})}):(0,s.jsx)(u.A,{resourceText:"view this organization's credits"})})]})},tw=e=>{var t,a;let{selectedPaymentMethod:n,onClose:r}=e,{slug:l}=(0,$.g)(),{mutate:i,isLoading:o}=to({onSuccess:()=>{g.oR.success("Successfully changed payment method to the card ending with ".concat(n.card.last4)),r()},onError:e=>{g.oR.error("Failed to change payment method: ".concat(e.message))}}),d=async()=>l?n?void i({slug:l,paymentMethodId:n.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,s.jsx)(tn.A,{visible:void 0!==n,size:"medium",header:"Confirm to use payment method ending with ".concat(null==n||null==(t=n.card)?void 0:t.last4),onCancel:()=>r(),customFooter:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(F.$,{type:"default",disabled:o,onClick:()=>r(),children:"Cancel"}),(0,s.jsx)(F.$,{type:"primary",disabled:o,loading:o,onClick:d,children:"Confirm"})]}),"data-sentry-element":"Modal","data-sentry-component":"ChangePaymentMethodModal","data-sentry-source-file":"ChangePaymentMethodModal.tsx",children:(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"ChangePaymentMethodModal.tsx",children:(0,s.jsxs)("p",{className:"text-sm",children:["Upon clicking confirm, all future charges will be deducted from the card ending with"," ",null==n||null==(a=n.card)?void 0:a.last4,". There are no immediate charges."]})})})};var t_=a(86401),tC=a(90406),tI=a(33656);let tE=e=>{var t,a,n,r;let{paymentMethod:l,canUpdatePaymentMethods:i=!0,paymentMethodType:o,subscriptionPlan:d,paymentMethodCount:c,setSelectedMethodForUse:u,setSelectedMethodToDelete:m}=e,p=l.is_default,x=!l.is_default||"free"===d&&1===c,h=null!=(n=null==(t=l.card)?void 0:t.exp_year)?n:0,g=null!=(r=null==(a=l.card)?void 0:a.exp_month)?r:0,y=new Date().getMonth()+1,j=new Date().getFullYear();return l.card?(0,s.jsxs)("div",{className:"flex items-center justify-between gap-8","data-sentry-component":"CreditCard","data-sentry-source-file":"CreditCard.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center gap-8",children:[(0,s.jsx)("img",{alt:"Credit card brand",src:"".concat(eH.o2,"/img/payment-methods/").concat(l.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,s.jsxs)("p",{className:"prose text-sm font-mono",children:["**** **** **** ",l.card.last4]}),(0,s.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",l.card.exp_month,"/",l.card.exp_year]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[h===j&&g===y&&(0,s.jsx)(f.E,{variant:"warning",children:"Expiring soon"}),(h<j||h===j&&g<y)&&(0,s.jsx)(f.E,{variant:"destructive",children:"Expired"}),p&&(0,s.jsx)(f.E,{variant:"brand",children:"Active"}),i&&(0,s.jsxs)(tI.rI,{children:[(0,s.jsx)(tI.ty,{asChild:!0,children:(0,s.jsx)(F.$,{type:"outline",className:"hover:border-muted px-1",icon:(0,s.jsx)(t_.A,{}),"aria-label":"More options"})}),(0,s.jsxs)(tI.SQ,{align:"end",className:"w-36",children:["card"===o&&!p&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tI._2,{onClick:()=>null==u?void 0:u(l),children:(0,s.jsx)("p",{children:"Use this card"})},"make-default"),(0,s.jsx)(tI.mB,{})]}),(0,s.jsx)(tC.x,{disabled:!x,className:"!pointer-events-auto",onClick:()=>null==m?void 0:m(l),tooltip:{content:{side:"left",text:x?void 0:"Unable to delete a card that is currently active"}},children:(0,s.jsx)("p",{children:"Delete card"})},"delete-method")]})]})]})]},l.id):null};async function tT(e){let{slug:t,cardId:a}=e,{data:s,error:n}=await (0,_.yH)("/platform/organizations/{slug}/payments",{body:{card_id:a},params:{path:{slug:t}}});return n&&(0,_.H4)(n),s}let tR=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>tT(e),{async onSuccess(t,a,n){let{slug:r}=a;await s.invalidateQueries(X.O.paymentMethods(r)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to delete payment method: ".concat(e.message)):t(e,a,s)},...a})};var tk=a(82942);let tM=e=>{var t;let{selectedPaymentMethod:a,onClose:n}=e,{slug:r}=(0,$.g)(),{mutate:l,isLoading:i}=tR({onSuccess:()=>{var e;g.oR.success("Successfully removed payment method ending with ".concat(null==a||null==(e=a.card)?void 0:e.last4)),n()}}),o=async()=>r?a?void l({slug:r,cardId:a.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,s.jsx)(tn.A,{visible:void 0!==a,size:"medium",header:"Confirm to delete payment method ending with ".concat(null==a||null==(t=a.card)?void 0:t.last4),onCancel:()=>n(),customFooter:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(F.$,{type:"default",disabled:i,onClick:()=>n(),children:"Cancel"}),(0,s.jsx)(F.$,{type:"primary",disabled:i,loading:i,onClick:o,children:"Confirm"})]}),"data-sentry-element":"Modal","data-sentry-component":"DeletePaymentMethodModal","data-sentry-source-file":"DeletePaymentMethodModal.tsx",children:(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DeletePaymentMethodModal.tsx",children:(0,s.jsx)(tk.Z,{type:"default",title:"This will permanently delete your payment method.",description:"You can re-add the payment method any time.","data-sentry-element":"Admonition","data-sentry-source-file":"DeletePaymentMethodModal.tsx"})})})},tP=()=>{var e,t,a;let{slug:n}=(0,$.g)(),l=(0,i.a)(),[o,p]=(0,h.useState)(),[x,y]=(0,h.useState)(),[f,j]=(0,h.useState)(!1),{data:v}=(0,d.j5)({orgSlug:n}),{data:b,error:N,isLoading:A,isError:_,isSuccess:C}=th({slug:n}),I=(0,m.SE)(c.aG.BILLING_READ,"stripe.payment_methods"),E=(0,m.SE)(c.aG.BILLING_WRITE,"stripe.payment_methods");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"PaymentMethods.tsx",children:[(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"PaymentMethods.tsx",children:(0,s.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Payment Methods"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light mb-2 pr-4 m-0",children:"Payments for your subscription are made using the default card."})]})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"PaymentMethods.tsx",children:(null==l?void 0:l.managed_by)!==void 0&&(null==l?void 0:l.managed_by)!=="supabase"?(0,s.jsx)(w.A,{partner:null==l?void 0:l.managed_by,resource:"Payment Methods",cta:{installationId:null==l?void 0:l.partner_id}}):I?(0,s.jsxs)(s.Fragment,{children:[A&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),_&&(0,s.jsx)(S.A,{subject:"Failed to retrieve payment methods",error:N}),C&&(0,s.jsxs)(s.Fragment,{children:[(null==v?void 0:v.payment_method_type)==="invoice"&&(0,s.jsx)(eY.F,{withIcon:!0,variant:"info",title:"Payment is currently by invoice",actions:[(0,s.jsx)(F.$,{asChild:!0,type:"default",children:(0,s.jsx)(ec(),{href:"/support/new?category=billing&subject=Request%20to%20change%20payment%20method",target:"_blank",rel:"noreferrer",className:"ml-3",children:"Contact support"})},"payment-method-support")],children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}),(0,s.jsx)(Z.lB,{footer:(0,s.jsxs)("div",{className:"flex items-center justify-between py-4 px-8",children:[E?(0,s.jsx)("div",{}):(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to manage payment methods"}),(0,s.jsx)(F.$,{type:"default",icon:(0,s.jsx)(tf.A,{}),disabled:!E,onClick:()=>j(!0),children:"Add new card"})]}),children:(0,s.jsx)(K.y9,{children:(0,s.jsx)(K.DE,{fullWidth:!0,loading:!1,children:(null!=(a=null==b||null==(e=b.data)?void 0:e.length)?a:0)===0?(0,s.jsxs)("div",{className:"flex items-center gap-2 opacity-50",children:[(0,s.jsx)(ty.A,{size:16,strokeWidth:1.5}),(0,s.jsx)("p",{className:"text-sm",children:"No payment methods"})]}):(0,s.jsx)("div",{className:"space-y-3",children:null==b||null==(t=b.data)?void 0:t.map(e=>{var t;return(0,s.jsx)(tE,{paymentMethod:e,canUpdatePaymentMethods:E,paymentMethodType:null==v?void 0:v.payment_method_type,setSelectedMethodForUse:p,setSelectedMethodToDelete:y,paymentMethodCount:null!=(t=null==b?void 0:b.data.length)?t:0,subscriptionPlan:null==v?void 0:v.plan.id},e.id)})})})})})]})]}):(0,s.jsx)(u.A,{resourceText:"view this organization's payment methods"})})]}),(0,s.jsx)(tp,{visible:f,returnUrl:"".concat((0,P.AP)(),"/org/").concat(n,"/billing"),onCancel:()=>j(!1),onConfirm:()=>{j(!1),g.oR.success("Successfully added new payment method")},showSetDefaultCheckbox:!0,"data-sentry-element":"AddNewPaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"}),(0,s.jsx)(tw,{selectedPaymentMethod:o,onClose:()=>p(void 0),"data-sentry-element":"ChangePaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"}),(0,s.jsx)(tM,{selectedPaymentMethod:x,onClose:()=>y(void 0),"data-sentry-element":"DeletePaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"})]})};var tD=a(30227),tL=a(55739);let tO=()=>{let e=(0,i.a)(),{data:t,isSuccess:a}=(0,tD.n)({orgSlug:null==e?void 0:e.slug}),n=!!(null==t?void 0:t.usages.find(e=>{var t;return e.metric!==ex.Lb.DISK_SIZE_GB_HOURS_GP3&&!e.unlimited&&e.capped&&e.usage>(null!=(t=null==e?void 0:e.pricing_free_units)?t:0)}));if(!a||!e)return null;let r=null;return(!n||(null==e?void 0:e.restriction_status)?(null==e?void 0:e.restriction_status)==="grace_period"?r="gracePeriod":(null==e?void 0:e.restriction_status)==="grace_period_over"?r="gracePeriodOver":(null==e?void 0:e.restriction_status)==="restricted"&&(r="restricted"):r="exceededLimits",null!==r&&(null==e?void 0:e.restriction_data))?(0,s.jsxs)(s.Fragment,{children:["exceededLimits"===r&&(0,s.jsxs)(ta.Fc,{variant:"destructive",children:[(0,s.jsx)(tL.HV,{}),(0,s.jsx)(ta.XL,{children:"Your organization's usage has exceeded its included quota"}),(0,s.jsxs)(ta.TN,{children:[(0,s.jsxs)("p",{children:["Your projects can become unresponsive or enter read-only mode."," ","free"===e.plan.id?"Please upgrade to the Pro Plan to ensure that your projects remain available.":"Please disable spend cap to ensure that your projects remain available."]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,s.jsx)(F.$,{asChild:!0,type:"default",children:(0,s.jsx)(ec(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=").concat("free"===e.plan.id?"subscriptionPlan":"costControl"),children:"free"===e.plan.id?"Upgrade plan":"Change spend cap"})},"upgrade-button"),(0,s.jsx)(F.$,{asChild:!0,type:"default",icon:(0,s.jsx)(ez.A,{}),children:(0,s.jsx)("a",{href:"https://supabase.com/docs/guides/platform/cost-control#spend-cap",children:"About spend cap"})})]})]})]}),"gracePeriod"===r&&(0,s.jsxs)(ta.Fc,{variant:"warning",children:[(0,s.jsx)(tL.id,{}),(0,s.jsx)(ta.XL,{children:"Your grace period has started."}),(0,s.jsxs)(ta.TN,{children:[(0,s.jsxs)("p",{className:"leading-tight",children:["Your organization is over its quota. You can continue with your projects until your grace period ends on"," ",(0,s.jsx)("span",{className:"text-foreground",children:x()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". After that, the Fair Use Policy will apply. If you plan to maintain this level of usage, upgrade your plan to avoid any restrictions. If restrictions are applied, requests to your projects will return a 402 status code."]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,s.jsx)(F.$,{asChild:!0,type:"default",children:(0,s.jsx)(ec(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan&source=fairUseGracePeriodStarted"),children:"Upgrade plan"})},"upgrade-button"),(0,s.jsx)(F.$,{asChild:!0,type:"default",icon:(0,s.jsx)(ez.A,{}),children:(0,s.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]}),"gracePeriodOver"===r&&(0,s.jsxs)(ta.Fc,{variant:"warning",children:[(0,s.jsx)(tL.id,{}),(0,s.jsx)(ta.XL,{children:"Your grace period is over."}),(0,s.jsxs)(ta.TN,{children:[(0,s.jsxs)("p",{children:["Your grace period ended on"," ",(0,s.jsx)("span",{className:"text-foreground",children:x()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". Fair Use Policy applies now. Stay below your plan’s quota or upgrade your plan if you expect to exceed it. If you exceed your quota, requests will respond with a 402 status code."]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,s.jsx)(F.$,{asChild:!0,type:"default",children:(0,s.jsx)(ec(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan&source=fairUseGracePeriodOver"),children:"Upgrade plan"})},"upgrade-button"),(0,s.jsx)(F.$,{asChild:!0,type:"default",icon:(0,s.jsx)(ez.A,{}),children:(0,s.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]}),"restricted"===r&&(0,s.jsxs)(ta.Fc,{variant:"destructive",children:[(0,s.jsx)(tL.HV,{}),(0,s.jsx)(ta.XL,{children:"All services are restricted."}),(0,s.jsxs)(ta.TN,{children:[(0,s.jsxs)("p",{children:["Fair Use Policy applies and your service is restricted. Your projects are not able to serve requests and will respond with a 402 status code. You have exceeded your plan’s quota and your grace period ended on"," ",(0,s.jsx)("span",{className:"text-foreground",children:x()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". Upgrade to lift restrictions or wait until your quota refills."]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,s.jsx)(F.$,{asChild:!0,type:"default",children:(0,s.jsx)(ec(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan&source=fairUseRestricted"),children:"Upgrade plan"})},"upgrade-button"),(0,s.jsx)(F.$,{asChild:!0,type:"default",icon:(0,s.jsx)(ez.A,{}),children:(0,s.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]})]}):null};var tz=a(33312),tF=a.n(tz),tU=a(64238),tB=a(52385),tG=a(20179);async function tH(e){let{organizationSlug:t,tier:a}=e;if(!t)throw Error("organizationSlug is required");if(!a)throw Error("tier is required");let{data:s,error:n}=await (0,_.bE)("/platform/organizations/{slug}/billing/subscription/preview",{params:{path:{slug:t}},body:{tier:a},headers:{Version:"2"}});return n&&(0,_.H4)(n),s}let tV=function(e){let{organizationSlug:t,tier:a}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(X.O.subscriptionPreview(t,a),()=>tH({organizationSlug:t,tier:a}),{enabled:s&&void 0!==t&&void 0!==a,...n,retry:(e,t)=>("object"!=typeof t||null===t||!("code"in t)||400!==t.code)&&e<3})};async function tY(e,t){var a;let{slug:s}=e;if(!s)throw Error("Organization slug is required");let{data:n,error:r}=await (0,_.Jt)("/platform/organizations/{slug}",{params:{path:{slug:s}},signal:t});return r&&(0,_.H4)(r),{...n,billing_email:null!=(a=n.billing_email)?a:"Unknown",managed_by:n.slug.startsWith("vercel_icfg_")?"vercel-marketplace":"supabase",partner_id:n.slug.startsWith("vercel_")?n.slug.replace("vercel_",""):void 0}}let tq=function(e){let{slug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(X.O.detail(t),e=>{let{signal:a}=e;return tY({slug:t},a)},{enabled:a&&void 0!==t,...s,staleTime:18e5})};var tW=a(34262);async function t$(e,t){let{orgSlug:a}=e;if(!a)throw Error("orgSlug is required");let{error:s,data:n}=await (0,_.Jt)("/platform/organizations/{slug}/billing/plans",{params:{path:{slug:a}},signal:t});return s&&(0,_.H4)(s),n}let tJ=function(e){let{orgSlug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions");return(0,E.I)(e$.s.orgPlans(t),e=>{let{signal:a}=e;return t$({orgSlug:t},a)},{enabled:a&&void 0!==t&&n,...s})};var tZ=a(36567),tK=a(4397),tQ=a(32049),tX=a(60927);let t0=e=>{let{projectAddon:t}=e,a=t.addons.find(e=>"compute_instance"===e.type),n=t.addons.filter(e=>!["log_drain","auth_mfa_phone"].includes(e.type)).map(e=>"compute_instance"===e.type?"".concat(e.variant.name," Compute Instance"):e.variant.name);return(0,s.jsxs)("li",{className:"list-disc ml-6","data-sentry-component":"ProjectDowngradeListItem","data-sentry-source-file":"DowngradeModal.tsx",children:[t.name,": ",n.join(", ")," will be removed.",a?(0,s.jsxs)(s.Fragment,{children:[" ","Project will also ",(0,s.jsx)("span",{className:"font-bold",children:"need to be restarted"})," due to change in compute instance"]}):""]})},t2=e=>{var t;let{visible:a,selectedPlan:n,subscription:r,onClose:l,onConfirm:i,projects:o}=e,d=(null==r?void 0:r.project_addons.flatMap(e=>{let t=e.addons.filter(e=>"ci_micro"!==e.variant.identifier);return t.length?{...e,addons:t}:[]}))||[],c=o.some(e=>"micro"===e.infra_compute_size);return(0,s.jsx)(tn.A,{size:"large",alignFooter:"right",variant:"warning",visible:a,onCancel:l,onConfirm:i,header:"Confirm to downgrade to ".concat(null==n?void 0:n.name," plan"),"data-sentry-element":"Modal","data-sentry-component":"DowngradeModal","data-sentry-source-file":"DowngradeModal.tsx",children:(0,s.jsxs)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DowngradeModal.tsx",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(tk.Z,{type:"warning",title:"Downgrading to the Free Plan will lead to reductions in your organization's quota",description:"If you're already past the limits of the Free Plan, your projects could become unresponsive or enter read only mode.","data-sentry-element":"Admonition","data-sentry-source-file":"DowngradeModal.tsx"}),((null!=(t=d.length)?t:0)>0||c)&&(0,s.jsx)(tk.Z,{type:"warning",title:"Projects affected by the downgrade",children:(0,s.jsxs)("ul",{className:"space-y-1 max-h-[100px] overflow-y-auto",children:[d.map(e=>(0,s.jsx)(t0,{projectAddon:e},e.ref)),o.filter(e=>"micro"===e.infra_compute_size).map(e=>(0,s.jsxs)("li",{className:"list-disc ml-6",children:[e.name,": Compute will be downgraded. Project will also"," ",(0,s.jsx)("span",{className:"font-bold",children:"need to be restarted"}),"."]},e.ref))]})})]}),(0,s.jsxs)("ul",{className:"mt-4 space-y-5 text-sm",children:[(0,s.jsxs)("li",{className:"flex items-center gap-3",children:[(0,s.jsx)(tQ.A,{size:18,"data-sentry-element":"PauseCircle","data-sentry-source-file":"DowngradeModal.tsx"}),(0,s.jsx)("span",{children:"Projects will be paused after a week of inactivity"})]}),(0,s.jsxs)("li",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)(tX.A,{size:18,"data-sentry-element":"MinusCircle","data-sentry-source-file":"DowngradeModal.tsx"}),(0,s.jsx)("span",{children:"Add ons from all projects under this organization will be removed."})]}),(0,s.jsx)("li",{className:"flex gap-3",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("strong",{children:["Before you downgrade to the ",null==n?void 0:n.name," plan, consider:"]}),(0,s.jsxs)("ul",{className:"space-y-2 mt-2",children:[(0,s.jsx)("li",{className:"list-disc ml-6 text-foreground-light",children:"Your projects no longer require their respective add ons."}),(0,s.jsxs)("li",{className:"list-disc ml-6 text-foreground-light",children:["Your resource consumption are well within the ",null==n?void 0:n.name," plan's quota."]}),(0,s.jsx)("li",{className:"list-disc ml-6 text-foreground-light",children:"Alternatively, you may also transfer projects across organizations."})]})]})})]}),(null==r?void 0:r.billing_via_partner)===!0&&"fly"===r.billing_partner&&(0,s.jsx)("p",{className:"mt-4 text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]})})},t1=e=>{let{plan:t,isCurrentPlan:a,billingPartner:n}=e,r=(0,i.a)(),l=null==r?void 0:r.slug,d=(0,tK.DW)(t,n),c=null==r?void 0:r.plan.name,{mutate:u}=(0,tZ.h)();return(0,s.jsxs)("div",{className:(0,o.cn)("grid grid-cols-1 md:grid-cols-3 border rounded-md bg-studio","py-4 col-span-12 justify-between gap-x-8"),"data-sentry-component":"EnterpriseCard","data-sentry-source-file":"EnterpriseCard.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-center px-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:(0,o.cn)("text-brand text-sm uppercase"),children:t.name}),a?(0,s.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):t.nameBadge?(0,s.jsx)("div",{className:"text-xs bg-surface-200 text-brand rounded px-2 py-0.5",children:t.nameBadge}):null]}),(0,s.jsx)("p",{className:"text-sm mt-2 mb-4",children:t.description}),(0,s.jsx)(F.$,{block:!0,asChild:!0,type:"default",size:"tiny",onClick:()=>u({action:"studio_pricing_plan_cta_clicked",properties:{selectedPlan:"Enterprise",currentPlan:c},groups:{organization:null!=l?l:"Unknown"}}),"data-sentry-element":"Button","data-sentry-source-file":"EnterpriseCard.tsx",children:(0,s.jsx)("a",{href:t.href,className:"hidden md:block",target:"_blank",children:t.cta})})]}),(0,s.jsxs)("div",{className:"flex flex-col justify-center col-span-2 px-4 md:px-0",children:[(0,s.jsx)("ul",{role:"list",className:"text-xs text-foreground-light md:grid md:grid-cols-2 md:gap-x-10",children:d.map(e=>(0,s.jsxs)("li",{className:"flex items-center py-2 first:mt-0",children:[(0,s.jsx)(tU.A,{className:"text-brand h-4 w-4","aria-hidden":"true",strokeWidth:3}),(0,s.jsx)("span",{className:"text-foreground mb-0 ml-3 ",children:"string"==typeof e?e:e[0]})]},"string"==typeof e?e:e[0]))}),(0,s.jsx)(F.$,{block:!0,asChild:!0,type:"default",size:"tiny",onClick:()=>u({action:"studio_pricing_plan_cta_clicked",properties:{selectedPlan:"Enterprise",currentPlan:c},groups:{organization:null!=l?l:"Unknown"}}),"data-sentry-element":"Button","data-sentry-source-file":"EnterpriseCard.tsx",children:(0,s.jsx)("a",{href:t.href,className:"visible md:hidden mt-8",target:"_blank",children:t.cta})})]})]},t.id)};var t4=a(86926),t3=a.n(t4),t5=a(37253),t6=a.n(t5),t8=a(85780);let t9=["Pricing","My project isn't getting traction","Poor customer service","Missing feature","I didn't see the value","Supabase didn't meet my needs","Dashboard is too complicated","Postgres is too complicated","Problem not solved","Too many bugs/issues","I decided to use something else","My work has finished/discontinued","I’m migrating to/starting a new project","None of the above"],t7=e=>{let{visible:t,projects:a,onClose:n}=e,{slug:r}=(0,$.g)(),l=(0,h.useRef)(null),[i,o]=(0,h.useState)(""),[d,c]=(0,h.useState)(null),[u,m]=(0,h.useReducer)(function(e,t){return t3()(e,t.target.value)?t6()(e,t.target.value):[...e,t.target.value]},[]),p=(0,eG._)("disableProjectCreationAndUpdate"),{mutate:x,isLoading:y}=eZ({onError:e=>{S(),g.oR.error("Failed to downgrade project: ".concat(e.message))}}),{mutateAsync:f,isLoading:j}=(0,t8.$)(),v=y||j,b=a.filter(e=>"nano"!==e.infra_compute_size),N=b.length>0,S=()=>{var e;c(null),null==(e=l.current)||e.resetCaptcha()},A=async()=>{if(0===u.length)return g.oR.error("Please select at least one reason for canceling your subscription");let e=d;if(!e){var t,a;let s=await (null==(t=l.current)?void 0:t.execute({async:!0}));e=null!=(a=null==s?void 0:s.response)?a:null,await w()}},w=async()=>{if(!r)return console.error("Slug is required");x({slug:r,tier:"tier_free"},{onSuccess:async()=>{S();try{await f({orgSlug:r,reasons:u.reduce((e,t)=>"".concat(e,"- ").concat(t,"\n"),""),message:i,exitAction:"downgrade"})}catch(e){}finally{g.oR.success(N?"Successfully downgraded organization to the Free Plan. Your projects are currently restarting to update their compute instances.":"Successfully downgraded organization to the Free Plan",{duration:N?8e3:4e3}),n(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"self-center",children:(0,s.jsx)(e4.A,{ref:l,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onVerify:e=>{c(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>c(null),onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{void 0!==document&&document.body.classList.remove("!pointer-events-auto")},"data-sentry-element":"HCaptcha","data-sentry-source-file":"ExitSurveyModal.tsx"})}),(0,s.jsxs)(tn.A,{hideFooter:!0,size:"xlarge",visible:t,onCancel:n,header:"Help us improve.","data-sentry-element":"Modal","data-sentry-source-file":"ExitSurveyModal.tsx",children:[(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"ExitSurveyModal.tsx",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"We always strive to improve Supabase as much as we can. Please let us know the reasons you are canceling your subscription so that we can improve in the future."}),(0,s.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:t9.map(e=>{let t=u.find(t=>t===e);return(0,s.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(t?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,s.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:m}),(0,s.jsx)("div",{children:e})]},e)})}),(0,s.jsx)("div",{className:"text-area-text-sm",children:(0,s.jsx)(er.A.TextArea,{id:"message",name:"message",value:i,onChange:e=>o(e.target.value),label:"Anything else that we can improve on?","data-sentry-element":"unknown","data-sentry-source-file":"ExitSurveyModal.tsx"})})]}),N&&(0,s.jsxs)(eY.F,{withIcon:!0,variant:"warning",title:"".concat(b.length," of your projects will be restarted upon clicking confirm,"),children:["This is due to changes in compute instances from the downgrade. Affected projects include ",b.map(e=>e.name).join(", "),"."]})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between border-t px-4 py-4",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-lighter",children:"The unused amount for the remaining time of your billing cycle will be refunded as credits"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(F.$,{type:"default",onClick:()=>n(),"data-sentry-element":"Button","data-sentry-source-file":"ExitSurveyModal.tsx",children:"Cancel"}),(0,s.jsx)(eq.A,{projectUpdateDisabled:p,"data-sentry-element":"ProjectUpdateDisabledTooltip","data-sentry-source-file":"ExitSurveyModal.tsx",children:(0,s.jsx)(F.$,{type:"danger",className:"pointer-events-auto",loading:v,disabled:p||v,onClick:A,"data-sentry-element":"Button","data-sentry-source-file":"ExitSurveyModal.tsx",children:"Confirm downgrade"})})]})]})]})]})},ae=e=>{let{visible:t,onClose:a}=e,n=(0,i.a)(),r=null==n?void 0:n.slug,{data:l}=(0,tG.A)({slug:r},{enabled:t});return(0,s.jsxs)(tn.A,{hideFooter:!0,visible:t,size:"medium",header:"Your organization has members who have exceeded their free project limits",onCancel:a,"data-sentry-element":"Modal","data-sentry-component":"MembersExceedLimitModal","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:[(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"The following members have reached their maximum limits for the number of active free plan projects within organizations where they are an administrator or owner:"}),(0,s.jsx)("ul",{className:"pl-5 text-sm list-disc text-foreground-light",children:(l||[]).map((e,t)=>(0,s.jsxs)("li",{children:[e.username||e.primary_email," (Limit: ",e.free_project_limit," free projects)"]},"member-".concat(t)))}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"These members will need to either delete, pause, or upgrade one or more of these projects before you're able to downgrade this project."})]})}),(0,s.jsx)(tn.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"MembersExceedLimitModal.tsx"}),(0,s.jsx)(tn.A.Content,{className:"flex items-center gap-2","data-sentry-element":"unknown","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:(0,s.jsx)(F.$,{htmlType:"button",type:"default",onClick:a,block:!0,"data-sentry-element":"Button","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:"Understood"})})]})};var at=a(19489),aa=a(73401),as=a(44518),an=a(46873);let ar=()=>{let e=at.A.filter(e=>e.text.length<180),t=Math.floor(Math.random()*e.length);return e[t]},al={tier_pro:"the Pro plan and create unlimited projects, daily backups and premium support when you need it",tier_team:"the Team plan for SOC2, SSO, priority support and greater data and log retention",default:"to a new plan"},ai={tier_free:"the Free plan with limited resources and active projects",tier_pro:"the Pro plan",default:"to a lower plan"},ao=e=>{var t,a,n,r,l,i,o,d;let{selectedTier:c,onClose:u,subscriptionPlanMeta:m,planMeta:p,subscriptionPreviewError:x,subscriptionPreviewIsLoading:y,subscriptionPreviewInitialized:j,subscriptionPreview:v,billingViaPartner:b,billingPartner:N,selectedOrganization:A,subscription:w,slug:_,currentPlanMeta:C,projects:I}=e,E=(0,B.jE)(),[T,R]=(0,h.useState)(),[k,M]=(0,h.useState)(ar());(0,h.useEffect)(()=>{void 0!==c&&"tier_free"!==c&&M(ar())},[c]);let{mutate:D,isLoading:L}=eZ({onSuccess:()=>{g.oR.success("Successfully ".concat((null==p?void 0:p.change_type)==="downgrade"?"downgraded":"upgraded"," subscription to ").concat(null==m?void 0:m.name,"!")),u(),window.scrollTo({top:0,left:0,behavior:"smooth"})},onError:e=>{g.oR.error("Unable to update subscription: ".concat(e.message))}}),O=async()=>{var e;return _?c?T||(null==w?void 0:w.payment_method_type)==="invoice"?void(T&&E.setQueriesData(X.O.paymentMethods(_),e=>e?{...e,defaultPaymentMethodId:T,data:e.data.map(e=>({...e,is_default:e.id===T}))}:e),D({slug:_,tier:(null==w||null==(e=w.plan)?void 0:e.id)==="team"&&c===eH.V$.PRO?eH.V$.PAYG:c,paymentMethod:T})):g.oR.error("Please select a payment method"):console.error("Selected plan is required"):console.error("org slug is required")},z=(null==m||null==(a=m.features)||null==(t=a[0])?void 0:t.features)||[],U=(null==C||null==(r=C.features)||null==(n=r[0])?void 0:n.features)||[],G=(null==p?void 0:p.change_type)==="downgrade"?U.filter(e=>{let t="string"==typeof e?e:e[0];return!z.some(e=>("string"==typeof e?e:e[0])===t)}):[];return(0,s.jsx)(tt.lG,{open:void 0!==c&&"tier_free"!==c,onOpenChange:e=>{e||u()},"data-sentry-element":"Dialog","data-sentry-component":"SubscriptionPlanUpdateDialog","data-sentry-source-file":"SubscriptionPlanUpdateDialog.tsx",children:(0,s.jsx)(tt.Cf,{onOpenAutoFocus:e=>e.preventDefault(),size:"xlarge",className:"p-0","data-sentry-element":"DialogContent","data-sentry-source-file":"SubscriptionPlanUpdateDialog.tsx",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 h-full items-stretch",children:[(0,s.jsxs)("div",{className:"p-8 pb-8 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("h3",{className:"text-base mb-4",children:[(null==p?void 0:p.change_type)==="downgrade"?"Downgrade":"Upgrade"," ",(0,s.jsx)("span",{className:"font-bold",children:null==A?void 0:A.name})," to"," ",(null==p?void 0:p.change_type)==="downgrade"?ai[c||"default"]:al[c||"default"]]}),y&&(0,s.jsxs)("div",{className:"space-y-2 mb-4 mt-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),j&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ep.XI,{className:"mt-2 mb-4 text-foreground-light",children:(0,s.jsx)(ep.BF,{children:(()=>{var e,t,a,n,r,l;let i=Math.floor(Date.now()/1e3),o=(null==w?void 0:w.current_period_end)-i,d=(null==w?void 0:w.current_period_end)-(null==w?void 0:w.current_period_start),c=(null!=(n=null==C?void 0:C.price)?n:0)*(o/d),u=null!=(r=null==m?void 0:m.priceMonthly)?r:0,p=-((null!=(l=null==w?void 0:w.customer_balance)?l:0)/100*1),x=Math.max(0,u-c-p);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ep.Hj,{children:[(0,s.jsxs)(ep.nA,{className:"py-2 pl-0 flex items-center gap-1",children:[(0,s.jsxs)("span",{children:[null==m?void 0:m.name," Plan"]}),(0,s.jsx)(f.E,{variant:"brand",size:"small",className:"ml-1",children:"New"})]}),(0,s.jsx)(ep.nA,{className:"py-2 pr-0 text-right",children:(0,P.vv)(u)})]}),(null==w||null==(e=w.plan)?void 0:e.id)!=="free"&&(0,s.jsxs)(ep.Hj,{children:[(0,s.jsxs)(ep.nA,{className:"py-2 pl-0 flex items-center gap-1",children:[(0,s.jsxs)("span",{children:["Unused Time on ",null==w||null==(t=w.plan)?void 0:t.name," Plan"]}),(0,s.jsx)(ev.I,{className:"max-w-sm",children:"Your previous plan was charged upfront, so a plan change will prorate any unused time in credits. If the prorated credits exceed the new plan charge, the excessive credits are added to your organization for future use."})]}),(0,s.jsxs)(ep.nA,{className:"py-2 pr-0 text-right",children:["-",(0,P.vv)(c)]})]}),p>0&&(0,s.jsxs)(ep.Hj,{children:[(0,s.jsxs)(ep.nA,{className:"py-2 pl-0 flex items-center gap-1",children:[(0,s.jsx)("span",{children:"Credits"}),(0,s.jsx)(ev.I,{children:"Credits will be used first before charging your card."})]}),(0,s.jsx)(ep.nA,{className:"py-2 pr-0 text-right",children:(0,P.vv)(p)})]}),(0,s.jsxs)(ep.Hj,{className:"text-foreground",children:[(0,s.jsx)(ep.nA,{className:"py-2 pl-0 border-t",children:"Charge today"}),(0,s.jsx)(ep.nA,{className:"py-2 pr-0 text-right border-t",children:(0,P.vv)(x)})]}),(null==w||null==(a=w.plan)?void 0:a.id)!=="free"&&(0,s.jsxs)(ep.Hj,{children:[(0,s.jsxs)(ep.nA,{className:"py-2 pl-0 flex items-center gap-1",children:[(0,s.jsx)("span",{children:"+ current cycle usage"}),(0,s.jsx)(ev.I,{className:"max-w-sm",children:"Changing your plan resets your billing cycle. If your previous billing cycle still has any outstanding usage charges, they will be added to your total charge today."})]}),(0,s.jsx)(ep.nA,{className:"py-2 pr-0 text-right",children:(0,s.jsx)(ec(),{href:"/org/".concat(_,"/billing#breakdown"),className:"text-sm text-brand hover:text-brand-600 transition",target:"_blank",children:"View spend"})})]})]})})()})}),(0,s.jsxs)(as.jc,{children:[(0,s.jsx)(as.d0,{asChild:!0,children:(0,s.jsx)(an.Zp,{className:"cursor-help text-sm",children:(0,s.jsxs)(an.Wu,{className:"flex items-center gap-2 py-2 px-3 text-foreground-light hover:text-foreground",children:[(0,s.jsx)(e8.A,{strokeWidth:1.5,size:16,className:"text-foreground-light"}),"Monthly invoice estimate is"," ",(0,P.vv)(Math.round(null!=(i=null==v?void 0:v.breakdown.reduce((e,t)=>e+t.total_price,0))?i:0))]})})}),(0,s.jsxs)(as.Et,{className:"w-[520px] p-6",children:[(0,s.jsx)("h3",{className:"text-md font-medium mb-2",children:"Your new monthly invoice"}),x&&(0,s.jsx)(S.A,{error:x,subject:"Failed to preview subscription."}),y&&(0,s.jsxs)("div",{className:"space-y-2 p-6",children:[(0,s.jsx)("span",{className:"text-sm",children:"Estimating monthly costs..."}),(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),j&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(ep.XI,{className:"[&_tr:last-child]:border-t font-mono text-xs",children:(0,s.jsxs)(ep.BF,{children:[(()=>{var e,t,a,n,r,l,i;let o=(null==v||null==(e=v.breakdown)?void 0:e.filter(e=>{var t,a;return(null==(t=e.description)?void 0:t.toLowerCase().includes("compute"))&&(null==(a=e.breakdown)?void 0:a.length)>0}))||[],d=null!=(l=null==v||null==(t=v.breakdown)?void 0:t.find(e=>e.description.startsWith("Compute Credits")))?l:null,c=null==v||null==(a=v.breakdown)?void 0:a.find(e=>{var t;return null==(t=e.description)?void 0:t.toLowerCase().includes("plan")}),u=o.flatMap(e=>e.breakdown.map(t=>({...t,computeType:e.description,computeCosts:Math.round(e.total_price/e.breakdown.length)}))),m=(null==v||null==(n=v.breakdown)?void 0:n.filter(e=>{var t,a;return!(null==(t=e.description)?void 0:t.toLowerCase().includes("compute"))&&!(null==(a=e.description)?void 0:a.toLowerCase().includes("plan"))}))||[];return(0,s.jsxs)(s.Fragment,{children:[u.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ep.Hj,{className:"text-foreground-light",children:[(0,s.jsx)(ep.nA,{className:"!py-2 px-0",children:null==c?void 0:c.description}),(0,s.jsx)(ep.nA,{className:"text-right py-2 px-0",children:(0,P.vv)(null==c?void 0:c.total_price)})]}),(0,s.jsxs)(ep.Hj,{className:"text-foreground-light",children:[(0,s.jsxs)(ep.nA,{className:"!py-2 px-0 flex items-center gap-1",children:[(0,s.jsx)("span",{children:"Compute"}),(0,s.jsxs)(ev.I,{className:"max-w-sm p-3",children:[(0,s.jsxs)("p",{className:"prose text-xs mb-2",children:["Each project on a paid plan is a dedicated server running 24/7 with no pausing. The first project is covered by Compute Credits. Additional projects will incur compute costs starting at $10/month, independent of activity. See"," ",(0,s.jsx)(ec(),{href:"/docs/guides/platform/manage-your-usage/compute",target:"_blank",children:"docs"}),"."]}),(null==w||null==(r=w.plan)?void 0:r.id)==="free"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light mb-3",children:"Mixing paid and non-paid projects in a single organization is not possible. If you want projects to be on the Free Plan, use self-serve project transfers."}),(0,s.jsxs)("div",{className:"space-x-3",children:[(0,s.jsx)(F.$,{asChild:!0,type:"default",icon:(0,s.jsx)(ez.A,{strokeWidth:1.5}),children:(0,s.jsx)(ec(),{href:"/docs/guides/platform/manage-your-usage/compute",target:"_blank",rel:"noreferrer",children:"How billing for Compute works"})}),(0,s.jsx)(F.$,{asChild:!0,type:"default",icon:(0,s.jsx)(ez.A,{strokeWidth:1.5}),children:(0,s.jsx)(ec(),{href:"/docs/guides/platform/project-transfer",target:"_blank",rel:"noreferrer",children:"Project transfers"})})]})]})]})]}),(0,s.jsx)(ep.nA,{className:"text-right py-2 px-0",children:(0,P.vv)(o.reduce((e,t)=>e+t.total_price,0)+(null!=(i=null==d?void 0:d.total_price)?i:0))})]}),u.map(e=>(0,s.jsx)(ep.Hj,{className:"text-foreground-light",children:(0,s.jsxs)(ep.nA,{className:"!py-2 px-0 pl-6",children:[e.project_name," (",e.computeType,") |"," ",(0,P.vv)(e.computeCosts)]})},e.project_ref)),d&&(0,s.jsx)(ep.Hj,{className:"text-foreground-light",children:(0,s.jsxs)(ep.nA,{className:"!py-2 px-0 pl-6",children:["Compute Credits |"," ",(0,P.vv)(d.total_price)]})})]}),m.map(e=>{var t;return(0,s.jsxs)(ep.Hj,{className:"text-foreground-light",children:[(0,s.jsx)(ep.nA,{className:"text-xs py-2 px-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{children:null!=(t=e.description)?t:"Unknown"}),e.breakdown.length>0&&(0,s.jsxs)(ev.I,{className:"max-w-sm",children:[(0,s.jsxs)("p",{children:["Projects using ",e.description,":"]}),(0,s.jsx)("ul",{className:"ml-6 list-disc",children:e.breakdown.map(t=>(0,s.jsx)("li",{children:t.project_name},"".concat(e.description,"-breakdown-").concat(t.project_ref)))})]})]})}),(0,s.jsx)(ep.nA,{className:"text-right text-xs py-2 px-0",children:(0,P.vv)(e.total_price)})]},e.description)})]})})(),(0,s.jsxs)(ep.Hj,{children:[(0,s.jsx)(ep.nA,{className:"font-medium py-2 px-0",children:"Total per month (excluding other usage)"}),(0,s.jsx)(ep.nA,{className:"text-right font-medium py-2 px-0",children:(0,P.vv)(null!=(d=Math.round(null!=(o=null==v||null==(l=v.breakdown)?void 0:l.reduce((e,t)=>e+t.total_price,0))?o:0))?d:0)})]})]})})})]})]})]})]}),(0,s.jsxs)("div",{className:"mt-4 pt-4",children:[b?(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("p",{className:"text-sm",children:["This organization is billed through our partner"," ",(0,aa.mS)(N),"."," ","aws"===N?(0,s.jsx)(s.Fragment,{children:"The organization's credit balance will be decreased accordingly."}):(0,s.jsx)(s.Fragment,{children:"You will be charged by them directly."})]}),b&&"fly"===N&&(null==v?void 0:v.plan_change_type)==="downgrade"&&(0,s.jsx)("p",{className:"text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]}):(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)(tj,{selectedPaymentMethod:T,onSelectPaymentMethod:R})}),0===I.filter(e=>e.status===eH.BU.ACTIVE_HEALTHY||e.status===eH.BU.COMING_UP).length&&(0,s.jsx)("div",{className:"pb-2",children:(0,s.jsx)(tk.Z,{title:"Empty organization",type:"warning",children:"This organization has no active projects. Did you select the correct organization?"})}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)(F.$,{type:"default",onClick:u,className:"flex-1","data-sentry-element":"Button","data-sentry-source-file":"SubscriptionPlanUpdateDialog.tsx",children:"Cancel"}),(0,s.jsxs)(F.$,{loading:L,type:"primary",onClick:O,className:"flex-1","data-sentry-element":"Button","data-sentry-source-file":"SubscriptionPlanUpdateDialog.tsx",children:["Confirm ",(null==p?void 0:p.change_type)==="downgrade"?"downgrade":"upgrade"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-surface-100 p-8 flex flex-col border-l",children:[(null==p?void 0:p.change_type)==="downgrade"?G.length>0&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-sm mb-1",children:"Features you'll lose"}),(0,s.jsx)("p",{className:"text-xs text-foreground-light mb-4",children:"Please review this carefully before downgrading."}),(0,s.jsx)("div",{className:"space-y-2 mb-4 text-foreground-light",children:G.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-4",children:(0,s.jsx)(e8.A,{className:"h-3 w-3 text-amber-900",strokeWidth:3})}),(0,s.jsx)("p",{className:"text-sm",children:"string"==typeof e?e:e[0]})]},"string"==typeof e?e:e[0]))})]}):z.length>0&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-sm mb-4",children:"Upgrade features"}),(0,s.jsx)("div",{className:"space-y-2 mb-4 text-foreground-light",children:z.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-4",children:(0,s.jsx)(tU.A,{className:"h-3 w-3 text-brand",strokeWidth:3})}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{children:"string"==typeof e?e:e[0]}),Array.isArray(e)&&e.length>1&&(0,s.jsx)("p",{className:"text-foreground-lighter text-xs",children:e[1]})]})]},"string"==typeof e?e:e[0]))})]}),(null==p?void 0:p.change_type)!=="downgrade"&&(0,s.jsx)("div",{className:"border-t pt-6",children:(0,s.jsxs)("blockquote",{className:"text-sm text-foreground-light italic",children:[k.text,(0,s.jsxs)("div",{className:"mt-2 text-foreground",children:["— @",k.handle]})]})})]})]})})})};async function ad(e){let{orgSlug:t,prevPlan:a,currentPlan:s,reasons:n,message:r}=e,{data:l,error:i}=await (0,_.bE)("/platform/feedback/upgrade",{body:{...void 0!==t&&{orgSlug:t},...void 0!==a&&{prevPlan:a},...void 0!==s&&{currentPlan:s},reasons:n,...void 0!==r&&{additionalFeedback:r}}});return i&&(0,_.H4)(i),l}let ac=function(){let{onError:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,G.n)(e=>ad(e),{async onError(t,a,s){void 0===e?g.oR.error("Failed to submit upgrade survey: ".concat(t.message)):e(t,a,s)},...t})},au=e=>{let{visible:t,originalPlan:a,subscription:n,onClose:r}=e,{slug:l}=(0,$.g)(),[i,o]=(0,h.useState)(""),[d,c]=(0,h.useReducer)(function(e,t){return t3()(e,t.target.value)?t6()(e,t.target.value):[...e,t.target.value]},[]),u=ej(a,null==n?void 0:n.plan.id),{mutate:m,isLoading:p}=ac({onError:e=>{g.oR.error("Failed to submit survey: ".concat(e.message))},onSuccess:()=>{r(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}),x=async()=>{var e;if(0===d.length)return g.oR.error("Please select at least one reason for upgrading your subscription");m({orgSlug:l,prevPlan:a,currentPlan:null==n||null==(e=n.plan)?void 0:e.id,reasons:d,message:i.trim()||void 0})};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(tn.A,{alignFooter:"right",size:"xlarge",loading:p,visible:t,onCancel:r,onConfirm:x,cancelText:"Skip",header:"We're excited for your upgrade","data-sentry-element":"Modal","data-sentry-source-file":"UpgradeModal.tsx",children:(0,s.jsxs)(tn.A.Content,{className:"space-y-4","data-sentry-element":"unknown","data-sentry-source-file":"UpgradeModal.tsx",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"What reasons motivated your decision to upgrade? Your feedback helps us improve Supabase as much as we can."}),(0,s.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:u.map(e=>{let t=d.find(t=>t===e);return(0,s.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(t?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,s.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:c}),(0,s.jsx)("div",{children:e})]},e)})}),(0,s.jsx)("div",{className:"text-area-text-sm",children:(0,s.jsx)(er.A.TextArea,{id:"message",name:"message",value:i,onChange:e=>o(e.target.value),label:"Anything else that we can improve on?","data-sentry-element":"unknown","data-sentry-source-file":"UpgradeModal.tsx"})})]})]})})})},am=()=>{var e,t;let a=(0,tB.useRouter)(),n=(0,i.a)(),r=null==n?void 0:n.slug,{mutate:l}=(0,tZ.h)(),u=(0,h.useRef)(),p=(0,eG._)("allowOrioleDb"),[x,g]=(0,h.useState)(!1),[y,f]=(0,h.useState)(!1),[j,v]=(0,h.useState)(!1),[b,N]=(0,h.useState)(),S=(0,m.SE)(c.aG.BILLING_WRITE,"stripe.subscriptions"),{data:w}=(0,tW.el)(),_=(w||[]).filter(e=>e.organization_id===(null==n?void 0:n.id)),{data:C}=tq({slug:r},{enabled:p}),I=!p&&!!(null==C?void 0:C.has_oriole_project),E=(0,eV.h2)(),T="subscriptionPlan"===E.panelKey,R=()=>{let{panel:e,...t}=a.query;a.push({pathname:a.pathname,query:t},void 0,{shallow:!0}),E.setPanelKey(void 0)},{data:k,isSuccess:M}=(0,d.j5)({orgSlug:r}),{data:D,isLoading:L}=tJ({orgSlug:r}),{data:O}=(0,tG.A)({slug:r}),z=(null==k?void 0:k.billing_via_partner)===!0,U=null==k?void 0:k.billing_partner,{data:B,error:G,isLoading:H,isSuccess:V}=tV({tier:b,organizationSlug:r}),Y=null!=(t=null==D?void 0:D.plans)?t:[],q=(O||[]).length>0&&_.filter(e=>"INACTIVE"!==e.status&&"GOING_DOWN"!==e.status).length>0,W=tK.vw.find(e=>e.id===b);(0,h.useEffect)(()=>{if(T){var e;N(void 0);let t=Array.isArray(a.query.source)?a.query.source[0]:a.query.source,s={currentPlan:null==k||null==(e=k.plan)?void 0:e.name};t&&(s.origin=t),l({action:"studio_pricing_side_panel_opened",properties:s,groups:{organization:null!=r?r:"Unknown"}})}},[T]),(0,h.useEffect)(()=>{T&&M&&(u.current=k.plan.id)},[T,M]);let $=b?Y.find(e=>e.id===b.split("tier_")[1]):null;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eQ.Ay,{hideFooter:!0,size:"xxlarge",visible:T,onCancel:()=>R(),header:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h4",{children:["Change subscription plan for ",null==n?void 0:n.name]}),(0,s.jsx)(F.$,{asChild:!0,type:"default",icon:(0,s.jsx)(ez.A,{}),children:(0,s.jsx)("a",{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:"Pricing"})})]}),"data-sentry-element":"SidePanel","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:(0,s.jsx)(eQ.Ay.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:(0,s.jsx)("div",{className:"py-6 grid grid-cols-12 gap-3",children:tK.vw.map(e=>{var t,a,n,i;let d=Y.find(t=>t.id===e.id.split("tier_")[1]),c=null!=(i=null==d?void 0:d.price)?i:0,u=(null==d?void 0:d.change_type)==="downgrade",m=(null==d?void 0:d.id)===(null==k||null==(t=k.plan)?void 0:t.id),p=(0,tK.DW)(e,U),x=(0,tK.Rr)(e,U);return"tier_enterprise"===e.id?(0,s.jsx)(t1,{plan:e,isCurrentPlan:m,billingPartner:U},e.id):(0,s.jsxs)("div",{className:(0,o.cn)("px-4 py-4 flex flex-col items-start justify-between","border rounded-md col-span-12 md:col-span-4 bg-surface-200"),children:[(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-brand text-sm uppercase",children:e.name}),m?(0,s.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):e.nameBadge?(0,s.jsx)("div",{className:"text-xs bg-brand-400 text-brand-600 rounded px-2 py-0.5",children:e.nameBadge}):null]}),(0,s.jsxs)("div",{className:"mt-4 flex items-center space-x-1 mb-4",children:[(null!=c?c:0)>0&&(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"From"}),L?(0,s.jsx)("div",{className:"h-[28px] flex items-center justify-center",children:(0,s.jsx)(Q.A,{className:"w-[30px] h-[24px]"})}):(0,s.jsx)("p",{className:"text-foreground text-lg",children:(0,P.vv)(c)}),(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:e.costUnit})]}),m?(0,s.jsx)(F.$,{block:!0,disabled:!0,type:"default",children:"Current plan"}):(0,s.jsxs)(A.G,{block:!0,type:u?"default":"primary",disabled:(null==k||null==(a=k.plan)?void 0:a.id)==="enterprise"||I||!S,onClick:()=>{var t;N(e.id),l({action:"studio_pricing_plan_cta_clicked",properties:{selectedPlan:e.name,currentPlan:null==k||null==(t=k.plan)?void 0:t.name},groups:{organization:null!=r?r:"Unknown"}})},tooltip:{content:{side:"bottom",className:I?"w-96 text-center":"",text:(null==k||null==(n=k.plan)?void 0:n.id)==="enterprise"?"Reach out to us via support to update your plan from Enterprise":I?"Your organization has projects that are using the OrioleDB extension which is only available on the Free plan. Remove all OrioleDB projects before changing your plan.":S?void 0:"You do not have permission to change the subscription plan"}},children:[u?"Downgrade":"Upgrade"," to ",e.name]}),(0,s.jsx)("div",{className:"border-t my-4"}),(0,s.jsx)("ul",{role:"list",children:p.map(e=>(0,s.jsxs)("li",{className:"flex py-2",children:[(0,s.jsx)("div",{className:"w-[12px]",children:(0,s.jsx)(tU.A,{className:"h-3 w-3 text-brand translate-y-[2.5px]","aria-hidden":"true",strokeWidth:3})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"ml-3 text-xs text-foreground-light",children:"string"==typeof e?e:e[0]}),tF()(e)&&(0,s.jsx)("p",{className:"ml-3 text-xs text-foreground-lighter",children:e[1]})]})]},"string"==typeof e?e:e[0]))})]}),x&&(0,s.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,s.jsx)("p",{className:"text-foreground-light text-xs",children:x})})]},e.id)})})})}),(0,s.jsx)(t2,{visible:"tier_free"===b,selectedPlan:W,subscription:k,onClose:()=>N(void 0),onConfirm:()=>{N(void 0),q?v(!0):g(!0)},projects:_,"data-sentry-element":"DowngradeModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,s.jsx)(ao,{selectedTier:b,selectedOrganization:n,onClose:()=>N(void 0),subscriptionPlanMeta:W,planMeta:$,subscriptionPreviewError:G,subscriptionPreviewIsLoading:H,subscriptionPreviewInitialized:V,subscriptionPreview:B,billingViaPartner:z,billingPartner:U,subscription:k,projects:_,slug:r,currentPlanMeta:{...Y.find(e=>{var t;return e.id===(null==k||null==(t=k.plan)?void 0:t.id)}),features:(null==(e=tK.vw.find(e=>{var t;return e.id==="tier_".concat(null==k||null==(t=k.plan)?void 0:t.id)}))?void 0:e.features)||[]},"data-sentry-element":"SubscriptionPlanUpdateDialog","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,s.jsx)(ae,{visible:j,onClose:()=>v(!1),"data-sentry-element":"MembersExceedLimitModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,s.jsx)(t7,{visible:x,projects:_,onClose:e=>{g(!1),e&&R()},"data-sentry-element":"ExitSurveyModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,s.jsx)(au,{visible:y,originalPlan:u.current,subscription:k,onClose:e=>{f(!1),e&&R()},"data-sentry-element":"UpgradeSurveyModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"})]})},ap=()=>{var e,t,a;let{slug:n}=(0,$.g)(),l=(0,eV.h2)(),i=(0,eG._)("disableProjectCreationAndUpdate"),o=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions"),{data:p,error:x,isLoading:h,isError:g,isSuccess:y}=(0,d.j5)({orgSlug:n},{enabled:o}),f=null==p?void 0:p.plan,j=null!=(e=null==f?void 0:f.name)?e:"Unknown",v=!i&&!["enterprise"].includes(null!=(t=null==f?void 0:f.id)?t:"");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"Subscription.tsx",children:[(0,s.jsx)("div",{className:"col-span-12 pb-2",children:(0,s.jsx)(tO,{"data-sentry-element":"Restriction","data-sentry-source-file":"Subscription.tsx"})}),(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"Subscription.tsx",children:(0,s.jsx)("div",{className:"sticky space-y-6 top-12",children:(0,s.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Subscription Plan"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Each organization has it's own subscription plan, billing cycle, payment methods and usage quotas."})]})})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"Subscription.tsx",children:o?(0,s.jsxs)(s.Fragment,{children:[h&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),g&&(0,s.jsx)(S.A,{subject:"Failed to retrieve subscription",error:x}),y&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-2xl text-brand",children:[null!=(a=null==f?void 0:f.name)?a:"Unknown"," Plan"]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(eq.A,{projectUpdateDisabled:i,children:(0,s.jsx)(F.$,{type:"default",className:"pointer-events-auto",disabled:!v,onClick:()=>l.setPanelKey("subscriptionPlan"),children:"Change subscription plan"})}),!v&&(i?(0,s.jsx)(eY.F,{className:"mt-2",withIcon:!0,variant:"info",title:"Unable to update plan from ".concat(j),children:"We have temporarily disabled project and subscription changes - our engineers are working on a fix."}):(0,s.jsx)(eY.F,{withIcon:!0,className:"mt-2",variant:"info",title:"Unable to update plan from ".concat(j),actions:[(0,s.jsx)("div",{children:(0,s.jsx)(F.$,{asChild:!0,type:"default",children:(0,s.jsx)(ec(),{href:"/support/new?category=sales&subject=Change%20plan%20away%20from%20".concat(j),children:"Contact support"})})},"contact-support")],children:"Please contact us if you'd like to change your plan."}))]}),!(null==p?void 0:p.usage_billing_enabled)&&(0,s.jsx)(tk.Z,{type:"default",title:"This organization is limited by the included usage",children:(0,s.jsxs)("div",{className:"[&>p]:!leading-normal prose text-sm",children:["Projects may become unresponsive when this organization exceeds its"," ",(0,s.jsx)(ec(),{href:"/org/".concat(n,"/usage"),children:"included usage quota"}),". To scale seamlessly,"," ",(null==f?void 0:f.id)==="free"?"upgrade to a paid plan.":"you can disable Spend Cap under the Cost Control settings."]})})]})]}):(0,s.jsx)(u.A,{resourceText:"view this organization's subscription"})})]}),(0,s.jsx)(am,{"data-sentry-element":"PlanUpdateSidePanel","data-sentry-source-file":"Subscription.tsx"})]})};var ax=a(41960);async function ah(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:s,error:n}=await (0,_.Jt)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:a}},signal:t,headers:{Version:"2"}});if(n)throw(0,_.H4)(n);return s.tax_id}let ag=function(e){let{slug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,m.SE)(c.aG.BILLING_READ,"stripe.tax_ids");return(0,E.I)(X.O.taxId(t),e=>{let{signal:a}=e;return ah({slug:t},a)},{enabled:a&&void 0!==t&&n,...s})};async function ay(e){let{slug:t,taxId:a}=e;if(!t)throw Error("Slug is required");if(null!=a){let{data:e,error:s}=await (0,_.yJ)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:t}},body:{type:a.type,value:a.value,country:a.country}});return s&&(0,_.H4)(s),e}{let{data:e,error:a}=await (0,_.yH)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:t}},headers:{Version:"2"}});return a&&(0,_.H4)(a),e}}let af=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>ay(e),{async onSuccess(t,a,n){let{slug:r}=a;s.setQueryData(X.O.taxId(r),t.tax_id),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to update tax id: ".concat(e.message)):t(e,a,s)},...a})};var aj=a(79295);let av=[{name:"AE TRN",type:"ae_trn",country:"United Arab Emirates",placeholder:"123456789012345",countryIso2:"AE"},{name:"AT VAT",type:"eu_vat",country:"Austria",placeholder:"ATU12345678",vatPrefix:"ATU",countryIso2:"AT"},{name:"AD NRT",type:"ad_nrt",country:"Andorra",placeholder:"A-123456-Z",countryIso2:"AD"},{name:"AR CUIT",type:"ar_cuit",country:"Argentina",placeholder:"12-3456789-01",countryIso2:"AR"},{name:"AU ABN",type:"au_abn",country:"Australia",placeholder:"12345678912",countryIso2:"AU"},{name:"AU ARN",type:"au_arn",country:"Australia",placeholder:"123456789123",countryIso2:"AU"},{name:"BE VAT",type:"eu_vat",country:"Belgium",placeholder:"BE0123456789",vatPrefix:"BE",countryIso2:"BE"},{name:"BO TIN",type:"bo_tin",country:"Bolivia",placeholder:"123456789",countryIso2:"BO"},{name:"BG VAT",type:"eu_vat",country:"Bulgaria",placeholder:"BG0123456789",vatPrefix:"BG",countryIso2:"BG"},{name:"BR CNPJ",type:"br_cnpj",country:"Brazil",placeholder:"01.234.456/5432-10",countryIso2:"BR"},{name:"BR CPF",type:"br_cpf",country:"Brazil",placeholder:"123.456.789-87",countryIso2:"BR"},{name:"CA BN",type:"ca_bn",country:"Canada",placeholder:"123456789",countryIso2:"CA"},{name:"CA GST/HST",type:"ca_gst_hst",country:"Canada",placeholder:"123456789RT0002",countryIso2:"CA"},{name:"CA PST-BC",type:"ca_pst_bc",country:"Canada",placeholder:"PST-1234-5678",countryIso2:"CA"},{name:"CA PST-MB",type:"ca_pst_mb",country:"Canada",placeholder:"123456-7",countryIso2:"CA"},{name:"CA PST-SK",type:"ca_pst_mb",country:"Canada",placeholder:"1234567",countryIso2:"CA"},{name:"CA QST",type:"ca_qst",country:"Canada",placeholder:"1234567890TQ1234",countryIso2:"CA"},{name:"CH VAT",type:"ch_vat",country:"Switzerland",placeholder:"CHE-123.456.789 MWST",vatPrefix:"CHE",countryIso2:"CH"},{name:"CL TIN",type:"cl_tin",country:"Chile",placeholder:"12.345.678-K",countryIso2:"CL"},{name:"CN TIN",type:"cn_tin",country:"China",placeholder:"123456789012345678",countryIso2:"CN"},{name:"CO NIT",type:"co_nit",country:"Colombia",placeholder:"123.456.789-0",countryIso2:"CO"},{name:"CR TIN",type:"cr_tin",country:"Costa Rica",placeholder:"1-234-567890",countryIso2:"CR"},{name:"CY VAT",type:"eu_vat",country:"Cyprus",placeholder:"CY12345678Z",vatPrefix:"CY",countryIso2:"CY"},{name:"CZ VAT",type:"eu_vat",country:"Czech Republic",placeholder:"CZ1234567890",vatPrefix:"CZ",countryIso2:"CZ"},{name:"DE VAT",type:"eu_vat",country:"Germany",placeholder:"DE123456789",vatPrefix:"DE",countryIso2:"DE"},{name:"DK VAT",type:"eu_vat",country:"Denmark",placeholder:"DK12345678",vatPrefix:"DK",countryIso2:"DK"},{name:"DO RCN",type:"do_rcn",country:"Dominican Republic",placeholder:"123-4567890-1",countryIso2:"DO"},{name:"EE VAT",type:"eu_vat",country:"Estonia",placeholder:"EE123456789",vatPrefix:"EE",countryIso2:"EE"},{name:"ES CIF",type:"es_cif",country:"Spain",placeholder:"A12345678",countryIso2:"ES"},{name:"ES VAT",type:"eu_vat",country:"Spain",placeholder:"ESX1234567Z",vatPrefix:"ES",countryIso2:"ES"},{name:"FI VAT",type:"eu_vat",country:"Finland",placeholder:"FI12345678",vatPrefix:"FI",countryIso2:"FI"},{name:"FR VAT",type:"eu_vat",country:"France",placeholder:"FRAB123456789",vatPrefix:"FR",countryIso2:"FR"},{name:"GB VAT",type:"eu_vat",country:"United Kingdom",placeholder:"GB123456789",vatPrefix:"GB",countryIso2:"GB"},{name:"GE VAT",type:"ge_vat",country:"Georgia",placeholder:"123456789",countryIso2:"GE"},{name:"EL VAT",type:"eu_vat",country:"Greece",countryIso2:"GR",placeholder:"EL123456789",vatPrefix:"EL"},{name:"HK BR",type:"hk_br",country:"Hong Kong SAR China",placeholder:"12345678",countryIso2:"HK"},{name:"HR VAT",type:"eu_vat",country:"Croatia",placeholder:"HR12345678912",vatPrefix:"HR",countryIso2:"HR"},{name:"HU VAT",type:"eu_vat",country:"Hungary",placeholder:"HU12345678912",vatPrefix:"HU",countryIso2:"HU"},{name:"ID NPWP",type:"id_npwp",country:"Indonesia",placeholder:"12.345.678.9-012.345",countryIso2:"ID"},{name:"IE VAT",type:"eu_vat",country:"Ireland",placeholder:"IE1234567AB",vatPrefix:"IE",countryIso2:"IE"},{name:"IL VAT",type:"il_vat",country:"Israel",placeholder:"000012345",countryIso2:"IL"},{name:"IN GST",type:"in_gst",country:"India",placeholder:"12ABCDE3456FGZH",countryIso2:"IN"},{name:"IS VAT",type:"is_vat",country:"Iceland",placeholder:"123456",countryIso2:"IS"},{name:"IT VAT",type:"eu_vat",country:"Italy",placeholder:"IT12345678912",vatPrefix:"IT",countryIso2:"IT"},{name:"JP CN",type:"jp_cn",country:"Japan",placeholder:"1234567891234",countryIso2:"JP"},{name:"KE PIN",type:"ke_pin",country:"Kenya",placeholder:"P000111111A",countryIso2:"KE"},{name:"JP RN",type:"jp_rn",country:"Japan",placeholder:"12345",countryIso2:"JP"},{name:"KR BRN",type:"kr_brn",country:"Korea",placeholder:"123-45-67890",countryIso2:"KR"},{name:"LI UID",type:"li_uid",country:"Liechtenstein",placeholder:"CHE123456789",countryIso2:"LI"},{name:"LT VAT",type:"eu_vat",country:"Lithuania",placeholder:"LT123456789123",vatPrefix:"LT",countryIso2:"LT"},{name:"LU VAT",type:"eu_vat",country:"Luxembourg",placeholder:"LU12345678",vatPrefix:"LU",countryIso2:"LU"},{name:"LV VAT",type:"eu_vat",country:"Latvia",placeholder:"LV12345678912",vatPrefix:"LV",countryIso2:"LV"},{name:"MT VAT",type:"eu_vat",country:"Malta",placeholder:"MT12345678",vatPrefix:"MT",countryIso2:"MT"},{name:"MX RFC",type:"mx_rfc",country:"Mexico",placeholder:"ABC010203AB9",countryIso2:"MX"},{name:"MY FRP",type:"my_frp",country:"Malaysia",placeholder:"12345678",countryIso2:"MY"},{name:"MY ITN",type:"my_itn",country:"Malaysia",placeholder:"C 1234567890",countryIso2:"MY"},{name:"MY SST",type:"my_sst",country:"Malaysia",placeholder:"A12-3456-78912345",countryIso2:"MY"},{name:"NL VAT",type:"eu_vat",country:"Netherlands",placeholder:"NL123456789B12",vatPrefix:"NL",countryIso2:"NL"},{name:"NO VAT",type:"no_vat",country:"Norway",placeholder:"123456789MVA",countryIso2:"NO"},{name:"PE RUC",type:"pe_ruc",country:"Peru",placeholder:"12345678901",countryIso2:"PE"},{name:"PH TIN",type:"ph_tin",country:"Philippines",placeholder:"123456789012",countryIso2:"PH"},{name:"NZ GST",type:"nz_gst",country:"New Zealand",placeholder:"123456789",countryIso2:"NZ"},{name:"PL VAT",type:"eu_vat",country:"Poland",placeholder:"PL1234567890",vatPrefix:"PL",countryIso2:"PL"},{name:"PT VAT",type:"eu_vat",country:"Portugal",placeholder:"PT123456789",vatPrefix:"PT",countryIso2:"PT"},{name:"RO VAT",type:"eu_vat",country:"Romania",placeholder:"RO1234567891",vatPrefix:"RO",countryIso2:"RO"},{name:"RU INN",type:"ru_inn",country:"Russia",placeholder:"1234567891",countryIso2:"RU"},{name:"RU KPP",type:"ru_kpp",country:"Russia",placeholder:"123456789",countryIso2:"RU"},{name:"SA VAT",type:"sa_vat",country:"Saudi Arabia",placeholder:"123456789012345",countryIso2:"SA"},{name:"RS PIB",type:"rs_pib",country:"Serbia",placeholder:"123456789",countryIso2:"RS"},{name:"SE VAT",type:"eu_vat",country:"Sweden",placeholder:"SE123456789123",vatPrefix:"SE",countryIso2:"SE"},{name:"SG GST",type:"sg_gst",country:"Singapore",placeholder:"M12345678X",countryIso2:"SG"},{name:"SG UEN",type:"sg_uen",country:"Singapore",placeholder:"123456789F",countryIso2:"SG"},{name:"SI VAT",type:"eu_vat",country:"Slovenia",placeholder:"SI12345678",vatPrefix:"SI",countryIso2:"SI"},{name:"SK VAT",type:"eu_vat",country:"Slovakia",placeholder:"SK1234567891",vatPrefix:"SK",countryIso2:"SK"},{name:"TH VAT",type:"th_vat",country:"Thailand",placeholder:"1234567891234",countryIso2:"TH"},{name:"TR TIN",type:"tr_tin",country:"Turkey",placeholder:"0123456789",countryIso2:"TR"},{name:"TW VAT",type:"tw_vat",country:"Taiwan",placeholder:"12345678",countryIso2:"TW"},{name:"UA VAT",type:"ua_vat",country:"Ukraine",placeholder:"123456789",countryIso2:"UA"},{name:"US EIN",type:"us_ein",country:"United States",placeholder:"12-3456789",countryIso2:"US"},{name:"XI VAT",type:"eu_vat",country:"United Kingdom (Northern Ireland)",placeholder:"XI123456789",vatPrefix:"XI",countryIso2:"GB"},{name:"ZA VAT",type:"za_vat",country:"South Africa",placeholder:"4123456789",countryIso2:"ZA"},{name:"UY RUC",type:"uy_ruc",country:"Uruguay",placeholder:"123456789012",countryIso2:"UY"},{name:"VE RIF",type:"ve_rif",country:"Venezuela",placeholder:"A-12345678-9",countryIso2:"VE"},{name:"VN TIN",type:"vn_tin",country:"Vietnam",placeholder:"1234567890",countryIso2:"VN"}],ab=e=>{let t=av.find(t=>t.name===e.name),a=null==t?void 0:t.vatPrefix;return a&&!e.value.startsWith(a)?"".concat(a).concat(e.value):e.value},aN=(e,t)=>(null==e?void 0:e.type)===(null==t?void 0:t.type)&&(null==e?void 0:e.value)===(null==t?void 0:t.value);var aS=a(23278);let aA=()=>{var e,t;let{slug:a}=(0,$.g)(),n=(0,i.a)(),{data:l,error:o,isLoading:d,isSuccess:p,isError:x}=ag({slug:a}),{mutate:y,isLoading:f}=af({onSuccess:()=>{g.oR.success("Successfully updated tax id")}}),j=eE.Ik({type:eE.Yj(),value:eE.Yj(),name:eE.Yj()}),v=(0,eI.mN)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,eC.u)(j),defaultValues:{type:"",value:"",name:""}}),b=l?{type:l.type,value:l.value,name:null!=(t=null==(e=av.find(e=>e.type===l.type&&e.countryIso2===l.country))?void 0:e.name)?t:""}:{type:"",value:"",name:""},N=!aN(v.getValues(),b),A=(0,m.SE)(c.aG.BILLING_READ,"stripe.tax_ids"),_=(0,m.SE)(c.aG.BILLING_WRITE,"stripe.tax_ids");(0,h.useEffect)(()=>{p&&b&&(v.setValue("type",b.type),v.setValue("value",b.value),v.setValue("name",b.name))},[p]);let C=async()=>{if(!a)return console.error("Slug is required");let{type:e,value:t}=v.getValues();if((null==e?void 0:e.length)&&!(null==t?void 0:t.length))return void v.setError("value",{message:"Value is required"});y({slug:a,taxId:(null==e?void 0:e.length)&&(null==t?void 0:t.length)?{type:e,value:ab({value:t,name:v.getValues().name}),country:null==k?void 0:k.countryIso2}:null})},I=()=>{v.setValue("type",b.type),v.setValue("value",b.value),v.setValue("name",b.name)},E=e=>{let t=av.find(t=>t.name===e);t&&(v.setValue("type",t.type),v.setValue("value",""),v.setValue("name",e))},T=()=>{v.reset()},{name:R}=v.watch(),k=av.find(e=>e.name===R);return(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"TaxID","data-sentry-source-file":"TaxID.tsx",children:[(0,s.jsx)(r.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"TaxID.tsx",children:(0,s.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,s.jsx)("p",{className:"text-foreground text-base m-0",children:"Tax ID"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light pr-4 m-0",children:"Add a tax ID to your invoices. Changes only apply to future invoices."}),(0,s.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Make sure the tax ID looks exactly like the placeholder text."})]})}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"TaxID.tsx",children:(null==n?void 0:n.managed_by)!==void 0&&(null==n?void 0:n.managed_by)!=="supabase"?(0,s.jsx)(w.A,{partner:null==n?void 0:n.managed_by,resource:"Tax IDs",cta:{installationId:null==n?void 0:n.partner_id}}):A?(0,s.jsxs)(s.Fragment,{children:[d&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),x&&(0,s.jsx)(S.A,{error:o,subject:"Failed to retrieve organization tax Id"}),p&&(0,s.jsx)(ax.A,{className:"mb-8",footer:(0,s.jsx)(J.I,{form:"tax-id-form",isSubmitting:f,hasChanges:N,handleReset:()=>I(),helper:_?void 0:"You need additional permissions to manage this organization's tax ID"}),children:(0,s.jsx)(eT.lV,{...v,children:(0,s.jsxs)("form",{id:"tax-id-form",className:"grid grid-cols-2 gap-2 w-full py-8 px-8 items-center",onSubmit:v.handleSubmit(()=>C()),children:[(0,s.jsx)(eT.zB,{name:"name",control:v.control,render:e=>{let{field:t}=e;return(0,s.jsx)(eT.eI,{children:(0,s.jsx)(eT.MJ,{children:(0,s.jsxs)(aj.l6,{...t,disabled:!_,value:t.value,onValueChange:e=>E(e),children:[(0,s.jsx)(aj.bq,{children:(0,s.jsx)(aj.yv,{placeholder:"None"})}),(0,s.jsx)(aj.gC,{children:(0,s.jsx)(aj.s3,{children:av.sort((e,t)=>e.country.localeCompare(t.country)).map(e=>(0,s.jsxs)(aj.eb,{value:e.name,children:[e.country," - ",e.name]},e.name))})})]})})})}}),k&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eT.zB,{name:"value",control:v.control,render:e=>{let{field:t}=e;return(0,s.jsx)(eT.eI,{className:"w-full",children:(0,s.jsx)(eT.MJ,{children:(0,s.jsx)(ek.p,{...t,placeholder:null==k?void 0:k.placeholder,disabled:!_})})})}}),(0,s.jsx)(F.$,{type:"text",className:"px-1",icon:(0,s.jsx)(aS.A,{}),onClick:()=>T()})]})]})})})]}):(0,s.jsx)(u.A,{resourceText:"view this organization's tax ID"})})]})},aw=()=>{let{billingAccountData:e,billingPaymentMethods:t,billingCredits:a,billingInvoices:c}=(0,l.x)(["billing:account_data","billing:payment_methods","billing:credits","billing:invoices"]),u=(0,n.FO)(),m=(0,i.a)(),{data:p}=(0,d.j5)({orgSlug:null==m?void 0:m.slug}),x=!(null==p?void 0:p.billing_via_partner),h=e&&x,g=t&&x;return(0,s.jsxs)(s.Fragment,{children:[u&&(0,s.jsx)(r.Vw,{children:(0,s.jsx)(r.Dm,{children:"Billing"})}),(0,s.jsx)(r.eh,{id:"subscription",className:(0,o.cn)(u&&"[&>div]:!pt-0"),"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"BillingSettings.tsx",children:(0,s.jsx)(ap,{"data-sentry-element":"Subscription","data-sentry-source-file":"BillingSettings.tsx"})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"BillingSettings.tsx"}),(0,s.jsx)(r.eh,{id:"cost-control","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"BillingSettings.tsx",children:(0,s.jsx)(e1,{"data-sentry-element":"CostControl","data-sentry-source-file":"BillingSettings.tsx"})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"BillingSettings.tsx"}),(null==m?void 0:m.plan.id)!=="free"&&(0,s.jsx)(r.eh,{id:"breakdown",children:(0,s.jsx)(e_,{})}),c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.cJ,{}),(0,s.jsx)(r.eh,{id:"invoices",children:(0,s.jsx)(W,{})})]}),g&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.cJ,{}),(0,s.jsx)(r.eh,{id:"payment-methods",children:(0,s.jsx)(tP,{})})]}),a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.cJ,{}),(0,s.jsx)(r.eh,{id:"credits-balance",children:(0,s.jsx)(tA,{})})]}),h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.cJ,{}),(0,s.jsx)(r.eh,{id:"email",children:(0,s.jsx)(eO,{})}),(0,s.jsx)(r.cJ,{}),(0,s.jsx)(r.eh,{id:"address",children:(0,s.jsx)(eo,{})}),(0,s.jsx)(r.cJ,{}),(0,s.jsx)(r.eh,{id:"taxId",children:(0,s.jsx)(aA,{})})]})]})},a_=e=>{var t;let{organization:a}=e,{data:n}=(0,tW.el)({});return(null!=(t=null==n?void 0:n.filter(e=>e.organization_id===(null==a?void 0:a.id)).length)?t:0)>0||(null==a?void 0:a.plan)===void 0||"free"===a.plan.id||"enterprise"===a.plan.id?null:(0,s.jsx)(tk.Z,{type:"default",title:"Your organization is on the ".concat(a.plan.name," plan with no projects running"),description:(0,s.jsxs)("div",{className:"!max-w-full prose text-sm",children:["The monthly fees for the paid plan still apply. To cancel your subscription, head over to your"," ",(0,s.jsx)(ec(),{href:"/org/".concat(null==a?void 0:a.slug,"/billing"),children:"organization billing settings"})]}),"data-sentry-element":"Admonition","data-sentry-component":"NoProjectsOnPaidOrgInfo","data-sentry-source-file":"NoProjectsOnPaidOrgInfo.tsx"})};var aC=a(33240),aI=a(37589),aE=a(51405),aT=a(18213),aR=a(69055);async function ak(e){let{slug:t}=e,{data:a,error:s}=await (0,_.yH)("/platform/organizations/{slug}",{params:{path:{slug:t}}});return s&&(0,_.H4)(s),a}let aM=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>ak(e),{async onSuccess(t,a,n){await Promise.all([s.invalidateQueries(X.O.list()),s.invalidateQueries(aR.Q.list())]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to delete organization: ".concat(e.message)):t(e,a,s)},...a})};var aP=a(89756);let aD=()=>{let e=(0,tB.useRouter)(),t=(0,n.FO)(),a=(0,i.a)(),{slug:r,name:l}=null!=a?a:{},[o,d]=(0,h.useState)(!1),[u,p]=(0,h.useState)(""),[x,y]=(0,aP.U)(eH.rS.LAST_VISITED_ORGANIZATION,""),f=(0,m.SE)(c.aG.UPDATE,"organizations"),{mutate:j,isLoading:v}=aM({onSuccess:()=>{g.oR.success("Successfully deleted ".concat(l)),t?(y(""),e.push("/organizations")):e.push("/projects")}}),b=async e=>f?r?void j({slug:r}):console.error("Org slug is required"):g.oR.error("You do not have the required permissions to delete this organization");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(F.$,{loading:!r,onClick:()=>d(!0),type:"danger","data-sentry-element":"Button","data-sentry-source-file":"DeleteOrganizationButton.tsx",children:"Delete organization"})}),(0,s.jsx)(tn.A,{hideFooter:!0,size:"small",visible:o,onCancel:()=>d(!1),header:(0,s.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,s.jsx)("span",{children:"Delete organization"}),(0,s.jsx)("span",{className:"text-xs text-foreground-lighter",children:"Are you sure?"})]}),"data-sentry-element":"Modal","data-sentry-source-file":"DeleteOrganizationButton.tsx",children:(0,s.jsx)(en.A,{validateOnBlur:!0,initialValues:{orgName:""},onSubmit:b,validate:e=>{let t={};return e.orgName||(t.orgName="Enter the name of the organization."),e.orgName!==r&&(t.orgName="Value entered does not match the value above."),t},"data-sentry-element":"Form","data-sentry-source-file":"DeleteOrganizationButton.tsx",children:()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tn.A.Content,{children:(0,s.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["This action ",(0,s.jsx)("span",{className:"text-foreground",children:"cannot"})," be undone. This will permanently delete the ",(0,s.jsx)("span",{className:"text-foreground",children:l})," ","organization and remove all of its projects."]})}),(0,s.jsx)(tn.A.Separator,{}),(0,s.jsx)(tn.A.Content,{children:(0,s.jsx)(er.A,{id:"orgName",label:(0,s.jsxs)("span",{children:["Please type ",(0,s.jsx)("span",{className:"font-bold",children:r})," to confirm"]}),onChange:e=>p(e.target.value),value:u,placeholder:"Enter the string above",className:"w-full"})}),(0,s.jsx)(tn.A.Separator,{}),(0,s.jsx)(tn.A.Content,{children:(0,s.jsx)(F.$,{block:!0,size:"small",type:"danger",htmlType:"submit",loading:v,disabled:v,children:"I understand, delete this organization"})})]})})})]})},aL=()=>{let e=(0,i.a)();return(0,s.jsx)(ax.A,{title:(0,s.jsx)("p",{children:"DANGER ZONE"},"panel-title"),"data-sentry-element":"Panel","data-sentry-component":"OrganizationDeletePanel","data-sentry-source-file":"OrganizationDeletePanel.tsx",children:(0,s.jsx)(ax.A.Content,{className:"!p-0","data-sentry-element":"unknown","data-sentry-source-file":"OrganizationDeletePanel.tsx",children:(null==e?void 0:e.managed_by)!=="vercel-marketplace"?(0,s.jsx)(tk.Z,{type:"destructive",className:"mb-0 rounded-none border-0",title:"Deleting this organization will also remove its projects",description:"Make sure you have made a backup of your projects if you want to keep your data",children:(0,s.jsx)(aD,{})}):(0,s.jsx)(w.A,{partner:"vercel-marketplace",resource:"Organizations",cta:{installationId:null==e?void 0:e.partner_id,path:"/settings",message:"Delete organization in Vercel Marketplace"}})})})},aO=()=>{let{slug:e}=(0,$.g)(),t=(0,B.jE)(),a=(0,i.a)(),{name:n}=null!=a?a:{},o="org-general-settings",d=(0,aI.g)(),u=(0,l.x)("organizations:delete"),p=(0,m.SE)(c.aG.UPDATE,"organizations"),x=(0,m.SE)(c.aG.UPDATE,"organizations"),{mutate:y,isLoading:f}=(0,eR.N)(),j=async(s,n)=>{var r;let{resetForm:l}=n;if(!p)return g.oR.error("You do not have the required permissions to update this organization");if(!e)return console.error("Slug is required");let i=null!=(r=null==a?void 0:a.opt_in_tags)?r:[],o=s.isOptedIntoAi&&!i.includes(eH.W2.AI_SQL)?i.concat([eH.W2.AI_SQL]):!s.isOptedIntoAi&&i.includes(eH.W2.AI_SQL)?i.filter(e=>e!==eH.W2.AI_SQL):i;y({slug:e,name:s.name,opt_in_tags:o},{onSuccess:()=>{l({values:s,initialValues:s}),(0,aC.Ul)(t),g.oR.success("Successfully saved settings")}})};return(0,s.jsxs)(r.Vw,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-component":"GeneralSettings","data-sentry-source-file":"GeneralSettings.tsx",children:[(0,s.jsx)(a_,{organization:a,"data-sentry-element":"NoProjectsOnPaidOrgInfo","data-sentry-source-file":"GeneralSettings.tsx"}),(0,s.jsx)(en.A,{id:o,initialValues:{name:null!=n?n:"",isOptedIntoAi:d},onSubmit:j,"data-sentry-element":"Form","data-sentry-source-file":"GeneralSettings.tsx",children:e=>{let{handleReset:t,values:r,initialValues:l,resetForm:i}=e,c=JSON.stringify(r)!==JSON.stringify(l);return(0,h.useEffect)(()=>{let e={name:null!=n?n:"",isOptedIntoAi:d};i({values:e,initialValues:e})},[null==a?void 0:a.slug]),(0,s.jsx)(Z.lB,{footer:(0,s.jsx)("div",{className:"flex p-4 md:px-8",children:(0,s.jsx)(J.I,{form:o,isSubmitting:f,hasChanges:c,handleReset:t,helper:p?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,s.jsx)(K.y9,{header:(0,s.jsx)(K.sj,{children:"General settings"}),children:(0,s.jsxs)(K.DE,{loading:!1,children:[(0,s.jsx)(er.A,{id:"name",size:"small",label:"Organization name",disabled:!p}),(0,s.jsx)(er.A,{copy:!0,disabled:!0,id:"slug",size:"small",label:"Organization slug",value:null==a?void 0:a.slug}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(aE.A,{id:"isOptedIntoAi",name:"isOptedIntoAi",disabled:!p,size:"small",label:"Opt-in to sending anonymous data to OpenAI",descriptionText:"By opting into sending anonymous data, Supabase AI can improve the answers it shows you. This is an organization-wide setting."}),(0,s.jsx)(aT.A,{className:"ml-16"})]})]})})})}}),u&&x&&(0,s.jsx)(aL,{})]})};var az=a(81706),aF=a(57947),aU=a(39637),aB=a(50720),aG=a(32280),aH=a(19528),aV=a(20967),aY=a(59768),aq=a(66628),aW=a(97009),a$=a(53042);let aJ=e=>{let{title:t}=e;return(0,s.jsx)("img",{className:"border rounded-lg shadow w-full sm:w-48 mt-6 border-body",src:"".concat(eH.o2,"/img/integrations/covers/").concat(t,"-cover.png"),alt:"".concat(t," cover"),"data-sentry-component":"IntegrationImageHandler","data-sentry-source-file":"IntegrationSettings.tsx"})},aZ=()=>{let e=(0,n.FO)(),t=(0,i.a)(),a=(0,m.SE)(c.aG.READ,"integrations.github_connections"),l=(0,m.SE)(c.aG.CREATE,"integrations.github_connections"),o=(0,m.SE)(c.aG.UPDATE,"integrations.github_connections"),{data:d}=(0,aB.m)(),{data:p}=(0,aH.O)({organizationId:null==t?void 0:t.id}),{mutate:x}=(0,aG.L)({onSuccess:()=>{g.oR.success("Successfully deleted Github connection")}}),y=(0,aY.bZ)(),f=(0,h.useCallback)(()=>{y.setGithubConnectionsOpen(!0)},[y]),j=(0,h.useCallback)(async e=>{if(!(null==t?void 0:t.id))return void g.oR.error("Organization not found");x({connectionId:e.id,organizationId:t.id})},[x,null==t?void 0:t.id]),v=d?"You are authorized with Supabase GitHub App. You can configure your GitHub App installations and repository access [here](".concat(aV.CH,"). You can revoke your authorization [here](").concat(aV.oC,")."):"";return(0,s.jsxs)(s.Fragment,{children:[e&&(0,s.jsx)(r.Vw,{children:(0,s.jsx)(r.Dm,{children:"Integrations"})}),(0,s.jsx)(()=>(0,s.jsx)(r.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"GitHubSection","data-sentry-source-file":"IntegrationSettings.tsx",children:(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"IntegrationSettings.tsx",children:[(0,s.jsxs)(r.xp,{title:"GitHub Connections","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"IntegrationSettings.tsx",children:[(0,s.jsx)(aF.o,{content:"\nConnect any of your GitHub repositories to a project.\n","data-sentry-element":"Markdown","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,s.jsx)(aJ,{title:"github","data-sentry-element":"IntegrationImageHandler","data-sentry-source-file":"IntegrationSettings.tsx"})]}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"IntegrationSettings.tsx",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(aF.o,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n"}),(0,s.jsx)("ul",{className:"flex flex-col gap-y-2",children:null==p?void 0:p.map(e=>{var t,a,n,r,l;return(0,s.jsx)(aq.S,{disabled:!o,connection:{id:String(e.id),added_by:{id:String(null==(t=e.user)?void 0:t.id),primary_email:null!=(r=null==(a=e.user)?void 0:a.primary_email)?r:"",username:null!=(l=null==(n=e.user)?void 0:n.username)?l:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}},type:"GitHub",onDeleteConnection:j},e.id)})}),(0,s.jsx)(az.MJ,{onClick:f,showNode:!1,disabled:!l,children:"Add new project connection"}),v&&(0,s.jsx)(aF.o,{extLinks:!0,content:v,className:"text-foreground-lighter"})]}):(0,s.jsx)(u.A,{resourceText:"view this organization's GitHub connections"})})]})}),{"data-sentry-element":"GitHubSection","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,s.jsx)(aU.A,{isProjectScoped:!1,"data-sentry-element":"VercelSection","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,s.jsx)(a$.A,{"data-sentry-element":"SidePanelVercelProjectLinker","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,s.jsx)(aW.A,{"data-sentry-element":"SidePanelGitHubRepoLinker","data-sentry-source-file":"IntegrationSettings.tsx"})]})};var aK=a(9678),aQ=a(99985),aX=a(25222),a0=a(67007);let a2=e=>{let{visible:t,onHide:a}=e;return(0,s.jsxs)(tn.A,{hideFooter:!0,visible:t,size:"xlarge",header:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{children:"Spend Cap"}),(0,s.jsx)(a0.A,{href:"https://supabase.com/docs/guides/platform/cost-control#spend-cap"})]}),showCloseButton:!1,onCancel:()=>a(),"data-sentry-element":"Modal","data-sentry-component":"SpendCapModal","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapModal.tsx",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-sm",children:"Enabling the Spend Cap limits your usage to your plan's quota, which controls costs but can restrict your service. Disabling the spend cap removes these limits, but any extra usage beyond the plan's limit will be charged per usage."}),(0,s.jsx)("p",{className:"text-sm",children:"Launching additional projects or enabling project add-ons will incur additional monthly fees independent of your Spend Cap."}),(0,s.jsxs)(ep.XI,{"data-sentry-element":"Table","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.A0,{className:"[&_th]:h-7","data-sentry-element":"TableHeader","data-sentry-source-file":"SpendCapModal.tsx",children:(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nd,{className:"w-[50%]","data-sentry-element":"TableHead","data-sentry-source-file":"SpendCapModal.tsx",children:"Item"}),(0,s.jsx)(ep.nd,{className:"w-[25%]","data-sentry-element":"TableHead","data-sentry-source-file":"SpendCapModal.tsx",children:"Limit"}),(0,s.jsx)(ep.nd,{className:"w-[25%]","data-sentry-element":"TableHead","data-sentry-source-file":"SpendCapModal.tsx",children:"Rate"})]})}),(0,s.jsxs)(ep.BF,{className:"[&_td]:py-2","data-sentry-element":"TableBody","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Disk Size"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"8 GB per project"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.125 per GB"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Egress"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"250 GB"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.09 per GB"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Auth MAUs"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"100,000"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.00325 per user"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Auth Third-Party MAUs"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"100,000"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.00325 per user"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Auth Single Sign-On MAUs"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"50"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.015 per user"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Storage Size"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"100 GB"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.021 per GB"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Storage Image Transformations"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"100 origin images"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$5 per 1000 images"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Realtime Concurrent Peak Connections"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"500"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$10 per 1000"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Realtime Messages"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"5 Million"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$2.50 per Million"})]}),(0,s.jsxs)(ep.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Function Invocations"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"2 Million"}),(0,s.jsx)(ep.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$2 per Million"})]})]})]})]})}),(0,s.jsx)(tn.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapModal.tsx"}),(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapModal.tsx",children:(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(F.$,{block:!0,type:"primary",onClick:()=>a(),"data-sentry-element":"Button","data-sentry-source-file":"SpendCapModal.tsx",children:"Understood"})})})]})};async function a1(e){let{name:t,kind:a,size:s,tier:n,payment_method:r}=e,{data:l,error:i}=await (0,_.bE)("/platform/organizations",{body:{name:t,kind:a,size:s,tier:n,payment_method:r}});return i&&(0,_.H4)(i),l}let a4=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>a1(e),{async onSuccess(t,a,n){await Promise.all([s.invalidateQueries(X.O.list()),s.invalidateQueries(aR.Q.list())]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to create organization: ".concat(e.message)):t(e,a,s)},...a})};var a3=a(11649),a5=a(11375),a6=a(36212),a8=a(33202),a9=a.n(a8);let a7={PERSONAL:"Personal",EDUCATIONAL:"Educational",STARTUP:"Startup",AGENCY:"Agency",COMPANY:"Company",UNDISCLOSED:"N/A"},se={1:"1 - 10",10:"10 - 49",50:"50 - 99",100:"100 - 299",300:"More than 300"};eE.z.object({plan:eE.z.string().transform(e=>e.toUpperCase()).pipe(eE.z.enum(["FREE","PRO","TEAM","ENTERPRISE"])),name:eE.z.string().min(1),kind:eE.z.string().transform(e=>e.toUpperCase()).pipe(eE.z.enum(["PERSONAL","EDUCATIONAL","STARTUP","AGENCY","COMPANY","UNDISCLOSED"])),size:eE.z.enum(["1","10","50","100","300"]),spend_cap:eE.z.boolean()});let st=e=>{let{onPaymentMethodReset:t}=e,a=(0,tB.useRouter)(),n=(0,a3.xc)(),{data:r,isSuccess:l}=(0,aC.Ad)(),{data:i}=(0,tW.el)(),o=(0,e3.useStripe)(),d=(0,e3.useElements)(),c=(0,B.jE)(),u=(r||[]).filter(e=>"free"===e.plan.id),m=(0,h.useMemo)(()=>a9().groupBy(i||[],"organization_slug"),[i]),[p,x]=(0,h.useState)(!1),[f,j]=(0,h.useState)({plan:"FREE",name:"",kind:"PERSONAL",size:"1",spend_cap:!0}),[v]=(0,aX.ab)({returnTo:aX.tU.withDefault(""),auth_id:aX.tU.withDefault("")}),b=(e,t)=>{j(a=>({...a,[e]:t}))};(0,h.useEffect)(()=>{if(!a.isReady)return;let{name:e,kind:t,plan:s,size:n,spend_cap:r}=a.query;"string"==typeof e&&b("name",e),"string"==typeof t&&b("kind",t),"string"==typeof s&&b("plan",s),"string"==typeof n&&b("size",n),"string"==typeof r&&b("spend_cap","true"===r)},[a.isReady]),(0,h.useEffect)(()=>{if(!f.name&&(null==r?void 0:r.length)===0&&!n.isLoading){var e;b("name",(null==(e=n.profile)?void 0:e.username)?n.profile.username+"'s Org":"My Org")}},[l]);let[N,S]=(0,h.useState)(!1),[A,w]=(0,h.useState)(),[_,C]=(0,h.useState)(!1),{mutate:I}=a4({onSuccess:async e=>{var t;await (0,aC.Ul)(c);let s=(null==(t=n.profile)?void 0:t.username)?n.profile.username+"'s Project":"My Project";v.returnTo&&v.auth_id?a.push("".concat(v.returnTo,"?auth_id=").concat(v.auth_id),void 0,{shallow:!1}):a.push("/new/".concat(e.slug,"?projectName=").concat(s))},onError:()=>{R(),S(!1)}});async function E(e){let t="PRO"!==f.plan||f.spend_cap?f.plan:"PAYG";I({name:f.name,kind:f.kind,tier:"tier_"+t.toLowerCase(),..."COMPANY"==f.kind?{size:f.size}:{},payment_method:e})}let T=async()=>{if(!o||!d)return console.error("Stripe.js has not loaded");if(S(!0),"FREE"===f.plan)await E();else if(A)E(A.id);else{let{error:t,setupIntent:a}=await o.confirmSetup({elements:d,redirect:"if_required",confirmParams:{return_url:"".concat((0,P.AP)(),"/new"),expand:["payment_method"]}});if(t||!a.payment_method){var e;g.oR.error(null!=(e=null==t?void 0:t.message)?e:" Failed to save card details"),S(!1);return}let s=a.payment_method;w(s),E(s.id)}},R=()=>(w(void 0),t()),k=async e=>{if(e.preventDefault(),!function(e){return(e?e.trim():"").length>=1}(f.name))return g.oR.error("Organization name is empty");u.some(e=>{var t;return(null==(t=m[e.slug])?void 0:t.length)>0})&&"FREE"!==f.plan?x(!0):await T()};return(0,s.jsxs)("form",{onSubmit:k,"data-sentry-component":"NewOrgForm","data-sentry-source-file":"NewOrgForm.tsx",children:[(0,s.jsxs)(ax.A,{title:(0,s.jsx)("div",{children:(0,s.jsx)("h4",{children:"Create a new organization"})},"panel-title"),footer:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)(F.$,{type:"default",disabled:N,onClick:()=>a.push("/projects"),children:"Cancel"}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-lighter",children:"You can rename your organization later"}),(0,s.jsx)(F.$,{htmlType:"submit",type:"primary",loading:N,disabled:N,children:"Create organization"})]})]},"panel-footer"),"data-sentry-element":"Panel","data-sentry-source-file":"NewOrgForm.tsx",children:[(0,s.jsxs)(ax.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"NewOrgForm.tsx",children:[(0,s.jsx)("p",{className:"text-sm",children:"This is your organization within Supabase."}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"For example, you can use the name of your company or department."})]}),(0,s.jsx)(ax.A.Content,{className:"Form section-block--body has-inputs-centered","data-sentry-element":"unknown","data-sentry-source-file":"NewOrgForm.tsx",children:(0,s.jsxs)("div",{className:"grid grid-cols-3 w-full",children:[(0,s.jsx)("div",{children:(0,s.jsx)(tc.J,{htmlFor:"name","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:"Name"})}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)(ek.p,{id:"name",autoFocus:!0,type:"text",placeholder:"Organization name",value:f.name,onChange:e=>b("name",e.target.value),"data-sentry-element":"Input_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(tc.J,{htmlFor:"name",className:"text-foreground-lighter leading-normal text-sm","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:"What's the name of your company or team?"})})]})]})}),(0,s.jsx)(ax.A.Content,{className:"Form section-block--body has-inputs-centered","data-sentry-element":"unknown","data-sentry-source-file":"NewOrgForm.tsx",children:(0,s.jsxs)("div",{className:"grid grid-cols-3",children:[(0,s.jsx)("div",{children:(0,s.jsx)(tc.J,{htmlFor:"kind","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:"Type"})}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsxs)(aj.l6,{value:f.kind,onValueChange:e=>b("kind",e),"data-sentry-element":"Select_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:[(0,s.jsx)(aj.bq,{id:"kind",className:"w-full","data-sentry-element":"SelectTrigger_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:(0,s.jsx)(aj.yv,{"data-sentry-element":"SelectValue_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx"})}),(0,s.jsx)(aj.gC,{"data-sentry-element":"SelectContent_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:Object.entries(a7).map(e=>{let[t,a]=e;return(0,s.jsx)(aj.eb,{value:t,children:a},t)})})]}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(tc.J,{htmlFor:"kind",className:"text-foreground-lighter leading-normal text-sm","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:"What would best describe your organization?"})})]})]})}),"COMPANY"==f.kind&&(0,s.jsx)(ax.A.Content,{className:"Form section-block--body has-inputs-centered",children:(0,s.jsxs)("div",{className:"grid grid-cols-3",children:[(0,s.jsx)("div",{children:(0,s.jsx)(tc.J,{htmlFor:"size",children:"Company size"})}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsxs)(aj.l6,{value:f.size,onValueChange:e=>b("size",e),children:[(0,s.jsx)(aj.bq,{id:"size",className:"w-full",children:(0,s.jsx)(aj.yv,{})}),(0,s.jsx)(aj.gC,{children:Object.entries(se).map(e=>{let[t,a]=e;return(0,s.jsx)(aj.eb,{value:t,children:a},t)})})]}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(tc.J,{htmlFor:"size",className:"text-foreground-lighter leading-normal text-sm",children:"How many people are in your company?"})})]})]})}),(0,s.jsx)(ax.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"NewOrgForm.tsx",children:(0,s.jsxs)("div",{className:"grid grid-cols-3",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(tc.J,{htmlFor:"plan",className:" text-sm","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:"Plan"}),(0,s.jsxs)("a",{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer noopener",className:"text-sm flex items-center gap-2 opacity-75 hover:opacity-100 transition",children:["Pricing",(0,s.jsx)(ez.A,{size:16,strokeWidth:1.5,"data-sentry-element":"ExternalLink","data-sentry-source-file":"NewOrgForm.tsx"})]})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsxs)(aj.l6,{value:f.plan,onValueChange:e=>b("plan",e),"data-sentry-element":"Select_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:[(0,s.jsx)(aj.bq,{id:"plan",className:"w-full","data-sentry-element":"SelectTrigger_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:(0,s.jsx)(aj.yv,{"data-sentry-element":"SelectValue_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx"})}),(0,s.jsx)(aj.gC,{"data-sentry-element":"SelectContent_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:Object.entries(eH.ho).map(e=>{let[t,a]=e;return(0,s.jsx)(aj.eb,{value:t,children:a},t)})})]}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(tc.J,{htmlFor:"plan",className:"text-foreground-lighter leading-normal text-sm","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"NewOrgForm.tsx",children:"The Plan applies to your new organization."})})]})]})}),"PRO"===f.plan&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ax.A.Content,{className:"border-b border-panel-border-interior-light dark:border-panel-border-interior-dark",children:(0,s.jsxs)("div",{className:"grid grid-cols-3",children:[(0,s.jsxs)("div",{className:"col-span-1 flex space-x-2 text-sm",children:[(0,s.jsx)(tc.J,{htmlFor:"spend-cap",className:" leading-normal",children:"Spend Cap"}),(0,s.jsx)(aK.A,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100",onClick:()=>C(!0)})]}),(0,s.jsxs)("div",{className:"col-span-2 flex items-center space-x-2",children:[(0,s.jsx)(a5.d,{id:"spend-cap",checked:f.spend_cap,onCheckedChange:()=>b("spend_cap",!f.spend_cap)}),(0,s.jsx)(tc.J,{htmlFor:"spend-cap",children:f.spend_cap?"Usage is limited to the plan's quota.":"You pay for overages beyond the plan's quota."})]})]})}),(0,s.jsx)(a2,{visible:_,onHide:()=>C(!1)})]}),"FREE"!==f.plan&&(0,s.jsx)(ax.A.Content,{children:(null==A?void 0:A.card)!==void 0?(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,s.jsx)("img",{alt:"Card",src:"".concat(eH.o2,"/img/payment-methods/").concat(A.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,s.jsx)(er.A,{readOnly:!0,className:"w-64",size:"small",value:"•••• •••• •••• ".concat(A.card.last4)}),(0,s.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",A.card.exp_month,"/",A.card.exp_year]})]}),(0,s.jsx)("div",{children:(0,s.jsx)(F.$,{type:"outline",icon:(0,s.jsx)(aQ.A,{}),onClick:()=>R(),disabled:N,className:"hover:border-muted"})})]},A.id):(0,s.jsx)(e3.PaymentElement,{})})]}),(0,s.jsxs)(a6.A,{size:"large",loading:!1,visible:p,title:(0,s.jsx)(s.Fragment,{children:"Confirm organization creation"}),confirmLabel:"Create new organization",onCancel:()=>x(!1),onConfirm:async()=>{await T(),x(!1)},variant:"warning","data-sentry-element":"ConfirmationModal","data-sentry-source-file":"NewOrgForm.tsx",children:[(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Supabase"," ",(0,s.jsx)(ec(),{className:"underline",href:"/docs/guides/platform/billing-on-supabase",target:"_blank","data-sentry-element":"Link","data-sentry-source-file":"NewOrgForm.tsx",children:"bills per organization"}),". If you want to upgrade your existing projects, upgrade your existing organization instead."]}),(0,s.jsx)("ul",{className:"mt-4 space-y-6",children:u.filter(e=>{var t;return(null==(t=m[e.slug])?void 0:t.length)>0}).map(e=>{let t=m[e.slug].map(e=>e.name);return(0,s.jsxs)("li",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsx)(F.$,{asChild:!0,type:"primary",size:"tiny",children:(0,s.jsx)(ec(),{href:"/org/".concat(e.slug,"/billing?panel=subscriptionPlan"),children:"Change Plan"})})]}),(0,s.jsx)("div",{className:"text-foreground-light text-xs",children:t.length<=2?(0,s.jsx)("span",{children:t.join("and ")}):(0,s.jsxs)("div",{children:[t.slice(0,2).join(", ")," and"," ",(0,s.jsxs)(y.m_,{children:[(0,s.jsx)(y.k$,{asChild:!0,children:(0,s.jsxs)("span",{className:"underline decoration-dotted",children:[t.length-2," other"," ",(t.length,"project")]})}),(0,s.jsx)(y.ZI,{children:(0,s.jsx)("ul",{className:"list-disc list-inside",children:t.slice(2).map(e=>(0,s.jsx)("li",{children:e}))})})]})]})})]},"org_".concat(e.slug))})})]})]})};var sa=a(955),ss=a(60555);let sn=e=>{let{title:t,description:a}=e;return(0,s.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-14","data-sentry-component":"SectionHeader","data-sentry-source-file":"SectionHeader.tsx",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xl",children:t}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:a})]})})};var sr=a(18580),sl=a(61645),si=a(31277);let so=e=>{let{section:t,includedInPlan:a,children:n}=e,{name:l,description:i,links:o}=t;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"SectionContent.tsx",children:(0,s.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-8 md:py-16",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,s.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,s.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-base capitalize",children:l}),!1===a&&(0,s.jsx)(f.E,{children:"Not included"})]}),(0,s.jsx)("div",{className:"grid gap-4",children:i.split("\n").map((e,t)=>(0,s.jsx)("p",{className:"text-sm text-foreground-light pr-8",children:e},"desc-".concat(t)))})]}),o&&o.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground mb-2",children:"More information"}),o.map(e=>(0,s.jsx)("div",{children:(0,s.jsx)(ec(),{href:e.url,target:"_blank",rel:"noreferrer",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,s.jsx)("p",{className:"text-sm",children:e.name}),(0,s.jsx)(ez.A,{size:16,strokeWidth:1.5})]})})},e.url))]})]})}),(0,s.jsx)("div",{className:"col-span-12 lg:col-span-7 space-y-6",children:n})]})})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"SectionContent.tsx"})]})},sd=(e,t,a)=>{var s;return t?(null==t||null==(s=t.plan)?void 0:s.id)==="pro"&&(null==t?void 0:t.usage_billing_enabled)===!1?"/org/".concat(e,"/billing#cost-control"):"/org/".concat(e,"/billing?panel=subscriptionPlan&source=usage").concat(a):"/org/".concat(e,"/billing")},sc=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}),su=(e,t)=>{if("string"==typeof e)return e;if("bytes"===t){let t=sx(e).replace(/\s/g,"");return"0bytes"===t?"0":t}return"gigabytes"===t?sc.format(e)+"GB":sc.format(e)},sm=(e,t)=>{if("string"==typeof e)return e;if("bytes"===t){let t=sh(e).replace(/\s/g,"");return"0bytes"===t?"0":t}return"gigabytes"===t?sc.format(e)+"GB":sc.format(e)},sp=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],sx=e=>{if(0===e||void 0===e)return"0 bytes";let t=Math.floor(Math.log(e)/Math.log(1024)),a=sp[t],s=2;return["bytes","KB","MB"].includes(a)?s=0:["GB"].includes(a)&&(s=1),parseFloat((e/Math.pow(1024,t)).toFixed(s))+" "+a},sh=e=>{if(0===e||void 0===e)return"0 bytes";let t=Math.floor(Math.log(e)/Math.log(1024)),a=sp[t];return parseFloat((e/Math.pow(1024,t)).toFixed(3))+" "+a};var sg=a(22531);let sy=e=>{var t,a,n,r,l,i,d,c,u,m,p,x,g;let{slug:f,projectRef:j,attribute:v,usage:b,usageMeta:N,chartMeta:A,subscription:w,error:_,isLoading:C,isError:I,isSuccess:E,currentBillingCycleSelected:T}=e,R=sd(null!=f?f:"",w,v.key),k=(null!=(n=null==N?void 0:N.usage)?n:0)/(null!=(r=null==N?void 0:N.pricing_free_units)?r:0),M=(null!=(l=null==N?void 0:N.usage)?l:0)-(null!=(i=null==N?void 0:N.pricing_free_units)?i:0),P=null==w?void 0:w.usage_billing_enabled,D=P?"text-amber-900":"text-red-900",L=(0,h.useMemo)(()=>{var e,t;return null!=(t=null==(e=A[v.key])?void 0:e.data)?t:[]},[v.key,A]),O=void 0===j&&T&&!1===P&&k>=eH.xx,z=(0,h.useMemo)(()=>{var e,t;return null!=(t=null==(e=v.attributes)?void 0:e.map(e=>L.some(t=>0!==Number(t[e.key]))).some(e=>!!e))&&t},[v.attributes,L]);return(0,s.jsx)("div",{id:v.anchor,className:"scroll-my-12","data-sentry-component":"AttributeUsage","data-sentry-source-file":"AttributeUsage.tsx",children:(0,s.jsxs)(so,{section:v,"data-sentry-element":"SectionContent","data-sentry-source-file":"AttributeUsage.tsx",children:[C&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),I&&(0,s.jsx)(S.A,{subject:"Failed to retrieve usage data",error:_}),E&&(0,s.jsx)(s.Fragment,{children:!N||(null==N?void 0:N.available_in_plan)?(0,s.jsxs)(s.Fragment,{children:[!j&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("p",{className:"text-sm",children:[v.name," usage"]}),O&&(0,s.jsxs)(y.m_,{children:[(0,s.jsx)(y.k$,{asChild:!0,children:k>=1?(0,s.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,s.jsx)(sl.A,{size:14,strokeWidth:2,className:D}),(0,s.jsx)("p",{className:"text-sm ".concat(D),children:"Exceeded limit"})]}):k>=eH.xx&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,s.jsx)(sl.A,{size:14,strokeWidth:2,className:"text-amber-900"}),(0,s.jsx)("p",{className:"text-sm text-amber-900",children:"Approaching limit"})]})}),(0,s.jsxs)(y.ZI,{side:"bottom",children:[(0,s.jsx)("p",{children:"Exceeding your plans included usage will lead to restrictions to your project."}),(0,s.jsx)("p",{children:"Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})]})]})]})}),T&&N&&!N.unlimited&&(0,s.jsx)(ew.A,{type:"horizontal",barClass:(0,o.cn)(k>=1?P?"bg-foreground-light":"bg-red-900":!1===P&&k>=eH.xx?"bg-amber-900":"bg-foreground-light"),bgClass:"bg-surface-300",value:null!=(d=null==N?void 0:N.usage)?d:0,max:(null==N?void 0:N.pricing_free_units)||1}),(0,s.jsxs)("div",{children:[N&&(0,s.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==w||null==(t=w.plan)?void 0:t.name," Plan"]}),N.unlimited?(0,s.jsx)("p",{className:"text-xs",children:"Unlimited"}):(0,s.jsx)("p",{className:"text-xs",children:"bytes"===v.unit||"gigabytes"===v.unit?"".concat(null!=(c=N.pricing_free_units)?c:0," GB"):(null!=(u=N.pricing_free_units)?u:0).toLocaleString()})]}),T&&N&&(0,s.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:[v.chartPrefix||"Used "," in period"]}),(0,s.jsx)("p",{className:"text-xs",children:"bytes"===v.unit||"gigabytes"===v.unit?"".concat((null!=(m=null==N?void 0:N.usage)?m:0).toFixed(2)," GB"):(null!=(p=null==N?void 0:N.usage)?p:0).toLocaleString()})]}),T&&(null!=(x=null==N?void 0:N.pricing_free_units)?x:0)>0&&(0,s.jsxs)("div",{className:"flex items-center justify-between border-t py-1",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Overage in period"}),(0,s.jsx)("p",{className:"text-xs",children:(null!=(g=null==N?void 0:N.pricing_free_units)?g:0)===-1||M<0?"0".concat("bytes"===v.unit||"gigabytes"===v.unit?" GB":""):"bytes"===v.unit||"gigabytes"===v.unit?"".concat(M.toFixed(2)," GB"):M.toLocaleString()})]})]})]}),null==(a=v.additionalInfo)?void 0:a.call(v,b),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:[v.chartPrefix||""," ",v.name," ",v.chartSuffix||"per day"]}),v.chartDescription.split("\n").map((e,t)=>(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:e},"para-".concat(t)))]}),A[v.key].isLoading?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}):L.length>0&&z?(0,s.jsx)(sg.A,{name:"".concat(v.chartPrefix||"").concat(v.name),unit:v.unit,attributes:v.attributes,data:L,yLeftMargin:A[v.key].margin,yFormatter:e=>su(e,v.unit),tooltipFormatter:e=>sm(e,v.unit)}):(0,s.jsx)(ax.A,{children:(0,s.jsx)(ax.A.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)(si.A,{className:"text-foreground-light mb-2"}),(0,s.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to 24 hours to show"})]})})})]}):(0,s.jsx)(ax.A,{children:(0,s.jsx)(ax.A.Content,{children:(0,s.jsxs)("div",{className:"flex w-full items-center flex-col justify-center space-y-2 md:flex-row md:justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm",children:"Not included in plan"}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You need to be on a higher plan in order to use this feature."})})]}),(0,s.jsx)(F.$,{type:"primary",asChild:!0,children:(0,s.jsx)(ec(),{href:R,children:"Upgrade plan"})})]})})})})]})})};var sf=a(83729);async function sj(e,t){let{orgSlug:a}=e;if(!a)throw Error("orgSlug is required");let{data:s,error:n}=await (0,_.Jt)("/platform/organizations/{slug}/projects",{params:{path:{slug:a}},signal:t});return n&&(0,_.H4)(n),s}let sv=function(e){let{orgSlug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(sf.g.orgProjects(t),e=>{let{signal:a}=e;return sj({orgSlug:t},a)},{enabled:a&&void 0!==t,...s})};var sb=a(79050);let sN=e=>{var t,a;let{slug:n,projectRef:r,attribute:l,subscription:i,usage:o,currentBillingCycleSelected:d}=e,{data:c,isError:u,isLoading:m,isSuccess:p,error:x}=sv({orgSlug:n},{enabled:d}),g=(0,h.useMemo)(()=>c?c.projects.filter(e=>{let t=e.is_branch&&e.databases.some(e=>{var t;return(null!=(t=e.disk_volume_size_gb)?t:8)>8}),a=e.status!==eH.BU.INACTIVE,s=e.databases.every(e=>"AWS"===e.cloud_provider);return(!e.is_branch||t)&&a&&s}).filter(e=>e.ref===r||!r):[],[c,r]),y=(0,h.useMemo)(()=>g.some(e=>e.databases.some(e=>"READ_REPLICA"===e.type||e.disk_volume_size_gb&&e.disk_volume_size_gb>8)),[g]),f=null==o?void 0:o.usages.find(e=>e.metric===ex.Lb.DISK_SIZE_GB_HOURS_GP3),j=null==o?void 0:o.usages.find(e=>e.metric===ex.Lb.DISK_SIZE_GB_HOURS_IO2);return(0,s.jsx)("div",{id:l.anchor,className:"scroll-my-12","data-sentry-component":"DiskUsage","data-sentry-source-file":"DiskUsage.tsx",children:(0,s.jsxs)(so,{section:l,"data-sentry-element":"SectionContent","data-sentry-source-file":"DiskUsage.tsx",children:[m&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),u&&(0,s.jsx)(S.A,{subject:"Failed to retrieve usage data",error:x}),p&&(0,s.jsxs)("div",{className:"space-y-4",children:[d&&(null==i?void 0:i.usage_billing_enabled)===!1&&y&&(0,s.jsxs)(ta.Fc,{variant:"warning",children:[(0,s.jsx)(tL.HV,{}),(0,s.jsx)(ta.XL,{children:"Projects exceeding quota"}),(0,s.jsx)(ta.TN,{children:"You have projects that are exceeding 8 GB of provisioned disk size, but do not allow any overages with the Spend Cap on. Reduce the disk size or disable the spend cap."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("p",{className:"text-sm",children:[l.name," usage"]})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==i||null==(t=i.plan)?void 0:t.name," Plan"]}),(0,s.jsx)("p",{className:"text-xs",children:"8 GB GP3 disk per project"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Overages in period"}),(0,s.jsxs)("p",{className:"text-xs",children:[(null!=(a=null==f?void 0:f.usage)?a:0).toLocaleString()," GP3 GB-Hrs",(null==j?void 0:j.usage)?" / ".concat(j.usage.toLocaleString()," IO2 GB-Hrs"):""]})]})]}),d?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm",children:"Current disk size per project"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Breakdown of disk per project. Head to your project's disk management section to see database size used."})]}),0===g.length&&(0,s.jsx)(ax.A,{children:(0,s.jsx)(ax.A.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm",children:"No active projects"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You don't have any active projects in this organization."})]})})}),g.map((e,t)=>{let a=e.databases.filter(e=>"PRIMARY"===e.type).reduce((e,t)=>{var a;return e+(null!=(a=t.disk_volume_size_gb)?a:8)},0),n=e.databases.filter(e=>"PRIMARY"!==e.type),r=n.reduce((e,t)=>{var a;return e+(null!=(a=t.disk_volume_size_gb)?a:8)},0);return(0,s.jsxs)("div",{className:t!==g.length-1?"border-b pb-2":"",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-foreground-light flex items-center gap-2",children:e.name}),(0,s.jsx)(F.$,{asChild:!0,type:"default",size:"tiny",children:(0,s.jsx)(ec(),{href:"/project/".concat(e.ref,"/settings/compute-and-disk"),children:"Manage Disk"})})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)("div",{className:"flex items-center h-6 gap-3",children:[(0,s.jsxs)("span",{className:"text-foreground-light text-sm font-mono flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-foreground font-semibold -mt-[2px]",children:(0,s.jsx)(sb.Ay,{value:a+r,style:{lineHeight:.8},className:"font-mono"})})," ","GB Disk provisioned"]}),(0,s.jsxs)(ev.I,{side:"top",children:[(0,s.jsxs)("p",{children:[a," GB for Primary Database"]}),n.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:[r," GB for ",n.length," Read"," ",1===n.length?"Replica":"Replicas"]}),(0,s.jsx)("p",{className:"mt-1",children:"Read replicas have their own disk and use 25% more disk to account for WAL files."})]})]})]})})]},"usage-project-".concat(e.ref))})]}):(0,s.jsx)(ax.A,{children:(0,s.jsx)(ax.A.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm",children:"Data not available"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Switch to current billing cycle to see current disk size per project."})]})})})]})]})})},sS=e=>{var t;let{attribute:a,subscription:n,usage:r,currentBillingCycleSelected:l}=e,i=(0,h.useMemo)(()=>null==r?void 0:r.usages.find(e=>e.metric===ex.Lb.DATABASE_SIZE),[r]),o=(0,h.useMemo)(()=>null==i?void 0:i.project_allocations.some(e=>e.usage>.5*1e9),[i]);return(0,s.jsx)("div",{id:a.anchor,className:"scroll-my-12","data-sentry-component":"DatabaseSizeUsage","data-sentry-source-file":"DatabaseSizeUsage.tsx",children:(0,s.jsx)(so,{section:a,"data-sentry-element":"SectionContent","data-sentry-source-file":"DatabaseSizeUsage.tsx",children:(0,s.jsxs)("div",{className:"space-y-4",children:[l&&o&&(0,s.jsxs)(ta.Fc,{variant:"warning",children:[(0,s.jsx)(tL.HV,{}),(0,s.jsx)(ta.XL,{children:"Projects exceeding quota"}),(0,s.jsx)(ta.TN,{children:"You have projects that are exceeding 0.5 GB of database size. Reduce the database size or upgrade to a paid plan."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("p",{className:"text-sm",children:[a.name," usage"]})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==n||null==(t=n.plan)?void 0:t.name," Plan"]}),(0,s.jsx)("p",{className:"text-xs",children:"0.5 GB per project"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Max database size"}),(0,s.jsx)("p",{className:"text-xs",children:(null==i?void 0:i.usage)?(0,P.z3)(null==i?void 0:i.usage_original):"-"})]})]}),l?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"space-y-1",children:(0,s.jsx)("p",{className:"text-sm",children:"Current database size per project"})}),(null==i?void 0:i.project_allocations.length)===0&&(0,s.jsx)(ax.A,{children:(0,s.jsx)(ax.A.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm",children:"No active projects"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You don't have any active projects in this organization."})]})})}),null==i?void 0:i.project_allocations.map((e,t)=>(0,s.jsxs)("div",{className:t!==i.project_allocations.length-1?"border-b pb-2":"",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-foreground-light flex items-center gap-2",children:e.name}),(0,s.jsx)(F.$,{asChild:!0,type:"default",size:"tiny",children:(0,s.jsx)(ec(),{href:"/project/".concat(e.ref,"/reports/database#database-size-report"),children:"Manage Database Size"})})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)("div",{className:"flex items-center h-6 gap-3",children:[(0,s.jsxs)("span",{className:"text-foreground-light text-sm font-mono flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-foreground font-semibold font-mono -mt-[2px]",children:(0,P.z3)(e.usage)})," ","Database Size"]}),(0,s.jsx)(ev.I,{side:"top",children:(0,s.jsxs)("p",{children:[(0,P.z3)(e.usage)," GB database size as reported by Postgres."]})})]})})]},"usage-project-".concat(e.ref)))]}):(0,s.jsx)(ax.A,{children:(0,s.jsx)(ax.A.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm",children:"Data not available"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Switch to current billing cycle to see current database size per project."})]})})})]})})})},sA=e=>{let{orgSlug:t,projectRef:a,categoryKey:n,chartMeta:l,subscription:i,currentBillingCycleSelected:o}=e,{data:d,error:c,isLoading:u,isError:m,isSuccess:p}=(0,tD.n)({orgSlug:t}),x=(0,sr.rj)(i).find(e=>e.key===n);return x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"UsageSection.tsx",children:(0,s.jsx)(sn,{title:x.name,description:x.description,"data-sentry-element":"SectionHeader","data-sentry-source-file":"UsageSection.tsx"})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"UsageSection.tsx"}),x.attributes.map(e=>"diskSize"===e.key?(0,s.jsx)(sN,{slug:t,projectRef:a,attribute:e,subscription:i,currentBillingCycleSelected:o,usage:d},e.name):e.key===ex.Lb.DATABASE_SIZE?(0,s.jsx)(sS,{slug:t,projectRef:a,attribute:e,subscription:i,currentBillingCycleSelected:o,usage:d},e.name):(0,s.jsx)(sy,{slug:t,projectRef:a,attribute:e,usage:d,usageMeta:null==d?void 0:d.usages.find(t=>t.metric===e.key),chartMeta:l,subscription:i,error:c,isLoading:u,isError:m,isSuccess:p,currentBillingCycleSelected:o},e.name))]}):null},sw=e=>{var t,a,n,r,l,i;let{orgSlug:o,projectRef:d,subscription:c,startDate:u,endDate:m,currentBillingCycleSelected:p}=e,{data:x,isLoading:h}=(0,ex.Ym)({orgSlug:o,projectRef:d,metric:ex.Lb.MONTHLY_ACTIVE_USERS,interval:"1d",startDate:u,endDate:m}),{data:g,isLoading:y}=(0,ex.Ym)({orgSlug:o,projectRef:d,metric:ex.Lb.MONTHLY_ACTIVE_SSO_USERS,interval:"1d",startDate:u,endDate:m}),{data:f,isLoading:j}=(0,ex.Ym)({orgSlug:o,projectRef:d,metric:ex.Lb.STORAGE_IMAGES_TRANSFORMED,interval:"1d",startDate:u,endDate:m}),{data:v,isLoading:b}=(0,ex.Ym)({orgSlug:o,projectRef:d,metric:ex.Lb.FUNCTION_INVOCATIONS,interval:"1d",startDate:u,endDate:m}),{data:N,isLoading:S}=(0,ex.Ym)({orgSlug:o,projectRef:d,metric:ex.Lb.REALTIME_MESSAGE_COUNT,interval:"1d",startDate:u,endDate:m}),{data:A,isLoading:w}=(0,ex.Ym)({orgSlug:o,projectRef:d,metric:ex.Lb.REALTIME_PEAK_CONNECTIONS,interval:"1d",startDate:u,endDate:m}),_={[ex.Lb.MONTHLY_ACTIVE_USERS]:{data:null!=(t=null==x?void 0:x.data)?t:[],margin:18,isLoading:h},[ex.Lb.MONTHLY_ACTIVE_SSO_USERS]:{data:null!=(a=null==g?void 0:g.data)?a:[],margin:20,isLoading:y},[ex.Lb.STORAGE_IMAGES_TRANSFORMED]:{data:null!=(n=null==f?void 0:f.data)?n:[],margin:0,isLoading:j},[ex.Lb.FUNCTION_INVOCATIONS]:{data:null!=(r=null==v?void 0:v.data)?r:[],margin:26,isLoading:b},[ex.Lb.REALTIME_MESSAGE_COUNT]:{data:null!=(l=null==N?void 0:N.data)?l:[],margin:38,isLoading:S},[ex.Lb.REALTIME_PEAK_CONNECTIONS]:{data:null!=(i=null==A?void 0:A.data)?i:[],margin:0,isLoading:w}};return(0,s.jsx)(sA,{orgSlug:o,projectRef:d,categoryKey:"activity",chartMeta:_,subscription:c,currentBillingCycleSelected:p,"data-sentry-element":"UsageSection","data-sentry-component":"Activity","data-sentry-source-file":"Activity.tsx"})},s_=e=>{var t;let{orgSlug:a,projectRef:n,subscription:r,startDate:l,endDate:i,currentBillingCycleSelected:o}=e,{data:d,isLoading:c}=(0,ex.Ym)({orgSlug:a,projectRef:n,metric:ex.Lb.EGRESS,interval:"1d",startDate:l,endDate:i}),u={[ex.Lb.EGRESS]:{data:null!=(t=null==d?void 0:d.data)?t:[],margin:16,isLoading:c}};return(0,s.jsx)(sA,{orgSlug:a,projectRef:n,categoryKey:"bandwidth",chartMeta:u,subscription:r,currentBillingCycleSelected:o,"data-sentry-element":"UsageSection","data-sentry-component":"Bandwidth","data-sentry-source-file":"Bandwidth.tsx"})};var sC=a(55319);async function sI(e,t){let{orgSlug:a,startDate:s,endDate:n,projectRef:r}=e;if(!a)throw Error("Org slug is required");if(!s)throw Error("Start date is required");if(!n)throw Error("End date is required");"/platform/organizations/{slug}/daily-stats/compute?&startDate=".concat(encodeURIComponent(s),"&endDate=").concat(encodeURIComponent(n));let{data:l,error:i}=await (0,_.Jt)("/platform/organizations/{slug}/daily-stats/compute",{params:{path:{slug:a},query:{projectRef:r,startDate:s,endDate:n}},signal:t});return i&&(0,_.H4)(i),l}let sE=function(e){let{orgSlug:t,startDate:a,endDate:s,projectRef:n,dateFormat:r="DD MMM"}=e,{enabled:l=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(sC.P.orgDailyComputeStats(t,{startDate:a,endDate:s,projectRef:n}),e=>{let{signal:r}=e;return sI({orgSlug:t,startDate:a,endDate:s,projectRef:n},r)},{enabled:l&&void 0!==t&&void 0!==a&&void 0!==s,select:e=>({...e,data:e.data.map(e=>({...e,periodStartFormatted:x()(e.period_start).format(r)}))}),staleTime:36e5,...i})},sT=e=>{var t;let{orgSlug:a,projectRef:n,startDate:r,endDate:l}=e,i=Object.values(ex.Fg).map(e=>e.toLowerCase()),{data:o,isLoading:d,error:c,isSuccess:u}=sE({orgSlug:a,projectRef:n,startDate:r,endDate:l}),m=null!=(t=null==o?void 0:o.data)?t:[],p={[ex.Fg.COMPUTE_HOURS_BRANCH]:"blue",[ex.Fg.COMPUTE_HOURS_XS]:"white",[ex.Fg.COMPUTE_HOURS_SM]:"green",[ex.Fg.COMPUTE_HOURS_MD]:"dark-green",[ex.Fg.COMPUTE_HOURS_L]:"yellow",[ex.Fg.COMPUTE_HOURS_XL]:"dark-yellow",[ex.Fg.COMPUTE_HOURS_2XL]:"orange",[ex.Fg.COMPUTE_HOURS_4XL]:"dark-orange",[ex.Fg.COMPUTE_HOURS_8XL]:"red",[ex.Fg.COMPUTE_HOURS_12XL]:"dark-red",[ex.Fg.COMPUTE_HOURS_16XL]:"purple"},x=Object.keys(ex.Fg).map(e=>({key:e.toLowerCase(),color:p[e]||"white",name:(0,ex.pc)(e)})),g=(0,h.useMemo)(()=>i.filter(e=>m.some(t=>t[e])),[m]),y=(0,h.useMemo)(()=>g.length>0,[g]);return(0,s.jsx)("div",{id:"compute",className:"scroll-my-12","data-sentry-component":"Compute","data-sentry-source-file":"Compute.tsx",children:(0,s.jsxs)(so,{section:{name:"Compute Hours",description:"Amount of hours your projects were active. Each project is a dedicated server and database.\nPaid plans come with $10 in Compute Credits to cover one project running on Micro Compute or parts of any compute add-on.\nBilling is based on the sum of Compute Hours used. Paused projects do not count towards usage.",links:[{name:"Compute Add-ons",url:"https://supabase.com/docs/guides/platform/compute-add-ons"},{name:"Usage-billing for Compute",url:"https://supabase.com/docs/guides/platform/manage-your-usage/compute"}]},"data-sentry-element":"SectionContent","data-sentry-source-file":"Compute.tsx",children:[d&&(0,s.jsx)(Q.y,{}),null!=c&&(0,s.jsx)(S.A,{subject:"Failed to retrieve usage data",error:c}),u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-1",children:[m.length>0&&(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsx)("p",{className:"text-sm",children:"Compute Hours usage"})})}),g.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between border-b last:border-b-0 py-1 last:py-0",children:[(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,s.jsx)("span",{className:"font-medium",children:(0,ex.pc)(e.toUpperCase())})," ","Compute Hours usage in period"]}),(0,s.jsxs)("p",{className:"text-sm",children:[m.reduce((t,a)=>{var s;return t+(null!=(s=a[e])?s:0)},0)," hours"]})]},e))]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm",children:"Compute Hours usage per day"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"The data refreshes every hour."})]}),d?(0,s.jsx)(Q.y,{}):m.length>0&&y?(0,s.jsx)(sg.A,{name:"Compute Hours usage",unit:"hours",attributes:x,data:m,yMin:24}):(0,s.jsx)(ax.A,{children:(0,s.jsx)(ax.A.Content,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)(si.A,{className:"text-foreground-light mb-2"}),(0,s.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to one hour to show"})]})})})]})]})})},sR=e=>{var t,a;let{orgSlug:n,projectRef:r,startDate:l,endDate:i,subscription:o,currentBillingCycleSelected:d}=e,{data:c,isLoading:u}=(0,ex.Ym)({orgSlug:n,projectRef:r,metric:ex.Lb.DATABASE_SIZE,interval:"1d",startDate:l,endDate:i}),{data:m,isLoading:p}=(0,ex.Ym)({orgSlug:n,projectRef:r,metric:ex.Lb.STORAGE_SIZE,interval:"1d",startDate:l,endDate:i}),x={[ex.Lb.DATABASE_SIZE]:{isLoading:u,margin:14,data:null!=(t=null==c?void 0:c.data)?t:[]},[ex.Lb.STORAGE_SIZE]:{isLoading:p,margin:14,data:null!=(a=null==m?void 0:m.data)?a:[]}};return(0,s.jsx)(sA,{orgSlug:n,projectRef:r,categoryKey:"sizeCount",chartMeta:x,subscription:o,currentBillingCycleSelected:d,"data-sentry-element":"UsageSection","data-sentry-component":"SizeAndCounts","data-sentry-source-file":"SizeAndCounts.tsx"})},sk=[{key:ex.Lb.DATABASE_SIZE,name:"Database Size",units:"bytes",anchor:"dbSize",category:"Database",unitName:"GB",tip:"Database size refers to the actual amount of space used by all your database objects, as reported by Postgres. Free Plan projects are limited to 0.5 GB Database Size each."},{key:ex.Lb.EGRESS,name:"Egress",units:"bytes",anchor:"egress",category:"Database",unitName:"GB"},{key:ex.Lb.MONTHLY_ACTIVE_USERS,name:"Monthly Active Users",units:"absolute",anchor:"mau",category:"Authentication",unitName:"MAU"},{key:ex.Lb.MONTHLY_ACTIVE_SSO_USERS,name:"Monthly Active SSO Users",units:"absolute",anchor:"mauSso",category:"Authentication",unitName:"MAU"},{key:ex.Lb.MONTHLY_ACTIVE_THIRD_PARTY_USERS,name:"Monthly Active Third-Party Users",units:"absolute",category:"Authentication",unitName:"MAU"},{key:ex.Lb.STORAGE_SIZE,name:"Storage Size",units:"bytes",anchor:"storageSize",category:"Storage",unitName:"GB"},{key:ex.Lb.STORAGE_IMAGES_TRANSFORMED,name:"Storage Image Transformations",units:"absolute",anchor:"storageImageTransformations",category:"Storage"},{key:ex.Lb.REALTIME_PEAK_CONNECTIONS,name:"Realtime Concurrent Peak Connections",units:"absolute",anchor:"realtimePeakConnections",category:"Realtime"},{key:ex.Lb.REALTIME_MESSAGE_COUNT,name:"Realtime Messages",units:"absolute",anchor:"realtimeMessageCount",category:"Realtime"},{key:ex.Lb.FUNCTION_INVOCATIONS,name:"Edge Function Invocations",units:"absolute",anchor:"funcInvocations",category:"Edge Functions"},{key:ex.Lb.DISK_SIZE_GB_HOURS_GP3,name:"Disk Size",anchor:"diskSize",units:"absolute",unitName:"GB-Hrs",category:"Database",tip:"Each project gets provisioned with 8 GB of GP3 disk for free. When you get close to the disk size limit, we autoscale your disk by 1.5x. Each GB of provisioned disk size beyond 8 GB incurs a GB-Hr every hour. Each extra GB is billed at $0.125/month ($0.000171/GB-Hr), prorated down to the hour.",docLink:{title:"Read more",url:"https://supabase.com/docs/guides/platform/manage-your-usage/disk-size"}},{key:ex.Lb.DISK_SIZE_GB_HOURS_IO2,name:"Disk Size IO2",anchor:"diskSize",units:"absolute",unitName:"GB-Hrs",category:"Database"},{key:ex.Lb.DISK_IOPS_IO2,name:"Disk IOPS IO2",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:ex.Lb.DISK_IOPS_GP3,name:"Disk IOPS GP3",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:ex.Lb.DISK_THROUGHPUT_GP3,name:"Disk Throughput",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:ex.Lb.LOG_DRAIN_EVENTS,name:"Log Drain Events",units:"absolute",category:"Database"}],sM=e=>{var t;let{slug:a,metric:n,usage:r,subscription:l,relativeToSubscription:i}=e,o=r.usages.find(e=>e.metric===n.key),d=(0,h.useMemo)(()=>{var e,t,a,s;return o?i&&!1===o.available_in_plan?"Unavailable in plan":o.cost&&o.cost>0||!i||o.unlimited||0===o.pricing_free_units?"bytes"===n.units||"gigabytes"===n.units?"".concat(null!=(e=o.usage.toLocaleString())?e:0," GB"):o.usage.toLocaleString()+(n.unitName?" ".concat(n.unitName):""):"bytes"===n.units||"gigabytes"===n.units?"".concat(null!=(a=o.usage.toLocaleString())?a:0," / ").concat(null!=(s=o.pricing_free_units)?s:0," GB"):"".concat(o.usage.toLocaleString()," / ").concat(null==(t=o.pricing_free_units)?void 0:t.toLocaleString())+(n.unitName?" ".concat(n.unitName):""):""},[o,i,n]),c=(0,h.useMemo)(()=>o&&o.project_allocations?o.project_allocations.sort((e,t)=>t.usage-e.usage):[],[o]);if(!o)return null;let u=0===o.usage?0:o.usage/(null!=(t=o.pricing_free_units)?t:0),m=(null==l?void 0:l.usage_billing_enabled)===!0,p=!1==!!o.unlimited,x=p&&u>=.8,g=i&&p&&u>=1,y=ef(o.metric),f=0===o.usage||0===o.pricing_free_units?"":u<.01?"(<1%)":"(".concat((+(100*u).toFixed(0)).toLocaleString(),"%)");return(0,s.jsxs)(as.jc,{openDelay:50,closeDelay:200,"data-sentry-element":"HoverCard","data-sentry-component":"BillingMetric","data-sentry-source-file":"BillingMetric.tsx",children:[(0,s.jsx)(as.d0,{asChild:!0,"data-sentry-element":"HoverCardTrigger","data-sentry-source-file":"BillingMetric.tsx",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(ec(),{href:"/org/".concat(a,"/usage#").concat(n.anchor),className:"block w-full group","data-sentry-element":"Link","data-sentry-source-file":"BillingMetric.tsx",children:[n.anchor?(0,s.jsxs)("div",{className:"group flex items-center gap-1",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:n.name}),o.available_in_plan&&(0,s.jsx)("span",{className:"transition inline-block group-hover:transform group-hover:translate-x-0.5",children:(0,s.jsx)(z.A,{strokeWidth:1.5,size:16,className:"transition"})})]}):(0,s.jsx)("p",{className:"text-xs text-foreground-light flex space-x-1",children:n.name}),(0,s.jsx)("span",{className:"text-sm",children:d}),"\xa0",i&&o.cost&&o.cost>0?(0,s.jsxs)("span",{className:"text-sm",children:["(",(0,P.vv)(o.cost),")"]}):o.available_in_plan&&!o.unlimited&&i?(0,s.jsx)("span",{className:"text-sm",children:f}):null]}),o.available_in_plan?(0,s.jsx)("div",{children:i&&!o.unlimited?(0,s.jsxs)("svg",{className:"h-8 w-8 -rotate-90 transform",children:[(0,s.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeWidth:4,className:"text-background-surface-300"}),(0,s.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeDasharray:75.398,strokeDashoffset:"calc(75.39822 - ".concat(u<1?100*u:100," / 100 * 75.39822)"),strokeWidth:4,className:m?"text-gray-dark-800":g?"text-red-900":x?"text-yellow-1000":"text-gray-dark-800"})]}):null}):(0,s.jsx)("div",{children:(0,s.jsx)(F.$,{type:"default",asChild:!0,children:(0,s.jsx)(ec(),{href:"/org/".concat(a,"/billing?panel=subscriptionPlan&source=billingBreakdownUsage").concat(n.anchor),children:"Upgrade"})})})]})}),o.available_in_plan&&(0,s.jsx)(as.Et,{side:"bottom",align:"center",className:"w-[500px]",animate:"slide-in",children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"font-medium",children:o.unit_price_desc}),n.tip&&(0,s.jsx)("div",{className:"my-2",children:(0,s.jsxs)("p",{className:"text-sm",children:[n.tip," ",n.docLink&&(0,s.jsx)(ec(),{href:n.docLink.url,target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:n.docLink.title})]})}),!1===l.usage_billing_enabled&&i&&(x||g)&&(0,s.jsx)("div",{className:"my-2",children:(0,s.jsx)("p",{className:"text-sm",children:"Exceeding your plans included usage will lead to restrictions to your project. Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})}),c&&c.length>0&&(0,s.jsxs)("table",{className:"list-disc w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left",children:"Project"}),(0,s.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,s.jsxs)("tbody",{children:[c.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.name}),(0,s.jsx)("td",{className:"text-right",children:ey(o.metric,e)})]},"".concat(o.metric,"_").concat(e.ref))),(0,s.jsx)("tr",{})]}),(0,s.jsx)("tfoot",{children:(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{className:"py-2 border-t text-left",children:["Total",y&&(0,s.jsxs)("span",{children:[" (",y,")"]})]}),(0,s.jsxs)("td",{className:"py-2 border-t text-right",children:[ey(o.metric,{usage:o.usage_original})," "]})]})})]})]})})]})},sP=e=>{let{slug:t,metric:a,usage:n,relativeToSubscription:r}=e,l=n.usages.find(e=>e.metric===a.key),i=(0,h.useMemo)(()=>{var e,t,a,s,n;return(null==l?void 0:l.pricing_free_units)?"".concat(null!=(t=null==l||null==(e=l.usage)?void 0:e.toLocaleString())?t:0," / ").concat(null!=(a=null==l?void 0:l.pricing_free_units)?a:0," hours"):"".concat(null!=(n=null==l||null==(s=l.usage)?void 0:s.toLocaleString())?n:0," hours")},[l]),o=(0,h.useMemo)(()=>l&&l.project_allocations?l.project_allocations.sort((e,t)=>t.usage-e.usage):[],[l]);return(0,s.jsxs)(as.jc,{openDelay:50,closeDelay:200,"data-sentry-element":"HoverCard","data-sentry-component":"ComputeMetric","data-sentry-source-file":"ComputeMetric.tsx",children:[(0,s.jsx)(as.d0,{"data-sentry-element":"HoverCardTrigger","data-sentry-source-file":"ComputeMetric.tsx",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(ec(),{href:"/org/".concat(t,"/usage#").concat(a.anchor),"data-sentry-element":"Link","data-sentry-source-file":"ComputeMetric.tsx",children:(0,s.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:a.name}),(0,s.jsx)(z.A,{strokeWidth:1.5,size:16,className:"transition","data-sentry-element":"ChevronRight","data-sentry-source-file":"ComputeMetric.tsx"})]})}),(0,s.jsx)("span",{className:"text-sm",children:i}),"\xa0",r&&(null==l?void 0:l.cost)&&l.cost>0?(0,s.jsxs)("span",{className:"text-sm",children:["(",(0,P.vv)(null==l?void 0:l.cost),")"]}):null]})}),(0,s.jsx)(as.Et,{side:"bottom",align:"center",className:"w-[500px]",animate:"slide-in","data-sentry-element":"HoverCardContent","data-sentry-source-file":"ComputeMetric.tsx",children:(0,s.jsxs)("div",{className:"text-sm text-foreground space-y-2",children:[(0,s.jsx)("p",{className:"font-medium",children:null==l?void 0:l.unit_price_desc}),(0,s.jsx)("div",{className:"my-2",children:(0,s.jsxs)("p",{className:"text-sm",children:["Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the compute size of your project. Paused projects do not incur compute costs."," ",(0,s.jsx)(ec(),{href:"https://supabase.com/docs/guides/platform/manage-your-usage/compute",target:"_blank",className:"transition text-brand hover:text-brand-600 underline","data-sentry-element":"Link","data-sentry-source-file":"ComputeMetric.tsx",children:"Read more"})]})}),l&&o.length>0&&(0,s.jsxs)("table",{className:"list-disc w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left",children:"Project"}),(0,s.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,s.jsxs)("tbody",{children:[o.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.name}),(0,s.jsx)("td",{className:"text-right",children:ey(l.metric,e)})]},"".concat(l.metric,"_").concat(e.ref))),(0,s.jsx)("tr",{})]}),(0,s.jsx)("tfoot",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-2 border-t text-left",children:"Total (Hours)"}),(0,s.jsx)("td",{className:"py-2 border-t text-right",children:ey(l.metric,{usage:l.usage_original})})]})})]})]})})]})},sD=[ex.Lb.DISK_IOPS_IO2,ex.Lb.DISK_IOPS_GP3,ex.Lb.DISK_SIZE_GB_HOURS_GP3,ex.Lb.DISK_SIZE_GB_HOURS_IO2,ex.Lb.DISK_THROUGHPUT_GP3],sL=e=>{var t,a;let{orgSlug:n,projectRef:r,subscription:l,startDate:i,endDate:d,currentBillingCycleSelected:c}=e,u=null==l?void 0:l.usage_billing_enabled,{data:m,error:p,isLoading:x,isError:g,isSuccess:y}=(0,tD.n)({orgSlug:n,projectRef:r,start:!c&&i?new Date(i):void 0,end:!c&&d?new Date(d):void 0}),f=c&&!r,j=f&&!!(null==m?void 0:m.usages.find(e=>{var t;return!e.metric.startsWith("COMPUTE_")&&!e.unlimited&&e.usage>(null!=(t=null==e?void 0:e.pricing_free_units)?t:0)})),v=(0,h.useMemo)(()=>m?sk.filter(e=>m.usages.some(t=>t.metric===e.key)).filter(e=>{if(!sD.includes(e.key))return!0;let t=m.usages.find(t=>t.metric===e.key);return t&&t.usage>0}).slice().sort((e,t)=>{var a,s,n,r;let l=m.usages.find(t=>t.metric===e.key),i="number"!=typeof l?(null!=(a=null==l?void 0:l.usage)?a:0)/(null!=(s=null==l?void 0:l.pricing_free_units)?s:0):0,o=m.usages.find(e=>e.metric===t.key),d="number"!=typeof o?(null!=(n=null==o?void 0:o.usage)?n:0)/(null!=(r=null==o?void 0:o.pricing_free_units)?r:0):0;return Number(null==o?void 0:o.available_in_plan)-Number(null==l?void 0:l.available_in_plan)||d-i}):[],[m]),b=((null==m?void 0:m.usages)||[]).filter(e=>e.metric.startsWith("COMPUTE")).map(e=>e.metric);return(0,s.jsx)("div",{id:"summary","data-sentry-component":"TotalUsage","data-sentry-source-file":"TotalUsage.tsx",children:(0,s.jsxs)(so,{section:{name:"Usage Summary",description:u?"Your plan includes a limited amount of usage. If exceeded, you will be charged for the overages. It may take up to 1 hour to refresh.":"Your plan includes a limited amount of usage. If exceeded, you may experience restrictions, as you are currently not billed for overages. It may take up to 1 hour to refresh.",links:[{name:"How billing works",url:"https://supabase.com/docs/guides/platform/billing-on-supabase"},{name:"Supabase Plans",url:"https://supabase.com/pricing"}]},"data-sentry-element":"SectionContent","data-sentry-source-file":"TotalUsage.tsx",children:[x&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),g&&(0,s.jsx)(S.A,{subject:"Failed to retrieve usage data",error:p}),y&&l&&(0,s.jsxs)("div",{children:[f&&(0,s.jsx)("p",{className:"text-sm",children:j?j&&(null==l||null==(t=l.plan)?void 0:t.id)==="free"?(0,s.jsxs)("span",{children:["You have exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:null==l?void 0:l.plan.name})," Plan quota in this billing cycle. Upgrade your plan to continue using Supabase without restrictions."]}):j&&(null==l?void 0:l.usage_billing_enabled)===!1&&(null==l||null==(a=l.plan)?void 0:a.id)==="pro"?(0,s.jsxs)("span",{children:["You have exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:null==l?void 0:l.plan.name})," Plan quota in this billing cycle. Disable your spend cap to continue using Supabase without restrictions."]}):j&&(null==l?void 0:l.usage_billing_enabled)===!0?(0,s.jsxs)("span",{children:["You have exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:null==l?void 0:l.plan.name})," Plan quota in this billing cycle and will be charged for over-usage."]}):(0,s.jsxs)("span",{children:["You have not exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:null==l?void 0:l.plan.name})," Plan quota in this billing cycle."]}):(0,s.jsxs)("span",{children:["You have not exceeded your"," ",(0,s.jsx)("span",{className:"font-medium",children:null==l?void 0:l.plan.name})," Plan quota in this billing cycle."]})}),(0,s.jsxs)("div",{className:"grid grid-cols-12 mt-3",children:[v.map((e,t)=>(0,s.jsx)("div",{className:(0,o.cn)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",t%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,s.jsx)(sM,{idx:t,slug:n,metric:e,usage:m,subscription:l,relativeToSubscription:f})},e.key)),b.map((e,t)=>(0,s.jsx)("div",{className:(0,o.cn)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",(t+v.length)%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,s.jsx)(sP,{slug:n,metric:{key:e,name:(0,ex.pc)(e)+" Compute Hours",units:"hours",anchor:"compute",category:"Compute",unitName:"GB"},relativeToSubscription:f,usage:m})},e))]})]})]})})},sO=()=>{let e=(0,n.FO)(),{slug:t,projectRef:a}=(0,$.g)(),[l,p]=(0,h.useState)(),[g,y]=(0,h.useState)(),f=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions"),j=(0,i.a)(),{data:v,isSuccess:b}=(0,tW.el)(),{data:N,error:A,isLoading:w,isError:_,isSuccess:C}=(0,d.j5)({orgSlug:t}),I=null==v?void 0:v.filter(e=>e.organization_id===(null==j?void 0:j.id));(0,h.useEffect)(()=>{a&&b&&void 0!==I&&I.find(e=>e.ref===a)&&y(a)},[a,b]);let E=(0,h.useMemo)(()=>{var e;return x().unix(null!=(e=null==N?void 0:N.current_period_start)?e:0).utc()},[N]),T=(0,h.useMemo)(()=>{var e;return x().unix(null!=(e=null==N?void 0:N.current_period_end)?e:0).utc()},[N]),R=(0,h.useMemo)(()=>null==l||!l.period_start||null==l||!l.period_end||x()(l.period_start.date).isSame(E)&&x()(l.period_end.date).isSame(T),[l,E,T]),k=(0,h.useMemo)(()=>{var e,t;if(null==l||null==(e=l.period_start)?void 0:e.date)return new Date(null==l||null==(t=l.period_start)?void 0:t.date).toISOString().slice(0,-5)+"Z"},[l,N]),M=(0,h.useMemo)(()=>{var e,t;return(null==l||null==(e=l.period_end)?void 0:e.date)&&x()(l.period_end.date).isAfter(x()())?x()().endOf("day").toISOString().slice(0,-5)+"Z":(null==l||null==(t=l.period_end)?void 0:t.date)?new Date(l.period_end.date).toISOString().slice(0,-5)+"Z":void 0},[l,N]),P=g?null==I?void 0:I.find(e=>e.ref===g):void 0;return f?(0,s.jsxs)(s.Fragment,{children:[e&&(0,s.jsx)(r.Vw,{children:(0,s.jsx)(r.Dm,{children:"Usage"})}),(0,s.jsx)("div",{className:"sticky top-0 border-b bg-studio z-[1] overflow-hidden ",children:(0,s.jsx)(r.eh,{className:"","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Usage.tsx",children:(0,s.jsxs)("div",{className:"py-4 flex items-center space-x-4",children:[w&&(0,s.jsx)(Q.A,{className:"w-[250px]"}),_&&(0,s.jsx)(S.A,{className:"w-full",subject:"Failed to retrieve usage data",error:A}),C&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sa.A,{onChange:p,value:ss.L3[0].key,options:[...ss.L3,...ss.PJ],loading:w,currentBillingPeriodStart:null==N?void 0:N.current_period_start,currentBillingPeriodEnd:null==N?void 0:N.current_period_end}),(0,s.jsxs)(el.A,{size:"tiny",name:"schema",className:"w-[180px]",value:g,onChange:e=>{"all-projects"===e?y(void 0):y(e)},children:[(0,s.jsx)(el.A.Option,{id:"all-projects",label:"All projects",value:"all-projects",children:"All projects"},"all-projects"),null==I?void 0:I.map(e=>(0,s.jsx)(el.A.Option,{id:e.ref,value:e.ref,label:e.name,children:e.name},e.ref))]}),(0,s.jsxs)("div",{className:"flex flex-col xl:flex-row xl:gap-3",children:[(0,s.jsxs)("p",{className:(0,o.cn)("text-sm transition",w&&"opacity-50"),children:["Organization is on the ",N.plan.name," plan"]}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:[E.format("DD MMM YYYY")," -"," ",T.format("DD MMM YYYY")]})]})]})]})})}),g?(0,s.jsx)(r.eh,{className:"mt-5",children:(0,s.jsx)(tk.Z,{type:"default",title:"Usage filtered by project",description:(0,s.jsxs)("div",{children:['You are currently viewing usage for the "$',(null==P?void 0:P.name)||g,'" project. Supabase uses'," ",(0,s.jsx)(ec(),{href:"/docs/guides/platform/billing-on-supabase#organization-based-billing",target:"_blank",children:"organization-level billing"})," ",'and quotas. For billing purposes, we sum up usage from all your projects. To view your usage quota, set the project filter above back to "All Projects".']})})}):(0,s.jsx)(r.eh,{id:"restriction",className:"mt-5",children:(0,s.jsx)(tO,{})}),(0,s.jsx)(sL,{orgSlug:t,projectRef:g,subscription:N,startDate:k,endDate:M,currentBillingCycleSelected:R,"data-sentry-element":"TotalUsage","data-sentry-source-file":"Usage.tsx"}),(null==N?void 0:N.plan.id)!=="free"&&(0,s.jsx)(sT,{orgSlug:t,projectRef:g,subscription:N,startDate:k,endDate:M}),(0,s.jsx)(s_,{orgSlug:t,projectRef:g,subscription:N,startDate:k,endDate:M,currentBillingCycleSelected:R,"data-sentry-element":"Bandwidth","data-sentry-source-file":"Usage.tsx"}),(0,s.jsx)(sR,{orgSlug:t,projectRef:g,subscription:N,startDate:k,endDate:M,currentBillingCycleSelected:R,"data-sentry-element":"SizeAndCounts","data-sentry-source-file":"Usage.tsx"}),(0,s.jsx)(sw,{orgSlug:t,projectRef:g,subscription:N,startDate:k,endDate:M,currentBillingCycleSelected:R,"data-sentry-element":"Activity","data-sentry-source-file":"Usage.tsx"})]}):(0,s.jsx)(r.Vw,{children:(0,s.jsx)(u.A,{resourceText:"view organization usage"})})};var sz=a(94786),sF=a(42766),sU=a(16175),sB=a(75809),sG=a(39413),sH=a.n(sG),sV=a(55589),sY=a(61314),sq=a(53755),sW=a(23104);let s$=["Owner","Administrator","Developer","Read-only"];async function sJ(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:s,error:n}=await (0,_.Jt)("/platform/organizations/{slug}/roles",{params:{path:{slug:a}},signal:t});return n&&(0,_.H4)(n),s}let sZ=function(e){let{slug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(sW.O.rolesV2(t),e=>{let{signal:a}=e;return sJ({slug:t},a)},{enabled:a&&void 0!==t,select:e=>({...e,org_scoped_roles:e.org_scoped_roles.sort((e,t)=>s$.indexOf(e.name)-s$.indexOf(t.name))}),...s})};async function sK(e,t){let{slug:a,iso_timestamp_start:s,iso_timestamp_end:n}=e;if(!a)throw Error("slug is required");let{data:r,error:l}=await (0,_.Jt)("/platform/organizations/{slug}/audit",{params:{path:{slug:a},query:{iso_timestamp_start:s,iso_timestamp_end:n}},signal:t});return l&&(0,_.H4)(l),r}let sQ=function(e){let{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{slug:s,iso_timestamp_start:n,iso_timestamp_end:r}=e;return(0,E.I)(X.O.auditLogs(s,{date_start:n,date_end:r}),t=>{let{signal:a}=t;return sK(e,a)},{enabled:t&&void 0!==s,...a})};var sX=a(8563),s0=a(39703);let s2=()=>{var e,t,a,n,l,i,o,d;let{slug:p}=(0,$.g)(),g=x()().utc().set("millisecond",0),[y,f]=(0,h.useState)(!0),[j,v]=(0,h.useState)({from:g.subtract(1,"day").toISOString(),to:g.toISOString()}),[b,w]=(0,h.useState)(),[_,C]=(0,h.useState)({users:[],projects:[]}),I=(0,m.SE)(c.aG.READ,"notifications"),{data:E}=(0,tW.el)(),{data:T}=(0,aC.Ad)(),{data:R}=(0,sX.Q)({slug:p}),{data:k}=sZ({slug:p}),{data:M,error:P,isLoading:D,isSuccess:L,isError:O,isRefetching:z,refetch:U}=sQ({slug:p,iso_timestamp_start:j.from,iso_timestamp_end:j.to},{enabled:I,retry:(e,t)=>!t.message.endsWith("upgrade to Team or Enterprise Plan to access audit logs."),retryOnMount:!1,refetchOnWindowFocus:!1}),B=(null!=R?R:[]).filter(e=>!e.invited_at),G=[...null!=(a=null==k?void 0:k.org_scoped_roles)?a:[],...null!=(n=null==k?void 0:k.project_scoped_roles)?n:[]],H=null!=(l=null==M?void 0:M.retention_period)?l:0,V=null!=(i=null==M?void 0:M.result)?i:[],Y=null==V||null==(t=V.sort((e,t)=>y?Number(new Date(t.occurred_at))-Number(new Date(e.occurred_at)):Number(new Date(e.occurred_at))-Number(new Date(t.occurred_at))))||null==(e=t.filter(e=>_.users.length>0?_.users.includes(e.actor.id):e))?void 0:e.filter(e=>_.projects.length>0?_.projects.includes(e.target.metadata.project_ref||""):e),q=null==T?void 0:T.find(e=>e.slug===p),W=x()().subtract(H,"days"),J=x()();return((0,h.useEffect)(()=>{let e=x()(j.from).diff(x()(j.to)),t=setInterval(()=>{let t=x()().utc().set("millisecond",0);v({from:t.add(e).toISOString(),to:t.toISOString()})},3e5);return()=>clearInterval(t)},[j.from,j.to]),I)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.Vw,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-source-file":"AuditLogs.tsx",children:(0,s.jsxs)("div",{className:"space-y-4 flex flex-col",children:[D&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),O?P.message.endsWith("upgrade to Team or Enterprise Plan to access audit logs.")?(0,s.jsxs)(ta.Fc,{variant:"default",title:"Organization Audit Logs are not available on Free or Pro plans",children:[(0,s.jsx)(tL.id,{}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row pt-1 gap-4",children:[(0,s.jsxs)("div",{className:"grow",children:[(0,s.jsx)(ta.XL,{children:"Organization Audit Logs are not available on Free or Pro plans"}),(0,s.jsx)(ta.TN,{className:"flex flex-row justify-between gap-3",children:(0,s.jsx)("p",{children:"Upgrade to Team or Enterprise to view up to 28 days of Audit Logs for your organization."})})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(F.$,{type:"primary",asChild:!0,children:(0,s.jsx)(ec(),{href:"/org/".concat(p,"/billing?panel=subscriptionPlan&source=auditLogs"),children:"Upgrade subscription"})})})]})]}):(0,s.jsx)(S.A,{error:P,subject:"Failed to retrieve audit logs"}):null,L&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-xs prose",children:"Filter by"}),(0,s.jsx)(sq.I,{name:"Users",options:B,labelKey:"username",valueKey:"gotrue_id",activeOptions:_.users,onSaveFilters:e=>C({..._,users:e})}),(0,s.jsx)(sq.I,{name:"Projects",options:null!=(o=null==E?void 0:E.filter(e=>e.organization_id===(null==q?void 0:q.id)))?o:[],labelKey:"name",valueKey:"ref",activeOptions:_.projects,onSaveFilters:e=>C({..._,projects:e})}),(0,s.jsx)(sY.l,{hideTime:!0,hideClear:!0,triggerButtonType:"dashed",triggerButtonTitle:"",from:j.from,to:j.to,minDate:W.toDate(),maxDate:J.toDate(),onChange:e=>{if(null!==e.from&&null!==e.to){let{from:t,to:a}=(0,s0.U)(e);v({from:t,to:a})}},renderFooter:()=>(0,s.jsx)(tk.Z,{showIcon:!1,type:"default",className:"w-auto mx-2 px-3 py-2",children:(0,s.jsxs)("div",{className:"text-xs text-foreground-light",children:["Your organization has a log retention period of"," ",(0,s.jsxs)("span",{className:"text-brand",children:[H," day",H>1?"s":""]}),". You may only view logs from"," ",x()().subtract(H,"days").format("DD MMM YYYY")," as the earliest date."]})})}),L&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-[20px] border-r border-strong !ml-4 !mr-2"}),(0,s.jsxs)("p",{className:"prose text-xs",children:["Viewing ",Y.length," logs in total"]})]})]}),(0,s.jsx)(F.$,{type:"default",disabled:D||z,icon:(0,s.jsx)(sz.A,{className:z?"animate-spin":""}),onClick:()=>U(),children:z?"Refreshing":"Refresh"})]}),0===V.length?(0,s.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,s.jsx)("p",{className:"prose text-sm",children:"Your organization does not have any audit logs available yet"})}):V.length>0&&0===Y.length?(0,s.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,s.jsx)("p",{className:"prose text-sm",children:"No audit logs found based on the filters applied"})}):(0,s.jsx)(N.A,{head:[(0,s.jsx)(N.A.th,{className:"py-2",children:"User"},"user"),(0,s.jsx)(N.A.th,{className:"py-2",children:"Action"},"action"),(0,s.jsx)(N.A.th,{className:"py-2",children:"Target"},"target"),(0,s.jsx)(N.A.th,{className:"py-2",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{children:"Date"}),(0,s.jsx)(A.G,{type:"text",className:"px-1",icon:y?(0,s.jsx)(sF.A,{strokeWidth:1.5,size:14}):(0,s.jsx)(sU.A,{strokeWidth:1.5,size:14}),onClick:()=>f(!y),tooltip:{content:{side:"bottom",text:y?"Sort latest first":"Sort earliest first"}}})]})},"date"),(0,s.jsx)(N.A.th,{className:"py-2"},"actions")],body:null!=(d=null==Y?void 0:Y.map(e=>{var t,a,n,r,l,i,o,d,c;let u=(null!=R?R:[]).find(t=>t.gotrue_id===e.actor.id),m=G.find(e=>{var t;return(null==u||null==(t=u.role_ids)?void 0:t[0])===e.id}),p=null==E?void 0:E.find(t=>t.ref===e.target.metadata.project_ref),h=null==T?void 0:T.find(t=>t.slug===e.target.metadata.org_slug),g=(null==(t=e.action.metadata[0])?void 0:t.status)!==void 0,y=void 0===u?(0,s.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,s.jsx)("p",{children:"?"})}):(null==u?void 0:u.invited_id)||(null==u?void 0:u.username)===(null==u?void 0:u.primary_email)?(0,s.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,s.jsx)(sB.A,{size:18,strokeWidth:2})}):(0,s.jsx)(sH(),{alt:null==u?void 0:u.username,src:"https://github.com/".concat(null!=(a=null==u?void 0:u.username)?a:"",".png?size=80"),width:"30",height:"30",className:"border rounded-full"});return(0,s.jsxs)(N.A.tr,{onClick:()=>w(e),className:"cursor-pointer hover:!bg-alternative transition duration-100",children:[(0,s.jsx)(N.A.td,{children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{children:y}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-foreground-light",children:null!=(n=null==u?void 0:u.username)?n:"-"}),m&&(0,s.jsx)("p",{className:"mt-0.5 text-xs text-foreground-light",children:null==m?void 0:m.name})]})]})}),(0,s.jsx)(N.A.td,{className:"max-w-[250px]",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[g&&(0,s.jsx)("p",{className:"bg-surface-200 rounded px-1 flex items-center justify-center text-xs font-mono border",children:e.action.metadata[0].status}),(0,s.jsx)("p",{className:"truncate",title:e.action.name,children:e.action.name})]})}),(0,s.jsxs)(N.A.td,{children:[(0,s.jsxs)("p",{className:"text-foreground-light max-w-[230px] truncate",title:null!=(l=null!=(r=null==p?void 0:p.name)?r:null==h?void 0:h.name)?l:"-",children:[(null==p?void 0:p.name)?"Project: ":(null==h?void 0:h.name)?"Organization: ":null,null!=(o=null!=(i=null==p?void 0:p.name)?i:null==h?void 0:h.name)?o:"Unknown"]}),(0,s.jsxs)("p",{className:"text-foreground-light text-xs mt-0.5 truncate",title:null!=(d=e.target.metadata.project_ref)?d:e.target.metadata.org_slug,children:[e.target.metadata.project_ref?"Ref: ":e.target.metadata.org_slug?"Slug: ":null,null!=(c=e.target.metadata.project_ref)?c:e.target.metadata.org_slug]})]}),(0,s.jsx)(N.A.td,{children:x()(e.occurred_at).format("DD MMM YYYY, HH:mm:ss")}),(0,s.jsx)(N.A.td,{align:"right",children:(0,s.jsx)(F.$,{type:"default",children:"View details"})})]},e.occurred_at)}))?d:[]})]})]})}),(0,s.jsx)(sV.f,{selectedLog:b,onClose:()=>w(void 0),"data-sentry-element":"LogDetailsPanel","data-sentry-source-file":"AuditLogs.tsx"})]}):(0,s.jsx)(r.Vw,{children:(0,s.jsx)(u.A,{resourceText:"view organization audit logs"})})};var s1=a(2081),s4=a(10951),s3=a(78266);async function s5(e,t){let{slug:a}=e;if(!a)throw Error("Organization slug is required");let{data:s,error:n}=await (0,_.Jt)("/platform/organizations/{slug}/oauth/apps",{params:{path:{slug:a},query:{type:"published"}}});return n&&(0,_.H4)(n),s}let s6=function(e){let{slug:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(s3.R.oauthApps(t),e=>{let{signal:a}=e;return s5({slug:t},a)},{enabled:a&&void 0!==t,...s})};var s8=a(94328),s9=a(47781);let s7=e=>{var t;let{app:a,onSelectRevoke:n}=e;return(0,s.jsxs)(N.A.tr,{"data-sentry-element":"unknown","data-sentry-component":"AuthorizedAppRow","data-sentry-source-file":"AuthorizedAppRow.tsx",children:[(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:(0,s.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:a.icon?"url('".concat(a.icon,"')"):"none"},children:a.icon?"":"".concat(a.name[0])})}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:a.name}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:a.created_by}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)("p",{className:"font-mono truncate",title:a.app_id,children:a.app_id}),(0,s.jsx)(s1.A,{iconOnly:!0,type:"default",text:a.app_id,className:"px-1","data-sentry-element":"CopyButton","data-sentry-source-file":"AuthorizedAppRow.tsx"})]})}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:(0,s.jsx)(s9.T,{utcTimestamp:null!=(t=a.authorized_at)?t:"",labelFormat:"DD/MM/YYYY, HH:mm:ss",className:"text-sm","data-sentry-element":"TimestampInfo","data-sentry-source-file":"AuthorizedAppRow.tsx"})}),(0,s.jsx)(N.A.td,{align:"right","data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:(0,s.jsx)(F.$,{type:"default",icon:(0,s.jsx)(s8.A,{}),className:"px-1",onClick:()=>n(),"data-sentry-element":"Button","data-sentry-source-file":"AuthorizedAppRow.tsx"})})]})};var ne=a(26629);async function nt(e){let{id:t,slug:a}=e;if(!t)throw Error("OAuth app ID is required");if(!a)throw Error("Organization slug is required");let{data:s,error:n}=await (0,_.yH)("/platform/organizations/{slug}/oauth/apps/{id}",{params:{path:{slug:a,id:t}}});return n&&(0,_.H4)(n),s}let na=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>nt(e),{async onSuccess(t,a,n){let{slug:r}=a;await s.invalidateQueries(s3.R.oauthApps(r)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to delete application: ".concat(e.message)):t(e,a,s)},...a})},ns=e=>{let{selectedApp:t,onClose:a}=e,{slug:n}=(0,$.g)(),{mutate:r,isLoading:l}=na({onSuccess:()=>{g.oR.success('Successfully deleted the app "'.concat(null==t?void 0:t.name,'"')),a()}}),i=async()=>n?(null==t?void 0:t.id)?void r({slug:n,id:null==t?void 0:t.id}):console.error("App ID is required"):console.error("Slug is required");return(0,s.jsxs)(tn.A,{size:"medium",alignFooter:"right",header:"Confirm to delete ".concat(null==t?void 0:t.name),visible:void 0!==t,loading:l,onCancel:a,onConfirm:i,"data-sentry-element":"Modal","data-sentry-component":"DeleteAppModal","data-sentry-source-file":"DeleteAppModal.tsx",children:[(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DeleteAppModal.tsx",children:(0,s.jsx)(tk.Z,{type:"warning",title:"This action cannot be undone",description:"Deleting ".concat(null==t?void 0:t.name," will invalidate any access tokens from this application that\n          were authorized by users."),"data-sentry-element":"Admonition","data-sentry-source-file":"DeleteAppModal.tsx"})}),(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DeleteAppModal.tsx",children:(0,s.jsx)("ul",{className:"space-y-5",children:(0,s.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,s.jsx)(ne.A,{size:14,className:"flex-shrink-0","data-sentry-element":"Lock","data-sentry-source-file":"DeleteAppModal.tsx"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Before you remove this application, consider:"}),(0,s.jsx)("ul",{className:"space-y-2 mt-2",children:(0,s.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. It will no longer be available for use after deletion."})})]})]})})})]})};var nn=a(78086),nr=a(12015);let nl=e=>{var t,a;let{app:n,onSelectEdit:r,onSelectDelete:l}=e,i=(0,m.SE)(c.aG.UPDATE,"approved_oauth_apps"),o=(0,m.SE)(c.aG.DELETE,"approved_oauth_apps");return(0,s.jsxs)(N.A.tr,{"data-sentry-element":"unknown","data-sentry-component":"OAuthAppRow","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,s.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:n.icon?"url('".concat(n.icon,"')"):"none"},children:n.icon?"":"".concat(n.name[0])})}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,s.jsx)("p",{title:n.name,className:"truncate",children:n.name})}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)("p",{className:"font-mono truncate",title:n.client_id,children:n.client_id}),(0,s.jsx)(s1.A,{type:"default",iconOnly:!0,text:null!=(t=n.client_id)?t:"",className:"px-1","data-sentry-element":"CopyButton","data-sentry-source-file":"OAuthAppRow.tsx"})]})}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,s.jsx)(s9.T,{utcTimestamp:null!=(a=n.created_at)?a:"",labelFormat:"DD/MM/YYYY, HH:mm:ss",className:"text-sm","data-sentry-element":"TimestampInfo","data-sentry-source-file":"OAuthAppRow.tsx"})}),(0,s.jsx)(N.A.td,{align:"right","data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,s.jsxs)(tI.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,s.jsx)(tI.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,s.jsx)(F.$,{type:"default",icon:(0,s.jsx)(nn.A,{}),className:"px-1","data-sentry-element":"Button","data-sentry-source-file":"OAuthAppRow.tsx"})}),(0,s.jsxs)(tI.SQ,{align:"end",side:"bottom",className:"w-32","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,s.jsxs)(y.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,s.jsx)(y.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,s.jsxs)(tI._2,{disabled:!i,className:"space-x-2 !pointer-events-auto",onClick:()=>{i&&r()},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,s.jsx)(nr.A,{size:16,"data-sentry-element":"Edit","data-sentry-source-file":"OAuthAppRow.tsx"}),(0,s.jsx)("p",{children:"Edit app"})]},"edit")}),!i&&(0,s.jsx)(y.ZI,{side:"left",children:"You need additional permissions to edit apps"})]}),(0,s.jsx)(tI.mB,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"OAuthAppRow.tsx"}),(0,s.jsxs)(y.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,s.jsx)(y.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,s.jsxs)(tI._2,{disabled:!o,className:"space-x-2 !pointer-events-auto",onClick:()=>{o&&l()},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,s.jsx)(s8.A,{size:16,"data-sentry-element":"Trash","data-sentry-source-file":"OAuthAppRow.tsx"}),(0,s.jsx)("p",{children:"Delete app"})]},"delete")}),!o&&(0,s.jsx)(y.ZI,{side:"left",children:"You need additional permissions to delete apps"})]})]})]})})]})};var ni=a(97823);async function no(e){let{slug:t,name:a,website:s,icon:n,scopes:r,redirect_uris:l}=e,{data:i,error:o}=await (0,_.bE)("/platform/organizations/{slug}/oauth/apps",{params:{path:{slug:t}},body:{name:a,website:s,icon:n,scopes:r,redirect_uris:l}});return o&&(0,_.H4)(o),i}let nd=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>no(e),{async onSuccess(t,a,n){let{slug:r}=a;await s.invalidateQueries(s3.R.oauthApps(r)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to create OAuth application: ".concat(e.message)):t(e,a,s)},...a})};async function nc(e){let{id:t,slug:a,name:s,website:n,icon:r,scopes:l,redirect_uris:i}=e;if(!t)throw Error("OAuth app ID is required");if(!a)throw Error("Organization slug is required");if(!s)throw Error("OAuth app name is required");if(!n)throw Error("OAuth app URL is required");if(!i||0===i.length)throw Error("Redirect URIs are required");let{data:o,error:d}=await (0,_.yJ)("/platform/organizations/{slug}/oauth/apps/{id}",{params:{path:{id:t,slug:a}},body:{name:s,website:n,icon:r,scopes:l,redirect_uris:i}});if(d)throw(0,_.H4)(d);return o}let nu=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>nc(e),{async onSuccess(t,a,n){let{slug:r}=a;await s.invalidateQueries(s3.R.oauthApps(r)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to update application: ".concat(e.message)):t(e,a,s)},...a})};var nm=a(82147);let np=async function(e,t,a){let s=!(arguments.length>3)||void 0===arguments[3]||arguments[3],n=(0,nm.UU)("https://obuldanrptloktxcffvn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9idWxkYW5ycHRsb2t0eGNmZnZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTg2MTQ2ODUsImV4cCI6MjAzNDE5MDY4NX0.NFt49g6DFkc1X5khCzN5p01iAVo2TMxlx88cY1V0E2M",{auth:{persistSession:!1,autoRefreshToken:!1,multiTab:!1,detectSessionInUrl:!1,localStorage:{getItem:e=>void 0,setItem:(e,t)=>{},removeItem:e=>{}}}}),{data:r,error:l}=await n.storage.from(e).upload(t,a,{cacheControl:"3600"});if(l)return void console.error("Failed to upload:",l);if(r&&s){let{data:t}=await n.storage.from(e).getPublicUrl(r.path);return null==t?void 0:t.publicUrl}};var nx=a(79989),nh=a(59129);let ng={list:(e,t)=>["organizations",e,"oauth","apps",t,"client-secrets"]};async function ny(e){let{slug:t,appId:a}=e,{data:s,error:n}=await (0,_.bE)("/platform/organizations/{slug}/oauth/apps/{app_id}/client-secrets",{params:{path:{slug:t,app_id:a}}});return n&&(0,_.H4)(n),s}let nf=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>ny(e),{async onSuccess(t,a,n){let{slug:r,appId:l}=a;await s.invalidateQueries(ng.list(r,l)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to create client secret: ".concat(e.message)):t(e,a,s)},...a})};async function nj(e,t){let{slug:a,appId:s}=e;if(!a)throw Error("slug is required");if(!s)throw Error("appId is required");let{data:n,error:r}=await (0,_.Jt)("/platform/organizations/{slug}/oauth/apps/{app_id}/client-secrets",{params:{path:{slug:a,app_id:s}},signal:t});return r&&(0,_.H4)(r),n}let nv=function(e){let{slug:t,appId:a}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,E.I)(ng.list(t,a),e=>{let{signal:s}=e;return nj({slug:t,appId:a},s)},{enabled:s&&void 0!==t&&void 0!==a,...n})};var nb=a(20333);async function nN(e){let{slug:t,appId:a,secretId:s}=e,{error:n}=await (0,_.yH)("/platform/organizations/{slug}/oauth/apps/{app_id}/client-secrets/{secret_id}",{params:{path:{slug:t,app_id:a,secret_id:s}}});return n&&(0,_.H4)(n),!0}let nS=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>nN(e),{async onSuccess(t,a,n){let{slug:r,appId:l}=a;await s.invalidateQueries(ng.list(r,l)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to delete client secret: ".concat(e.message)):t(e,a,s)},...a})},nA=e=>{var t,a,n;let{secret:r,appId:l}=e,{slug:i}=(0,$.g)(),[d,u]=(0,h.useState)(!1),p=(0,m.SE)(c.aG.UPDATE,"oauth_apps"),{data:y}=nv({slug:i,appId:l}),f=1===(null!=(t=null==y?void 0:y.client_secrets)?t:[]).length,{data:j=[]}=(0,sX.Q)({slug:i}),v=j.find(e=>e.gotrue_id===r.created_by),b=null!=(n=null!=(a=null==v?void 0:v.username)?a:null==v?void 0:v.primary_email)?n:r.created_by,{mutate:N,isLoading:S}=nS({onSuccess:()=>{g.oR.success("Successfully deleted client secret"),u(!1)}}),w=void 0!==r.client_secret;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,o.cn)("flex items-center justify-between p-4 border first:rounded-t last:rounded-b",w&&"bg-background-alternative"),children:[(0,s.jsxs)("div",{className:"flex flex-row gap-6 items-center",children:[(0,s.jsx)(nb.A,{size:16,strokeWidth:2,"data-sentry-element":"Key","data-sentry-source-file":"SecretRow.tsx"}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[w&&(0,s.jsx)(tU.A,{size:14,className:"text-brand",strokeWidth:3}),(0,s.jsx)("p",{className:"font-mono text-sm",children:w?r.client_secret:"".concat(r.client_secret_alias).concat("*".repeat(36))}),w&&r.client_secret&&(0,s.jsx)(s1.A,{text:r.client_secret,type:"default",iconOnly:!0})]})}),(0,s.jsx)("div",{className:"flex flex-col gap-0",children:(0,s.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Added ",w?"now":x()(r.created_at).fromNow()," by ",b]})})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(A.G,{type:"default",className:"w-7",icon:(0,s.jsx)(s8.A,{}),disabled:!l||!p||f,onClick:()=>u(!0),tooltip:{content:{className:"w-64 text-center",side:"bottom",text:p?f?"You must have at least one client secret for the OAuth application to function.":void 0:"You need additional permissions to delete client secrets"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"SecretRow.tsx"})})]}),(0,s.jsx)(a6.A,{visible:d,variant:"destructive",title:"Confirm to delete client secret",confirmLabel:"Delete",confirmLabelLoading:"Deleting",loading:S,onCancel:()=>u(!1),onConfirm:()=>i?l?void N({slug:i,appId:l,secretId:r.id}):console.error("App ID is required"):console.error("Slug is required"),disabled:f,alert:{title:"This action cannot be undone",description:"The client secret will be permanently removed and cannot be recovered."},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"SecretRow.tsx",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:f?"The last client secret cannot be deleted. Please generate a new secret before deleting this one.":"Are you sure you want to delete this client secret?"})})]})},nw=e=>{var t;let{selectedApp:a}=e,{slug:n}=(0,$.g)(),[r,l]=(0,h.useState)(),i=(0,m.SE)(c.aG.UPDATE,"oauth_apps"),{id:o}=null!=a?a:{},{data:d}=nv({slug:n,appId:o}),u=null!=(t=null==d?void 0:d.client_secrets)?t:[],{mutate:p,isLoading:x}=nf({onSuccess:e=>l(e)});return(0,s.jsxs)("div",{className:"flex flex-col gap-4","data-sentry-component":"OAuthSecrets","data-sentry-source-file":"OAuthSecrets.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Client secrets"}),(0,s.jsxs)("span",{className:"text-sm text-foreground-light",children:["For handling callbacks in the OAuth 2.0 flow. Learn more"," ",(0,s.jsx)(nh.g,{href:"https://supabase.com/docs/guides/integrations/build-a-supabase-integration#handling-the-callback","data-sentry-element":"InlineLink","data-sentry-source-file":"OAuthSecrets.tsx",children:"here"}),"."]})]}),i&&(0,s.jsx)(A.G,{type:"default",disabled:!o||u.length>=5,onClick:()=>n?o?void p({slug:n,appId:o}):console.error("App ID is required"):console.error("Slug is required"),loading:x,tooltip:{content:{side:"bottom",text:u.length>=5?"You can only have up to 5 client secrets":void 0}},children:"Generate new secret"})]}),r&&(0,s.jsxs)(ta.Fc,{variant:"default",children:[(0,s.jsx)(tL.mo,{}),(0,s.jsx)(ta.XL,{children:"Make sure to copy your new client secret now. You won't be able to see it again."})]}),(0,s.jsx)("div",{className:"-space-y-px",children:u.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>{let t=(null==r?void 0:r.id)===e.id?{...e,client_secret:r.client_secret}:e;return(0,s.jsx)(nA,{secret:t,appId:o},e.id)})})]})};var n_=a(68656);let nC=e=>{let{children:t,scopeName:a,scopes:n,onChange:r}=e;return(0,s.jsx)(tI.hO,{checked:n.includes(a),onCheckedChange:e=>{e?r([...n,a]):r([...n.filter(e=>e!==a)])},"data-sentry-element":"DropdownMenuCheckboxItem","data-sentry-component":"ScopeDropdownCheckboxItem","data-sentry-source-file":"Scopes.tsx",children:t})},nI=e=>{let{title:t,description:a,readScopeName:n,writeScopeName:r,scopes:l,setScopes:i}=e,o="Access: No access";return l.includes(n)&&(o="Access: Read-only"),l.includes(r)&&(o="Access: Write-only"),l.includes(n)&&l.includes(r)&&(o="Access: Read and write"),(0,s.jsxs)("div",{className:"flex flex-row justify-between p-4 border first:rounded-t last:rounded-b","data-sentry-component":"Scope","data-sentry-source-file":"Scopes.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-foreground text-sm",children:t}),(0,s.jsx)("span",{className:"text-foreground-light text-xs",children:a})]}),(0,s.jsxs)(tI.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"Scopes.tsx",children:[(0,s.jsx)(tI.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"Scopes.tsx",children:(0,s.jsx)(F.$,{type:"default",iconRight:(0,s.jsx)(n_.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"Scopes.tsx",children:(0,s.jsx)("p",{children:o})})}),(0,s.jsxs)(tI.SQ,{align:"end",className:"w-40","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"Scopes.tsx",children:[(0,s.jsx)(tI.lp,{"data-sentry-element":"DropdownMenuLabel","data-sentry-source-file":"Scopes.tsx",children:"Select an access level"}),(0,s.jsx)(tI.mB,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nC,{scopeName:n,scopes:l,onChange:i,"data-sentry-element":"ScopeDropdownCheckboxItem","data-sentry-source-file":"Scopes.tsx",children:"Read"}),(0,s.jsx)(nC,{scopeName:r,scopes:l,onChange:i,"data-sentry-element":"ScopeDropdownCheckboxItem","data-sentry-source-file":"Scopes.tsx",children:"Write"})]})]})]},t)},nE=e=>{let{scopes:t,setScopes:a}=e;return(0,s.jsxs)("div",{className:"-space-y-px","data-sentry-component":"ScopesPanel","data-sentry-source-file":"Scopes.tsx",children:[(0,s.jsx)(nI,{title:"Analytics",description:"Analytics logs.",readScopeName:c.gx.ANALYTICS_READ,writeScopeName:c.gx.ANALYTICS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Auth",description:"Auth configurations and SSO providers.",readScopeName:c.gx.AUTH_READ,writeScopeName:c.gx.AUTH_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Database",description:"Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",readScopeName:c.gx.DATABASE_READ,writeScopeName:c.gx.DATABASE_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Domains",description:"Custom domains and vanity subdomains.",readScopeName:c.gx.DOMAINS_READ,writeScopeName:c.gx.DOMAINS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Edge Functions",description:"Edge functions.",readScopeName:c.gx.EDGE_FUNCTIONS_READ,writeScopeName:c.gx.EDGE_FUNCTIONS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Environment",description:"Environments/branches.",readScopeName:c.gx.ENVIRONMENT_READ,writeScopeName:c.gx.ENVIRONMENT_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Organizations",description:"Organizations and all its members.",readScopeName:c.gx.ORGANIZATIONS_READ,writeScopeName:c.gx.ORGANIZATIONS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Projects",description:"Metadata, upgrade status, network restrictions and network bans.",readScopeName:c.gx.PROJECTS_READ,writeScopeName:c.gx.PROJECTS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"REST",description:"PostgREST configurations.",readScopeName:c.gx.REST_READ,writeScopeName:c.gx.REST_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Secrets",description:"API keys, secrets and pgsodium configurations.",readScopeName:c.gx.SECRETS_READ,writeScopeName:c.gx.SECRETS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,s.jsx)(nI,{title:"Storage",description:"Storage buckets and files.",readScopeName:c.gx.STORAGE_READ,writeScopeName:c.gx.STORAGE_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"})]})},nT=e=>{let{visible:t,selectedApp:a,onClose:n,onCreateSuccess:r}=e,{slug:l}=(0,$.g)(),i=(0,h.useRef)(),{mutate:d}=nd({onSuccess:(e,t)=>{g.oR.success('Successfully created OAuth app "'.concat(t.name,'"!')),n(),r(e),m(!1)},onError:e=>{g.oR.error("Failed to create OAuth application: ".concat(e.message)),m(!1)}}),{mutate:c}=nu({onSuccess:(e,t)=>{g.oR.success('Successfully updated OAuth app "'.concat(t.name,'"!')),n(),m(!1)},onError:e=>{g.oR.error("Failed to update OAuth application: ".concat(e.message)),m(!1)}}),[u,m]=(0,h.useState)(!1),[p,x]=(0,h.useState)(!1),[y,j]=(0,h.useState)(),[v,b]=(0,h.useState)(),[N,S]=(0,h.useState)({}),[A,w]=(0,h.useState)([{id:(0,P.gZ)(),value:""}]),[_,C]=(0,h.useState)([]);(0,h.useEffect)(()=>{if(t)if(S({}),m(!1),j(void 0),void 0!==a){var e,s,n;w(null!=(s=null==(e=a.redirect_uris)?void 0:e.map(e=>({id:(0,P.gZ)(),value:e})))?s:[]),C(null!=(n=null==a?void 0:a.scopes)?n:[]),b(null===a.icon?void 0:a.icon)}else w([{id:(0,P.gZ)(),value:""}]),C([]),b(void 0)},[t,a]);let I=(e,t)=>{w(A.map(a=>a.id===e?{id:e,value:t}:a)),S({})},E=e=>{w(A.filter(t=>t.id!==e))},T=async e=>{e.persist();let[t]=e.target.files||e.dataTransfer.items;j(t),b(URL.createObjectURL(t)),e.target.value=""},R=async e=>{if(!l)return console.error("Slug is required");let t=A.filter(e=>e.value.length>0).map(e=>e.value);if(0===t.length)return void S({urls:"Please provide at least one URL"});S({}),m(!0);let{name:s,website:n}=e,r=void 0!==y?await np("oauth-app-icons","".concat(l,"/").concat((0,P.gZ)(),".png"),y):v;void 0===a?d({slug:l,name:s,website:n,redirect_uris:t,scopes:_,icon:r}):c({id:a.id,slug:l,name:s,website:n,redirect_uris:t,scopes:_,icon:r})};return(0,s.jsx)(eQ.Ay,{hideFooter:!0,size:"large",visible:t,header:void 0!==a?"Update OAuth application":"Publish a new OAuth application",onCancel:()=>n(),"data-sentry-element":"SidePanel","data-sentry-component":"PublishAppSidePanel","data-sentry-source-file":"index.tsx",children:(0,s.jsx)(en.A,{validateOnBlur:!0,className:"h-full",initialValues:{name:"",website:""},validate:e=>{let t={};return e.name||(t.name="Please provide a name for your application"),e.website||(t.website="Please provide a URL for your site"),(0,P.U8)(e.website)||(t.website="Please provide a valid URL for your site"),t},onSubmit:R,"data-sentry-element":"Form","data-sentry-source-file":"index.tsx",children:e=>{let{resetForm:r,values:l}=e;return(0,h.useEffect)(()=>{if(t&&void 0!==a){let e={name:a.name,website:a.website};r({values:e,initialValues:e})}},[t,a]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsx)(eQ.Ay.Content,{children:(0,s.jsxs)("div",{className:"py-4 flex items-start justify-between gap-10",children:[(0,s.jsxs)("div",{className:"space-y-4 w-full",children:[(0,s.jsx)(er.A,{id:"name",label:"Application name",descriptionText:(null==a?void 0:a.id)&&"ID: ".concat(a.id)}),(0,s.jsx)(er.A,{id:"website",label:"Website URL",placeholder:"https://my-website.com"})]}),(0,s.jsxs)("div",{children:[void 0!==v?(0,s.jsx)("div",{className:(0,o.cn)("shadow transition group relative","bg-center bg-cover bg-no-repeat","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center"),style:{backgroundImage:v?'url("'.concat(v,'")'):"none"},children:(0,s.jsx)("div",{className:"absolute bottom-1 right-1",children:(0,s.jsxs)(tI.rI,{children:[(0,s.jsx)(tI.ty,{asChild:!0,children:(0,s.jsx)(F.$,{type:"default",className:"px-1",children:(0,s.jsx)(nr.A,{})})}),(0,s.jsxs)(tI.SQ,{align:"end",side:"bottom",children:[(0,s.jsx)(tI._2,{onClick:()=>{i.current&&i.current.click()},children:(0,s.jsx)("p",{children:"Upload image"})},"upload"),(0,s.jsx)(tI._2,{onClick:()=>{j(void 0),b(void 0)},children:(0,s.jsx)("p",{children:"Remove image"})},"remove")]})]})})}):(0,s.jsxs)("div",{className:(0,o.cn)("border border-strong transition opacity-75 hover:opacity-100","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center cursor-pointer"),onClick:()=>{i.current&&i.current.click()},children:[(0,s.jsx)(ni.A,{size:18,strokeWidth:1.5,className:"text-foreground"}),(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Upload logo"})]}),(0,s.jsx)("input",{multiple:!0,type:"file",ref:i,className:"hidden",accept:"image/png, image/jpeg",onChange:T})]})]})}),(0,s.jsx)(eQ.Ay.Separator,{}),(0,s.jsxs)(eQ.Ay.Content,{className:"py-4",children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-foreground text-sm",children:"Authorization callback URLs"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"All URLs must use HTTPS, except for localhost"})]}),(0,s.jsx)(F.$,{type:"default",onClick:()=>w(A.concat({id:(0,P.gZ)(),value:""})),children:"Add URL"})]}),(0,s.jsxs)("div",{className:"space-y-2 pb-2",children:[A.map(e=>(0,s.jsx)(er.A,{value:e.value,onChange:t=>I(e.id,t.target.value),placeholder:"e.g https://my-website.com",actions:[A.length>1?(0,s.jsx)(F.$,{type:"default",onClick:()=>E(e.id),children:"Remove"},"remove-url"):null]},e.id)),N.urls&&(0,s.jsx)("p",{className:"text-red-900 text-sm",children:N.urls})]})]}),void 0!==a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eQ.Ay.Separator,{}),(0,s.jsx)(eQ.Ay.Content,{className:"py-4",children:(0,s.jsx)(nw,{selectedApp:a})})]}),(0,s.jsx)(eQ.Ay.Separator,{}),(0,s.jsxs)("div",{className:"p-6 ",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between space-x-4 pb-4",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Application permissions"}),(0,s.jsx)("span",{className:"text-sm text-foreground-light",children:"The application permissions are organized in scopes and will be presented to the user when adding an app to their organization and all of its projects."})]}),(0,s.jsx)(a0.A,{href:"https://supabase.com/docs/guides/platform/oauth-apps/oauth-scopes"})]}),(0,s.jsx)(nE,{scopes:_,setScopes:C})]})]}),(0,s.jsx)(eQ.Ay.Separator,{}),(0,s.jsx)(eQ.Ay.Content,{children:(0,s.jsxs)("div",{className:"pt-2 pb-3 flex items-center justify-between",children:[(0,s.jsx)(F.$,{type:"default",onClick:()=>x(!0),disabled:0===l.name.length||0===l.website.length,children:"Preview consent for users"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(F.$,{type:"default",disabled:u,onClick:()=>n(),children:"Cancel"}),(0,s.jsx)(F.$,{htmlType:"submit",loading:u,disabled:u,children:"Confirm"})]})]})})]}),(0,s.jsxs)(tn.A,{hideFooter:!0,className:"!max-w-[600px]",visible:p,onCancel:()=>x(!1),children:[(0,s.jsx)(tn.A.Content,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("p",{children:["Authorize API access for ",l.name]}),(0,s.jsx)(f.E,{variant:"brand",children:"Preview"})]})}),(0,s.jsx)(tn.A.Separator,{}),(0,s.jsxs)(tn.A.Content,{children:[(0,s.jsx)(nx.A,{icon:v||null,name:l.name,domain:l.website,scopes:_}),(0,s.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,s.jsx)("p",{className:"prose text-sm",children:"Select an organization to grant API access to"}),(0,s.jsx)("div",{className:"border border-control text-foreground-light rounded px-4 py-2 text-sm bg-surface-200",children:"Organizations that you have access to will be listed here"})]})]}),(0,s.jsx)(tn.A.Separator,{}),(0,s.jsx)(tn.A.Content,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"prose text-xs",children:"This is what your users will see when authorizing with your app"}),(0,s.jsx)(F.$,{type:"default",onClick:()=>x(!1),children:"Close"})]})})]})]})}})})};async function nR(e){let{id:t,slug:a}=e;if(!t)throw Error("App ID is required");if(!a)throw Error("Organization slug is required");let{data:s,error:n}=await (0,_.bE)("/platform/organizations/{slug}/oauth/apps/{id}/revoke",{params:{path:{slug:a,id:t}}});return n&&(0,_.H4)(n),s}let nk=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>nR(e),{async onSuccess(t,a,n){let{slug:r}=a;await s.invalidateQueries(s3.R.authorizedApps(r)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to revoke application: ".concat(e.message)):t(e,a,s)},...a})},nM=e=>{let{selectedApp:t,onClose:a}=e,{slug:n}=(0,$.g)(),{mutate:r,isLoading:l}=nk({onSuccess:()=>{g.oR.success('Successfully revoked the app "'.concat(null==t?void 0:t.name,'"')),a()}}),i=async()=>n?(null==t?void 0:t.id)?void r({slug:n,id:null==t?void 0:t.id}):console.error("App ID is required"):console.error("Slug is required");return(0,s.jsxs)(tn.A,{size:"medium",alignFooter:"right",header:"Confirm to revoke ".concat(null==t?void 0:t.name),visible:void 0!==t,loading:l,onCancel:a,onConfirm:i,"data-sentry-element":"Modal","data-sentry-component":"RevokeAppModal","data-sentry-source-file":"RevokeAppModal.tsx",children:[(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"RevokeAppModal.tsx",children:(0,s.jsx)(tk.Z,{type:"warning",title:"This action cannot be undone",description:"".concat(null==t?void 0:t.name," application will no longer have access to your organization's settings\n          and projects."),"data-sentry-element":"Admonition","data-sentry-source-file":"RevokeAppModal.tsx"})}),(0,s.jsx)(tn.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"RevokeAppModal.tsx",children:(0,s.jsx)("ul",{className:"space-y-5",children:(0,s.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,s.jsx)(ne.A,{size:14,className:"flex-shrink-0","data-sentry-element":"Lock","data-sentry-source-file":"RevokeAppModal.tsx"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Before you remove this app, consider:"}),(0,s.jsx)("ul",{className:"space-y-2 mt-2",children:(0,s.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. The application will no longer have access to your organization after being revoked."})})]})]})})})]})},nP=()=>{var e,t,a,n;let{slug:l}=(0,$.g)(),[i,d]=(0,h.useState)(!1),[p,x]=(0,h.useState)(),[g,y]=(0,h.useState)(),[f,j]=(0,h.useState)(),[v,b]=(0,h.useState)(),w=(0,m.SE)(c.aG.READ,"approved_oauth_apps"),_=(0,m.SE)(c.aG.CREATE,"approved_oauth_apps"),{data:C,error:I,isLoading:E,isSuccess:T,isError:R}=s6({slug:l},{enabled:w}),k=null==C?void 0:C.sort((e,t)=>{var a,s;return Number(new Date(null!=(a=e.created_at)?a:""))-Number(new Date(null!=(s=t.created_at)?s:""))}),{data:M,isLoading:P,isSuccess:D,isError:L}=(0,s4.n)({slug:l}),O=null==M?void 0:M.sort((e,t)=>Number(new Date(e.authorized_at))-Number(new Date(t.authorized_at)));return w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.Vw,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-source-file":"OAuthApps.tsx",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Published Apps"}),(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"Build integrations that extend Supabase's functionality"})]}),(0,s.jsx)(A.G,{disabled:!_,type:"primary",onClick:()=>d(!0),tooltip:{content:{side:"bottom",text:_?void 0:"You need additional permissions to create apps"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"OAuthApps.tsx",children:"Add application"})]}),E&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),R&&(0,s.jsx)(S.A,{error:I,subject:"Failed to retrieve published OAuth apps"}),void 0!==p&&(0,s.jsxs)("div",{className:(0,o.cn)("flex items-center justify-between p-4 px-6 border first:rounded-t last:rounded-b","bg-background-alternative","rounded"),children:[(0,s.jsx)("div",{className:"absolute top-4 right-4",children:(0,s.jsx)(F.$,{type:"text",icon:(0,s.jsx)(aS.A,{size:18}),className:"px-1",onClick:()=>x(void 0)})}),(0,s.jsxs)("div",{className:"w-full space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(tU.A,{size:14,className:"text-brand",strokeWidth:3}),(0,s.jsx)("p",{className:"text-sm",children:"You've created your new OAuth application."})]}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Ensure that you store the client secret securely - you will not be able to see it again."})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Client ID"}),(0,s.jsx)("p",{className:"font-mono text-sm",children:p.client_id}),(0,s.jsx)(s1.A,{text:p.client_id,type:"default",iconOnly:!0})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Client Secret"}),(0,s.jsx)("p",{className:"font-mono text-sm",children:p.client_secret}),(0,s.jsx)(s1.A,{text:p.client_secret,type:"default",iconOnly:!0})]})]})]})]}),T&&(0,s.jsx)(s.Fragment,{children:(null!=(e=null==C?void 0:C.length)?e:0)===0?(0,s.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between mt-4",children:(0,s.jsx)("p",{className:"prose text-sm",children:"You do not have any published applications yet"})}):(0,s.jsx)(N.A,{head:[(0,s.jsx)(N.A.th,{className:"w-[30px]"},"icon"),(0,s.jsx)(N.A.th,{children:"Name"},"name"),(0,s.jsx)(N.A.th,{children:"Client ID"},"client-id"),(0,s.jsx)(N.A.th,{children:"Created at"},"created-at"),(0,s.jsx)(N.A.th,{},"delete-action")],body:null!=(t=null==k?void 0:k.map(e=>(0,s.jsx)(nl,{app:e,onSelectEdit:()=>{d(!0),y(e)},onSelectDelete:()=>j(e)},e.id)))?t:[]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Authorized Apps"}),(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"Applications that have access to your organization's settings and projects"}),(0,s.jsxs)("div",{className:"mt-4",children:[P&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)(Q.A,{className:"w-3/4"}),(0,s.jsx)(Q.A,{className:"w-1/2"})]}),L&&(0,s.jsx)(S.A,{subject:"Failed to retrieve authorized apps"}),D&&(0,s.jsx)(s.Fragment,{children:(null!=(a=M.length)?a:0)===0?(0,s.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,s.jsx)("p",{className:"prose text-sm",children:"You do not have any authorized applications yet"})}):(0,s.jsx)(N.A,{className:"mt-4",head:[(0,s.jsx)(N.A.th,{className:"w-[30px]"},"icon"),(0,s.jsx)(N.A.th,{children:"Name"},"name"),(0,s.jsx)(N.A.th,{children:"Created by"},"created-by"),(0,s.jsx)(N.A.th,{children:"App ID"},"app-id"),(0,s.jsx)(N.A.th,{children:"Authorized at"},"authorized-at"),(0,s.jsx)(N.A.th,{},"delete-action")],body:null!=(n=null==O?void 0:O.map(e=>(0,s.jsx)(s7,{app:e,onSelectRevoke:()=>b(e)},e.id)))?n:[]})})]})]})]}),(0,s.jsx)(nT,{visible:i,selectedApp:g,onClose:()=>{y(void 0),d(!1)},onCreateSuccess:x,"data-sentry-element":"PublishAppSidePanel","data-sentry-source-file":"OAuthApps.tsx"}),(0,s.jsx)(ns,{selectedApp:f,onClose:()=>j(void 0),"data-sentry-element":"DeleteAppModal","data-sentry-source-file":"OAuthApps.tsx"}),(0,s.jsx)(nM,{selectedApp:v,onClose:()=>b(void 0),"data-sentry-element":"RevokeAppModal","data-sentry-source-file":"OAuthApps.tsx"})]}):(0,s.jsx)(r.Vw,{children:(0,s.jsx)(u.A,{resourceText:"view OAuth apps"})})};var nD=a(65842);async function nL(e){let{slug:t,gotrueId:a}=e,{data:s,error:n}=await (0,_.yH)("/platform/organizations/{slug}/members/{gotrue_id}",{params:{path:{slug:t,gotrue_id:a}}});return n&&(0,_.H4)(n),s}let nO=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>nL(e),{async onSuccess(t,a,n){let{slug:r}=a;await Promise.all([s.invalidateQueries(X.O.members(r)),s.invalidateQueries(X.O.roles(r))]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to remove member: ".concat(e.message)):t(e,a,s)},...a})};var nz=a(79448),nF=a(59168),nU=a(98667),nB=a(24059);async function nG(e){let{slug:t,email:a,roleId:s,projects:n}=e,r={email:a,role_id:s};void 0!==n&&(r.role_scoped_projects=n);let{data:l,error:i}=await (0,_.bE)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:t}},body:r});return i&&(0,_.H4)(i),l}let nH=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>nG(e),{async onSuccess(t,a,n){let{slug:r}=a;await Promise.all([s.invalidateQueries(sW.O.rolesV2(r)),s.invalidateQueries(X.O.members(r))]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to update member role: ".concat(e.message)):t(e,a,s)},...a})};var nV=a(10738),nY=a(50854),nq=a(83405);let nW=(e,t,a)=>{let{permissions:s,organizationSlug:n}=(0,m.GU)(a,e,void 0!==a&&void 0!==e),r=[],l=[];return t&&e&&t.forEach(e=>{(0,m.IT)(s,c.aG.CREATE,"auth.subject_roles",{resource:{role_id:e.id}},n)&&r.push(e.id),(0,m.IT)(s,c.aG.DELETE,"auth.subject_roles",{resource:{role_id:e.id}},n)&&l.push(e.id)}),{rolesAddable:r,rolesRemovable:l}},n$=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter(e=>{var a;let[s]=null!=(a=e.role_ids)?a:[],n=t.find(e=>e.id===s);return(null==n?void 0:n.name)==="Owner"&&!e.invited_at}).length>1},nJ=()=>{var e,t;let{slug:a}=(0,$.g)(),{profile:n}=(0,a3.xc)(),r=(0,i.a)(),{permissions:l}=(0,m.GU)(),[u,p]=(0,h.useState)(!1),[x,f]=(0,h.useState)(!1),{data:j}=(0,tW.el)(),{data:v}=(0,sX.Q)({slug:a}),{data:b,isSuccess:N}=sZ({slug:a}),S=null!=(e=null==b?void 0:b.org_scoped_roles)?e:[],A=(null!=j?j:[]).filter(e=>e.organization_id===(null==r?void 0:r.id)).sort((e,t)=>e.name.localeCompare(t.name));(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions");let w=null==r?void 0:r.plan,_=(0,d.cC)(a),C=null==v?void 0:v.find(e=>e.gotrue_id===(null==n?void 0:n.gotrue_id)),I=1===(null!=(t=null==C?void 0:C.role_ids)?t:[]).length&&S.some(e=>e.id===(null==C?void 0:C.role_ids[0])),{rolesAddable:E}=nW(null==r?void 0:r.slug,S,null!=l?l:[]),T=I&&S.some(e=>{let{id:t}=e;return(0,m.IT)(l,c.aG.CREATE,"user_invites",{resource:{role_id:t}},null==r?void 0:r.slug)}),{mutate:R,isLoading:k}=nH(),M=eE.Ik({email:eE.Yj().email("Must be a valid email address").min(1,"Email is required"),role:eE.Yj().min(1,"Role is required"),applyToOrg:eE.zM(),projectRef:eE.Yj()}),P=(0,eI.mN)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,eC.u)(M),defaultValues:{email:"",role:"",applyToOrg:!0,projectRef:""}}),{applyToOrg:D}=P.watch(),L=async e=>{if(!a)return console.error("Slug is required");if((null==n?void 0:n.id)===void 0)return console.error("Profile ID required");let t=S.find(e=>"Developer"===e.name),s=(null!=v?v:[]).find(t=>t.primary_email===e.email.toLowerCase());if(void 0!==s)if(s.invited_id)return(0,g.oR)("User has already been invited to this organization");else return(0,g.oR)("User is already in this organization");R({slug:a,email:e.email.toLowerCase(),roleId:Number(e.role),...!e.applyToOrg&&e.projectRef?{projects:[e.projectRef]}:{}},{onSuccess:()=>{var e;g.oR.success("Successfully sent invitation to new member"),p(!u),P.reset({email:"",role:null!=(e=null==t?void 0:t.id.toString())?e:"",applyToOrg:!0,projectRef:""})}})};return(0,h.useEffect)(()=>{if(N&&u){let e=S.find(e=>"Developer"===e.name);void 0!==e&&P.setValue("role",e.id.toString())}},[N,u]),(0,h.useEffect)(()=>{if(D)P.setValue("projectRef","");else{let e=null==A?void 0:A[0];void 0!==e&&P.setValue("projectRef",e.ref)}},[D]),(0,s.jsxs)(tt.lG,{open:u,onOpenChange:p,"data-sentry-element":"Dialog","data-sentry-component":"InviteMemberButton","data-sentry-source-file":"InviteMemberButton.tsx",children:[(0,s.jsx)(tt.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,s.jsxs)(y.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"InviteMemberButton.tsx",children:[(0,s.jsx)(y.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,s.jsx)(F.$,{disabled:!T,className:"pointer-events-auto flex-grow md:flex-grow-0",onClick:()=>p(!0),"data-sentry-element":"Button","data-sentry-source-file":"InviteMemberButton.tsx",children:"Invite"})}),!T&&(0,s.jsx)(y.ZI,{side:"bottom",children:"You need additional permissions to invite a member to this organization"})]})}),(0,s.jsxs)(tt.Cf,{size:"medium","data-sentry-element":"DialogContent","data-sentry-source-file":"InviteMemberButton.tsx",children:[(0,s.jsx)(tt.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,s.jsx)(tt.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"InviteMemberButton.tsx",children:"Invite a member to this organization"})}),(0,s.jsx)(tt.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"InviteMemberButton.tsx"}),(0,s.jsx)(eT.lV,{...P,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,s.jsxs)("form",{id:"organization-invitation",className:"flex flex-col gap-y-4",onSubmit:P.handleSubmit(L),children:[(0,s.jsxs)(tt.OO,{className:"flex flex-col gap-y-4 pb-2","data-sentry-element":"DialogSection","data-sentry-source-file":"InviteMemberButton.tsx",children:[_&&(0,s.jsx)(eT.zB,{name:"applyToOrg",control:P.control,render:e=>{let{field:t}=e;return(0,s.jsx)(eM.M,{layout:"flex",label:"Apply role to all projects in the organization",children:(0,s.jsx)(eT.MJ,{children:(0,s.jsx)(a5.d,{checked:t.value,onCheckedChange:e=>P.setValue("applyToOrg",e)})})})}}),(0,s.jsx)(eT.zB,{name:"role",control:P.control,render:e=>{var t,a;let{field:n}=e;return(0,s.jsx)(eM.M,{label:"Member role",children:(0,s.jsx)(eT.MJ,{children:(0,s.jsxs)(aj.l6,{value:n.value,onValueChange:e=>P.setValue("role",e),children:[(0,s.jsx)(aj.bq,{className:"text-sm capitalize",children:null!=(a=null==(t=S.find(e=>e.id===Number(n.value)))?void 0:t.name)?a:"Unknown"}),(0,s.jsx)(aj.gC,{children:(0,s.jsx)(aj.s3,{children:S.map(e=>{let t=E.includes(e.id);return(0,s.jsxs)(aj.eb,{value:e.id.toString(),className:"text-sm [&>span:nth-child(2)]:w-full [&>span:nth-child(2)]:flex [&>span:nth-child(2)]:items-center [&>span:nth-child(2)]:justify-between",disabled:!t,children:[(0,s.jsx)("span",{children:e.name}),!t&&(0,s.jsx)("span",{children:"Additional permissions required to assign role"})]},e.id)})})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"InviteMemberButton.tsx"}),!D&&(0,s.jsx)(eT.zB,{name:"projectRef",control:P.control,render:e=>{var t,a;let{field:n}=e;return(0,s.jsx)(eM.M,{label:"Select a project",description:"You can assign roles to multiple projects once the invite is accepted",children:(0,s.jsx)(eT.MJ,{children:(0,s.jsxs)(nV.AM,{open:x,onOpenChange:f,children:[(0,s.jsx)(nV.Wv,{asChild:!0,children:(0,s.jsx)(F.$,{block:!0,type:"default",role:"combobox",size:"small",className:"justify-between max-w-[470px]",iconRight:(0,s.jsx)(nU.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),children:null!=(a=null==(t=A.find(e=>e.ref===n.value))?void 0:t.name)?a:"Unknown"})}),(0,s.jsx)(nV.hl,{sameWidthAsTrigger:!0,className:"p-0",children:(0,s.jsxs)(nY.uB,{filter:(e,t)=>{let a=A.find(t=>t.ref===e),s=null==a?void 0:a.name.toLowerCase();return void 0!==s&&s.includes(t.toLowerCase())?1:+!!e.includes(t)},children:[(0,s.jsx)(nY.G7,{placeholder:"Search project..."}),(0,s.jsxs)(nY.oI,{children:[(0,s.jsx)(nY.xL,{children:"No projects found..."}),(0,s.jsx)(nY.L$,{children:(0,s.jsx)(nq.FK,{className:(0,o.cn)((A||[]).length>7&&"max-h-[210px] overflow-y-auto"),children:A.map(e=>(0,s.jsxs)(nY.h_,{value:e.ref,onSelect:e=>{P.setValue("projectRef",e),f(!1)},children:[(0,s.jsx)(tU.A,{className:(0,o.cn)("mr-2 h-4 w-4",n.value===e.ref?"opacity-100":"opacity-0")}),e.name]},e.ref))})})]})]})})]})})})}}),(0,s.jsx)(eT.zB,{name:"email",control:P.control,render:e=>{let{field:t}=e;return(0,s.jsx)(eM.M,{label:"Email address",children:(0,s.jsx)(eT.MJ,{children:(0,s.jsx)(ek.p,{autoFocus:!0,...t,autoComplete:"off",disabled:k,placeholder:"Enter email address"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"InviteMemberButton.tsx"}),(0,s.jsx)(nB.A,{defaultVisibility:!1,title:"Single Sign-on (SSO) login option available",hideCollapse:!1,description:(0,s.jsxs)("div",{className:"space-y-4 mb-1",children:[(0,s.jsx)("p",{children:"Supabase offers single sign-on (SSO) as a login option to provide additional account security for your team. This allows company administrators to enforce the use of an identity provider when logging into Supabase."}),(0,s.jsx)("p",{children:"This is only available for organizations on Team Plan or above."}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(F.$,{asChild:!0,type:"default",children:(0,s.jsx)(ec(),{href:"https://supabase.com/docs/guides/platform/sso",target:"_blank",rel:"noreferrer",children:"Learn more"})}),((null==w?void 0:w.id)==="free"||(null==w?void 0:w.id)==="pro")&&(0,s.jsx)(F.$,{asChild:!0,type:"default",children:(0,s.jsx)(ec(),{href:"/org/".concat(a,"/billing?panel=subscriptionPlan&source=inviteMemberSSO"),children:"Upgrade to Team"})})]})]}),"data-sentry-element":"InformationBox","data-sentry-source-file":"InviteMemberButton.tsx"})]}),(0,s.jsx)(tt.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"InviteMemberButton.tsx"}),(0,s.jsx)(tt.OO,{className:"pt-0","data-sentry-element":"DialogSection","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,s.jsx)(F.$,{block:!0,htmlType:"submit",loading:k,"data-sentry-element":"Button","data-sentry-source-file":"InviteMemberButton.tsx",children:"Send invitation"})})]})})]})]})};var nZ=a(58135),nK=a(87598),nQ=a(73892),nX=a(90743),n0=a(54860);function n2(e){let t=new Date(e);return!((new Date().valueOf()-t.valueOf())/1e3/60/60<24)}let n1=e=>{if(!e)return"";let{username:t,primary_email:a,invited_id:s}=e||{};return void 0!==s?a:t||""};async function n4(e){let{slug:t,id:a}=e,{error:s}=await (0,_.yH)("/platform/organizations/{slug}/members/invitations/{id}",{params:{path:{slug:t,id:a}}});return s&&(0,_.H4)(s),!0}let n3=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>n4(e),{async onSuccess(t,a,n){let{slug:r,skipInvalidation:l}=a;l||await Promise.all([s.invalidateQueries(sW.O.rolesV2(r)),s.invalidateQueries(X.O.members(r))]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to delete invitation: ".concat(e.message)):t(e,a,s)},...a})};var n5=a(84305),n6=a.n(n5),n8=a(76828);async function n9(e){let{slug:t,gotrueId:a,roleId:s,projects:n}=e,r={role_id:s};void 0!==n&&(r.role_scoped_projects=n);let{data:l,error:i}=await (0,_.F6)("/platform/organizations/{slug}/members/{gotrue_id}",{params:{path:{slug:t,gotrue_id:a}},body:r,headers:{Version:"2"}});return i&&(0,_.H4)(i),l}let n7=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>n9(e),{async onSuccess(t,a,n){let{slug:r,skipInvalidation:l}=a;l||await Promise.all([s.invalidateQueries(sW.O.rolesV2(r)),s.invalidateQueries(X.O.members(r))]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to update member role: ".concat(e.message)):t(e,a,s)},...a})};async function re(e){let{slug:t,gotrueId:a,roleId:s}=e,{data:n,error:r}=await (0,_.yH)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:t,gotrue_id:a,role_id:s.toString()}}});return r&&(0,_.H4)(r),n}let rt=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>re(e),{async onSuccess(t,a,n){let{slug:r,skipInvalidation:l}=a;l||await Promise.all([s.invalidateQueries(sW.O.rolesV2(r)),s.invalidateQueries(X.O.members(r))]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to unassign member role: ".concat(e.message)):t(e,a,s)},...a})};async function ra(e){let{slug:t,gotrueId:a,roleId:s,roleName:n,projects:r}=e,{data:l,error:i}=await (0,_.yJ)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:t,gotrue_id:a,role_id:s.toString()}},body:{name:n,role_scoped_projects:r}});return i&&(0,_.H4)(i),l}let rs=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,B.jE)();return(0,G.n)(e=>ra(e),{async onSuccess(t,a,n){let{slug:r,skipInvalidation:l}=a;l||await Promise.all([s.invalidateQueries(sW.O.rolesV2(r)),s.invalidateQueries(X.O.members(r))]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?g.oR.error("Failed to update member role: ".concat(e.message)):t(e,a,s)},...a})};var rn=a(107),rr=a.n(rn);let rl=(e,t,a)=>{let{org_scoped_roles:s,project_scoped_roles:n}=t;return e.role_ids.map(e=>{let t=s.find(t=>t.id===e);if(void 0!==t)return{ref:void 0,roleId:t.id};let r=n.find(t=>t.id===e);if(void 0!==r){var l;return(null!=(l=null==r?void 0:r.project_ids)?l:[]).map(e=>a.find(t=>t.id===e)).map(e=>({ref:null==e?void 0:e.ref,projectId:null==e?void 0:e.id,roleId:r.id,baseRoleId:r.base_role_id}))}}).filter(Boolean).flat()},ri=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,s=[],n=[],r=[];return e.forEach(e=>{let a=t.find(t=>e.ref===t.ref);void 0===a?s.push(e):a.roleId!==e.roleId&&r.push({ref:a.ref,originalRole:e.roleId,originalBaseRole:e.baseRoleId,updatedRole:a.roleId})}),t.forEach(t=>{void 0===e.find(e=>t.ref===e.ref)&&n.push(t)}),{removed:s.map(e=>{var t;return{...e,projectId:null==(t=a.find(t=>t.ref===e.ref))?void 0:t.id}}),added:n.map(e=>{var t;return{...e,projectId:null==(t=a.find(t=>t.ref===e.ref))?void 0:t.id}}),updated:r.map(e=>{var t;return{...e,projectId:null==(t=a.find(t=>t.ref===e.ref))?void 0:t.id}})}},ro=(e,t)=>{let{removed:a,added:s,updated:n}=t,r=[],l=[],i=[],o=rr()(s,"roleId"),d=rr()(a,"roleId"),c=rr()(n,"originalRole"),u=rr()(n,"updatedRole"),m=e.filter(e=>{var t;return(null!=(t=null==e?void 0:e.project_ids)?t:[]).length>0}).map(e=>e.base_role_id);return e.forEach(e=>{var t,l,m,p,x,h,g,y;let f=e.project_ids;if(null===f)return r.push(e.id);let j=f.every(e=>{let t=a.map(e=>e.projectId).some(t=>t===e),s=n.map(e=>e.projectId).some(t=>t===e);return t||s}),v=s.some(t=>t.roleId===e.base_role_id),b=n.some(t=>t.updatedRole===e.base_role_id);if(j&&!v&&!b)return r.push(e.id);let N=null!=(x=null==(t=o[e.base_role_id])?void 0:t.map(e=>e.projectId))?x:[],S=null!=(h=null==(l=d[e.id])?void 0:l.map(e=>e.projectId))?h:[],A=null!=(g=null==(m=c[e.id])?void 0:m.map(e=>e.projectId))?g:[],w=null!=(y=null==(p=u[e.base_role_id])?void 0:p.map(e=>e.projectId))?y:[],_=f.filter(e=>!S.includes(e)).filter(e=>!A.includes(e)).concat(N).concat(w);n6()(f,_)||i.push({roleId:e.id,projectIds:_.sort((e,t)=>e-t)})}),Object.keys(o).forEach(e=>{m.includes(Number(e))||l.push({roleId:Number(e),projectIds:o[e].map(e=>e.projectId).sort((e,t)=>e-t)})}),Object.keys(u).forEach(e=>{m.includes(Number(e))||l.push({roleId:Number(e),projectIds:u[e].map(e=>e.projectId).sort((e,t)=>e-t)})}),{toRemove:r.sort((e,t)=>e-t),toAssign:l,toUpdate:i}},rd=e=>{var t;let{visible:a,member:n,projectsRoleConfiguration:r,onClose:l}=e,{slug:o}=(0,$.g)(),d=(0,B.jE)(),c=(0,i.a)(),{data:u}=(0,tW.el)(),{data:m}=sZ({slug:null==c?void 0:c.slug}),[p,x]=(0,h.useState)(!1),{mutateAsync:y}=n7(),{mutateAsync:f}=rt({onError:()=>{}}),{mutateAsync:j}=rs(),v=null!=(t=null==m?void 0:m.org_scoped_roles)?t:[],{org_scoped_roles:b,project_scoped_roles:N}=null!=m?m:{org_scoped_roles:[],project_scoped_roles:[]},S=(null!=u?u:[]).filter(e=>e.organization_id===(null==c?void 0:c.id)),A=ri(void 0!==m?rl(n,m,null!=u?u:[]):[],r,null!=u?u:[]),w=async()=>{if(void 0===o)return console.error("Slug is required");x(!0);let e=n.gotrue_id,t=n.role_ids.map(e=>[...b,...N].find(t=>t.id===e)).filter(Boolean);if(1===r.length&&void 0===r[0].ref)try{await y({slug:o,gotrueId:e,roleId:r[0].roleId}),g.oR.success("Successfully updated role for ".concat(n.username)),l(!0);return}catch(e){return x(!1),g.oR.error("Failed to update role: ".concat(e.message))}let{toRemove:a,toAssign:s,toUpdate:i}=ro(t,A);try{for(let{roleId:t,projectIds:a}of s)await y({slug:o,gotrueId:e,roleId:t,projects:a.map(e=>{var t;return null==u||null==(t=u.find(t=>t.id===e))?void 0:t.ref}),skipInvalidation:!0});for(let t of a)await f({slug:o,gotrueId:e,roleId:t,skipInvalidation:!0});for(let{roleId:t,projectIds:a}of i){var c;await j({slug:o,gotrueId:e,roleId:t,roleName:null==(c=N.find(e=>e.id===t))?void 0:c.name,projects:a.map(e=>{var t;return null==u||null==(t=u.find(t=>t.id===e))?void 0:t.ref}),skipInvalidation:!0})}await Promise.all([d.invalidateQueries(sW.O.rolesV2(o)),d.invalidateQueries(X.O.members(o))]),g.oR.success("Successfully updated role for ".concat(n.username)),l(!0)}catch(e){return x(!1),g.oR.error("Failed to update role: ".concat(e.message))}};return(0,s.jsx)(a6.A,{size:"medium",visible:a,loading:p,title:"Confirm to change roles of member",confirmLabel:"Update roles",confirmLabelLoading:"Updating",onCancel:()=>l(),onConfirm:w,"data-sentry-element":"ConfirmationModal","data-sentry-component":"UpdateRolesConfirmationModal","data-sentry-source-file":"UpdateRolesConfirmationModal.tsx",children:(0,s.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["You are making the following changes to the role of"," ",(0,s.jsx)("span",{className:"text-foreground",children:n.username})," in the organization"," ",(0,s.jsx)("span",{className:"text-foreground",children:null==c?void 0:c.name}),":"]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[0!==A.removed.length&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-sm",children:["Removing ",A.removed.length," role",A.removed.length>1?"s":""," for user:"]}),(0,s.jsx)("ul",{className:"list-disc pl-6",children:A.removed.map((e,t)=>{var a,n,r;let l=null!=(a=b.find(t=>t.id===e.roleId))?a:N.find(t=>t.id===e.roleId),i=S.find(t=>t.ref===e.ref),o=(null!=(n=null==l?void 0:l.name)?n:"Unknown").split("_")[0];return(0,s.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,s.jsx)("span",{className:"text-foreground",children:o})," on"," ",(0,s.jsx)("span",{className:void 0!==i?"text-foreground":"",children:null!=(r=null==i?void 0:i.name)?r:"organization"})]},"update-".concat(t))})})]}),0!==A.added.length&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-sm",children:["Adding ",A.added.length," role",A.added.length>1?"s":""," for user:"]}),(0,s.jsx)("ul",{className:"list-disc pl-6",children:A.added.map((e,t)=>{var a;let n=v.find(t=>t.id===e.roleId),r=S.find(t=>t.ref===e.ref);return(0,s.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,s.jsx)("span",{className:"text-foreground",children:null==n?void 0:n.name})," on"," ",(0,s.jsx)("span",{className:void 0!==r?"text-foreground":"",children:null!=(a=null==r?void 0:r.name)?a:"organization"})]},"update-".concat(t))})})]}),0!==A.updated.length&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-sm",children:["Updating ",A.updated.length," role",A.updated.length>1?"s":""," for user:"]}),(0,s.jsx)("ul",{className:"list-disc pl-6",children:A.updated.map((e,t)=>{var a,n,r,l;let i=null!=(a=b.find(t=>t.id===e.originalRole))?a:N.find(t=>t.id===e.originalRole),o=b.find(t=>t.id===e.updatedRole),d=S.find(t=>t.ref===e.ref),c=(null!=(n=null==i?void 0:i.name)?n:"Unknown").split("_")[0];return(0,s.jsxs)("li",{className:"text-sm text-foreground-light",children:["From ",(0,s.jsx)("span",{className:"text-foreground",children:c})," to"," ",(0,s.jsx)("span",{className:"text-foreground",children:null!=(r=null==o?void 0:o.name)?r:"Unknown"})," on"," ",(0,s.jsx)("span",{className:void 0!==d?"text-foreground":"",children:null!=(l=null==d?void 0:d.name)?l:"organization"})]},"update-".concat(t))})})]})]}),(0,s.jsx)("p",{className:"text-sm text-foreground",children:"By changing the role of this member their permissions will change."})]})})},rc=e=>{var t,a,n,r;let{visible:l,member:c,onClose:u}=e,{slug:m}=(0,$.g)(),p=(0,i.a)(),x=(0,d.cC)(m),{data:g}=(0,tW.el)(),{data:f}=(0,nz.m)(),{data:j,isSuccess:v}=sZ({slug:m}),b=null!=(n=null==j?void 0:j.org_scoped_roles)?n:[],N=null!=(r=null==j?void 0:j.project_scoped_roles)?r:[],{rolesAddable:S,rolesRemovable:w}=nW(null==p?void 0:p.slug,b.concat(N),null!=f?f:[]),_=b.every(e=>!S.includes(e.id)),[C,I]=(0,h.useState)(!1),[E,T]=(0,h.useState)(!1),[R,k]=(0,h.useState)([]),M=void 0!==j?rl(c,j,null!=g?g:[]):[],P=1===M.length&&b.find(e=>e.id===M[0].roleId)?"org-scope":"project-scope",D=(null!=g?g:[]).filter(e=>e.organization_id===(null==p?void 0:p.id)),L=1===R.length&&(null==(t=R[0])?void 0:t.ref)===void 0,O=R.length>0,z=null==(a=b.find(e=>"Developer"===e.name))?void 0:a.id,U=D.filter(e=>!R.some(t=>t.ref===e.ref)),B=D.length-U.length,G=M.length!==U.length,H=n6()(R,M),V=e=>{k(R.concat({ref:e,roleId:null!=z?z:b[0].id})),T(!1)},Y=e=>{void 0!==e&&k(R.filter(t=>t.ref!==e))},q=(e,t)=>{void 0!==t.ref?k(R.map(a=>a.ref===t.ref?{ref:a.ref,projectId:a.projectId,roleId:Number(e)}:a)):k([{ref:void 0,roleId:Number(e)}])};return(0,h.useEffect)(()=>{l&&v&&k(rl(c,j,null!=g?g:[]))},[l,v]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n8.cj,{open:l,onOpenChange:()=>u(),"data-sentry-element":"Sheet","data-sentry-source-file":"UpdateRolesPanel.tsx",children:(0,s.jsx)(n8.h,{showClose:!1,size:"default",className:(0,o.cn)("bg-surface-200 p-0 flex flex-row gap-0 !min-w-[400px]"),"data-sentry-element":"SheetContent","data-sentry-source-file":"UpdateRolesPanel.tsx",children:(0,s.jsxs)("div",{className:(0,o.cn)("flex flex-col grow w-full"),children:[(0,s.jsxs)(n8.Fm,{className:(0,o.cn)("py-3 flex flex-row justify-between gap-x-4 items-center border-b"),"data-sentry-element":"SheetHeader","data-sentry-source-file":"UpdateRolesPanel.tsx",children:[(0,s.jsxs)("p",{className:"truncate",title:"Manage access for ".concat(c.username),children:["Manage access for ",c.username]}),(0,s.jsx)(a0.A,{href:"https://supabase.com/docs/guides/platform/access-control","data-sentry-element":"DocsButton","data-sentry-source-file":"UpdateRolesPanel.tsx"})]}),(0,s.jsxs)(n8.Xc,{className:"h-full overflow-auto flex flex-col gap-y-4","data-sentry-element":"SheetSection","data-sentry-source-file":"UpdateRolesPanel.tsx",children:[x&&(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,s.jsx)(a5.d,{disabled:_,checked:L,onCheckedChange:e=>{let t=null!=z?z:b[0].id;e?"org-scope"===P?k(M):k([{ref:void 0,roleId:t}]):"project-scope"===P?k(M):k(D.map(e=>({ref:e.ref,projectId:e.id,roleId:t})))}}),(0,s.jsx)("p",{className:"text-sm",children:"Apply roles to all projects in the organization"})]}),0===R.length&&(0,s.jsxs)(ta.Fc,{children:[(0,s.jsx)(tL.id,{}),(0,s.jsx)(ta.XL,{children:"Team members need to be assigned at least one role"}),(0,s.jsx)(ta.TN,{children:"You may not remove all roles from a team member"})]}),!L&&R.length>0&&R.length!==D.length&&(0,s.jsxs)(ta.Fc,{children:[(0,s.jsx)(ta.XL,{children:G?"This member will only have access to ".concat(B," project").concat(B>1?"s":""):"This member only has access to ".concat(B," project").concat(B>1?"s":"")}),(0,s.jsxs)(ta.TN,{children:[c.username," ",G?"will":"does"," not have access to the following ",U.length," project",U.length>1?"s":"",":",(0,s.jsx)("ul",{className:"list-disc pl-6",children:U.map(e=>(0,s.jsx)("li",{children:e.name},e.id))})]})]}),(0,s.jsx)("div",{className:"flex flex-col gap-y-2",children:R.sort((e,t)=>{var a,s;return(null!=(a=null==e?void 0:e.projectId)?a:0)-(null!=(s=null==t?void 0:t.projectId)?s:0)}).map(e=>{var t,a,n,r,l;let i=void 0===e.ref?"All projects":null==g||null==(t=g.find(t=>t.ref===e.ref))?void 0:t.name,d=b.find(t=>void 0!==e.baseRoleId?t.id===e.baseRoleId:t.id===e.roleId),c=w.includes(null!=(a=null==d?void 0:d.id)?a:0);return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm",children:i}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[_?(0,s.jsxs)(y.m_,{children:[(0,s.jsx)(y.k$,{asChild:!0,children:(0,s.jsx)("div",{className:"flex items-center justify-between rounded-md border border-button bg-button px-3 py-2 text-sm h-10 w-56 text-foreground-light",children:null!=(n=null==d?void 0:d.name)?n:"Unknown"})}),(0,s.jsx)(y.ZI,{side:"bottom",children:"Additional permissions required to update role"})]}):(0,s.jsxs)(aj.l6,{value:(null!=(r=null==e?void 0:e.baseRoleId)?r:e.roleId).toString(),onValueChange:t=>q(t,e),children:[(0,s.jsx)(aj.bq,{className:(0,o.cn)("text-sm h-10 w-56",(null==d?void 0:d.name)===void 0&&"text-foreground-light"),children:null!=(l=null==d?void 0:d.name)?l:"Please select a role"}),(0,s.jsx)(aj.gC,{children:(0,s.jsx)(aj.s3,{children:(null!=b?b:[]).map(e=>{let t=S.includes(e.id);return(0,s.jsx)(aj.eb,{value:e.id.toString(),className:"text-sm hover:bg-selection cursor-pointer",disabled:!t,children:e.name},e.id)})})})]}),!L&&(0,s.jsx)(A.G,{type:"text",disabled:!c,className:"px-1",icon:(0,s.jsx)(aS.A,{}),onClick:()=>Y(null==e?void 0:e.ref),tooltip:{content:{side:"bottom",text:c?"Remove access to project":"Additional permission required to remove role from member"}}})]})]},"".concat(e.ref,"-").concat(e.roleId))})}),!L&&(0,s.jsxs)(nV.AM,{open:E,onOpenChange:T,modal:!1,children:[(0,s.jsx)(nV.Wv,{asChild:!0,children:(0,s.jsx)(F.$,{type:"default",className:"w-min",children:"Add project"})}),(0,s.jsx)(nV.hl,{className:"p-0",side:"bottom",align:"start",children:(0,s.jsxs)(nY.uB,{children:[(0,s.jsx)(nY.G7,{placeholder:"Find project..."}),(0,s.jsxs)(nY.oI,{children:[(0,s.jsx)(nY.xL,{children:"No projects found"}),(0,s.jsx)(nY.L$,{children:(0,s.jsx)(nq.FK,{className:(g||[]).length>7?"h-[210px]":"",children:D.map(e=>{let t=R.some(t=>t.ref===e.ref);return(0,s.jsxs)(nY.h_,{disabled:t,className:"cursor-pointer w-full justify-between",onSelect:()=>V(e.ref),onClick:()=>V(e.ref),children:[(0,s.jsx)("p",{className:"truncate",children:e.name}),t&&(0,s.jsx)("p",{className:"w-[45%] text-right",children:"Already assigned"})]},e.ref)})})})]})]})})]})]}),(0,s.jsxs)(n8.XW,{className:"flex items-center !justify-end px-5 py-4 w-full border-t","data-sentry-element":"SheetFooter","data-sentry-source-file":"UpdateRolesPanel.tsx",children:[(0,s.jsx)(F.$,{type:"default",disabled:!1,onClick:()=>u(),"data-sentry-element":"Button","data-sentry-source-file":"UpdateRolesPanel.tsx",children:"Cancel"}),(0,s.jsx)(F.$,{loading:!1,disabled:!O||H,onClick:()=>{I(!0)},"data-sentry-element":"Button","data-sentry-source-file":"UpdateRolesPanel.tsx",children:"Save roles"})]})]})})}),(0,s.jsx)(rd,{visible:C,member:c,projectsRoleConfiguration:R,onClose:e=>{I(!1),e&&u()},"data-sentry-element":"UpdateRolesConfirmationModal","data-sentry-source-file":"UpdateRolesPanel.tsx"})]})},ru=e=>{var t,a,n,r,o;let{member:u}=e,{slug:p}=(0,$.g)(),{profile:x}=(0,a3.xc)(),[y,f]=(0,h.useState)(!1),[j,v]=(0,h.useState)(!1),b=(0,l.x)("organization_members:delete"),N=(0,i.a)(),{data:S}=(0,nz.m)(),{data:w}=(0,tW.el)(),{data:_}=(0,sX.Q)({slug:p}),{data:C}=sZ({slug:p});(0,d.cC)(p);let I=null!=(a=null==C?void 0:C.org_scoped_roles)?a:[],E=null!=(n=null==C?void 0:C.project_scoped_roles)?n:[],T=!!u.invited_id,R=null==_?void 0:_.find(e=>e.gotrue_id===(null==x?void 0:x.gotrue_id)),k=1===(null!=(r=null==R?void 0:R.role_ids)?r:[]).length&&I.some(e=>e.id===(null==R?void 0:R.role_ids[0])),{rolesRemovable:M}=nW(null==N?void 0:N.slug,I.concat(E),null!=S?S:[]),P=null!=(o=null==(t=u.role_ids)?void 0:t[0])?o:-1,D=u.role_ids.every(e=>M.includes(e)),L=(0,m.SE)(c.aG.CREATE,"user_invites",{resource:{role_id:P}})&&k,O=(0,m.SE)(c.aG.DELETE,"user_invites",{resource:{role_id:P}})&&k,{mutate:z,isLoading:U}=nO({onSuccess:()=>{g.oR.success("Successfully removed ".concat(u.primary_email)),v(!1)}}),{mutate:B,isLoading:G}=nH({onSuccess:()=>{g.oR.success("Resent the invitation.")},onError:e=>{g.oR.error("Failed to resend invitation: ".concat(e.message))}}),{mutate:H,isLoading:V}=n3(),Y=U||V||G,q=()=>p?u.gotrue_id?void z({slug:p,gotrueId:u.gotrue_id}):console.error("gotrue_id is required"):console.error("slug is required"),W=e=>{var t;let a=(null!=(t=null==e?void 0:e.role_ids)?t:[])[0],s=e.invited_id;return p?s?void H({slug:p,id:s,skipInvalidation:!0},{onSuccess:()=>{if(!e.primary_email)return g.oR.error("Email is required");let t=E.find(e=>e.id===a);if(void 0!==t){var s;let a=(null!=(s=null==t?void 0:t.project_ids)?s:[]).map(e=>{var t;return null==w||null==(t=w.find(t=>t.id===e))?void 0:t.ref}).filter(Boolean);B({slug:p,email:e.primary_email,roleId:t.base_role_id,projects:a})}else B({slug:p,email:e.primary_email,roleId:a})}}):console.error("Member invited ID is required"):console.error("Slug is required")},J=e=>{let t=e.invited_id;return p?t?void H({slug:p,id:t},{onSuccess:()=>g.oR.success("Successfully revoked the invitation.")}):console.error("Member invited ID is required"):console.error("Slug is required")};return D&&(!T||L||O)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-end gap-x-2",children:[(0,s.jsx)(A.G,{type:"default",disabled:T||!D,onClick:()=>f(!0),tooltip:{content:{side:"bottom",text:T?"Role can only be changed after the user has accepted the invite":D?void 0:"You need additional permissions to manage this team member"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"MemberActions.tsx",children:"Manage access"}),(0,s.jsxs)(tI.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"MemberActions.tsx",children:[(0,s.jsx)(tI.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"MemberActions.tsx",children:(0,s.jsx)(F.$,{type:"text",className:"px-1.5",disabled:Y,loading:Y,icon:(0,s.jsx)(nn.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"MemberActions.tsx"})}),(0,s.jsx)(tI.SQ,{side:"bottom",align:"end",className:"w-52","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"MemberActions.tsx",children:(0,s.jsx)(s.Fragment,{children:T?(0,s.jsxs)(s.Fragment,{children:[O&&(0,s.jsx)(tI._2,{onClick:()=>J(u),children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{children:"Cancel invitation"}),(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Revoke this invitation."})]})}),L&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tI.mB,{}),(0,s.jsx)(tI._2,{onClick:()=>W(u),children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{children:"Resend invitation"}),(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Invites expire after 24hrs."})]})})]})]}):b&&(0,s.jsxs)(tI._2,{className:"space-x-2 items-start",disabled:!D,onClick:()=>{v(!0)},children:[(0,s.jsx)(s8.A,{size:16}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{children:"Remove member"}),!D&&(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Additional permissions required"})]})]})})})]})]}),(0,s.jsx)(a6.A,{size:"large",visible:j,loading:U,title:"Confirm to remove member",confirmLabel:"Remove",variant:"warning",alert:{title:"All user content from this member will be permanently removed.",description:(0,s.jsxs)("div",{children:["Removing a member will delete all of the user's saved content in all projects of this organization, which includes:",(0,s.jsxs)("ul",{className:"list-disc pl-4 my-2",children:[(0,s.jsxs)("li",{children:["SQL snippets"," ",(0,s.jsxs)("span",{className:"text-foreground",children:["(both ",(0,s.jsx)("span",{className:"underline",children:"private"})," and"," ",(0,s.jsx)("span",{className:"underline",children:"shared"})," snippets)"]})]}),(0,s.jsx)("li",{children:"Custom reports"}),(0,s.jsx)("li",{children:"Log Explorer queries"})]}),(0,s.jsx)("p",{className:"mt-4 text-foreground-lighter",children:"If you'd like to retain the member's shared SQL snippets, right click on them and \"Duplicate query\" in the SQL Editor before removing this member."})]})},onCancel:()=>v(!1),onConfirm:()=>{q()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"MemberActions.tsx",children:(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to remove"," ",(0,s.jsx)("span",{className:"text-foreground",children:u.primary_email})," from"," ",(0,s.jsx)("span",{className:"text-foreground",children:null==N?void 0:N.name}),"?"]})}),(0,s.jsx)(rc,{visible:y,member:u,onClose:()=>f(!1),"data-sentry-element":"UpdateRolesPanel","data-sentry-source-file":"MemberActions.tsx"})]}):(0,s.jsx)("div",{className:"flex items-center justify-end",children:(0,s.jsx)(A.G,{disabled:!0,type:"text",className:"px-1.5",icon:(0,s.jsx)(nn.A,{size:18}),tooltip:{content:{side:"bottom",text:"You need additional permissions to manage this team member"}}})})},rm={vercel:"vercel-marketplace"},rp=e=>{var t,a,n,r;let{member:l}=e,{profile:d}=(0,a3.xc)(),c=(0,i.a)(),{data:u}=(0,tW.el)(),{data:m,isLoading:p}=sZ({slug:null==c?void 0:c.slug}),x=null==u?void 0:u.filter(e=>e.organization_id===(null==c?void 0:c.id)),h=(null!=(n=null==m?void 0:m.project_scoped_roles)?n:[]).length>0,g=l.gotrue_id==(null==d?void 0:d.gotrue_id),y=!!l.invited_id,j=l.username===l.primary_email,v=!!(null==(t=l.primary_email)?void 0:t.endsWith("customer.fly.io")),b=y||j||v?void 0:(0,aV.By)(l.username),S=l.role_ids.filter(e=>{var t,a,s;let n=[...null!=(t=null==m?void 0:m.org_scoped_roles)?t:[],...null!=(a=null==m?void 0:m.project_scoped_roles)?a:[]].find(t=>t.id===e);return(null==n?void 0:n.project_ids)!==null&&0===(null!=(s=null==n?void 0:n.project_ids)?s:[]).map(e=>{var t,a;return null!=(a=null==u||null==(t=u.find(t=>t.id===e))?void 0:t.name)?a:""}).filter(e=>e.length>0).length}).length>0;return(0,s.jsxs)(N.A.tr,{"data-sentry-element":"unknown","data-sentry-component":"MemberRow","data-sentry-source-file":"MemberRow.tsx",children:[(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,s.jsx)(n0.p,{alt:l.username,src:b,className:"border rounded-full w-[32px] h-[32px] md:w-[40px] md:h-[40px]",placeholder:(0,s.jsx)("div",{className:(0,o.cn)("w-[32px] h-[32px] md:w-[40px] md:h-[40px]","bg-surface-100 border border-overlay rounded-full text-foreground-lighter flex items-center justify-center"),children:(0,s.jsx)(sB.A,{size:20,strokeWidth:1.5})}),"data-sentry-element":"ProfileImage","data-sentry-source-file":"MemberRow.tsx"}),(0,s.jsxs)("div",{className:"flex item-center gap-x-2",children:[void 0===y?(0,s.jsx)("p",{className:"text-foreground-light truncate",children:l.primary_email}):(0,s.jsx)("p",{className:"text-foreground truncate",children:n1(l)}),l.primary_email===(null==d?void 0:d.primary_email)&&(0,s.jsx)(f.E,{color:"scale",children:"You"})]}),(null==(a=l.metadata)?void 0:a.origin)&&(0,s.jsx)(nX.A,{organization:{managed_by:null!=(r=rm[l.metadata.origin])?r:"supabase"},tooltipText:"This user is managed by Vercel Marketplace."})]})}),(0,s.jsxs)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:[y&&l.invited_at&&(0,s.jsx)(f.E,{variant:n2(l.invited_at)?"destructive":"warning",children:n2(l.invited_at)?"Expired":"Invited"}),l.is_sso_user&&(0,s.jsx)(f.E,{variant:"default",children:"SSO"})]}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:(0,s.jsx)("div",{className:"flex items-center justify-center",children:l.mfa_enabled?(0,s.jsx)(tU.A,{className:"text-brand",strokeWidth:2,size:20}):(0,s.jsx)(aS.A,{className:"text-foreground-light",strokeWidth:1.5,size:20})})}),(0,s.jsx)(N.A.td,{className:"max-w-64","data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:p?(0,s.jsx)(U.A,{className:"w-32"}):S?(0,s.jsx)(nK.A,{strokeWidth:1.5,size:20}):l.role_ids.map(e=>{var t,a,n,r,l;let i=(null!=(t=null==m?void 0:m.org_scoped_roles)?t:[]).find(t=>t.id===e),d=(null!=(a=null==m?void 0:m.project_scoped_roles)?a:[]).find(t=>t.id===e),c=i||d,u=(null!=(n=null==c?void 0:c.name)?n:"").split("_")[0],p=(null==c?void 0:c.project_ids)===null?null!=(r=null==x?void 0:x.map(e=>e.name))?r:[]:(null!=(l=null==c?void 0:c.project_ids)?l:[]).map(e=>{var t,a;return null!=(a=null==x||null==(t=x.find(t=>t.id===e))?void 0:t.name)?a:""}).filter(e=>e.length>0);return(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)("p",{children:u}),h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"•"}),1===p.length?(0,s.jsx)("span",{className:"text-foreground truncate",title:p[0],children:p[0]}):(0,s.jsxs)(as.jc,{openDelay:200,children:[(0,s.jsx)(as.d0,{asChild:!0,children:(0,s.jsx)("span",{className:"text-foreground",children:(null==c?void 0:c.project_ids)===null?"Organization":"".concat(p.length," project").concat(p.length>1?"s":"")})}),(0,s.jsxs)(as.Et,{className:"p-0",children:[(0,s.jsxs)("p",{className:"p-2 text-xs",children:[u," role applies to ",p.length," project",p.length>1?"s":""]}),(0,s.jsx)("div",{className:"border-t flex flex-col py-1",children:(0,s.jsx)(nq.FK,{className:(0,o.cn)(p.length>5?"h-[130px]":""),children:p.map(e=>{var t;let a=null==x||null==(t=x.find(t=>t.name===e))?void 0:t.ref;return(0,s.jsxs)(ec(),{href:"/project/".concat(a),className:"px-2 py-1 group hover:bg-surface-300 hover:text-foreground transition flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs truncate max-w-[60%]",children:e}),(0,s.jsxs)("span",{className:"text-xs text-foreground flex items-center gap-x-1 opacity-0 group-hover:opacity-100 transition",children:["Go to project",(0,s.jsx)(nQ.A,{size:14})]})]},e)})})})]})]})]})]},"role-".concat(e))})}),(0,s.jsx)(N.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:!g&&(0,s.jsx)(ru,{member:l})})]})},rx=e=>{var t,a,n;let{searchString:r}=e,{slug:l}=(0,$.g)(),{profile:i}=(0,a3.xc)(),{data:o,error:d,isLoading:c,isError:u,isSuccess:m}=(0,sX.Q)({slug:l}),{data:p,error:x,isSuccess:h,isError:g}=sZ({slug:l}),f=null!=o?o:[],j=(!r?f:f.filter(e=>{var t,a;return e.invited_at?null==(t=e.primary_email)?void 0:t.includes(r):e.gotrue_id?e.username.includes(r)||(null==(a=e.primary_email)?void 0:a.includes(r)):void 0})).slice().sort((e,t)=>e.primary_email===(null==i?void 0:i.primary_email)?-1:e.username.localeCompare(t.username)),v=f.find(e=>e.primary_email===(null==i?void 0:i.primary_email)),b=(null!=(a=null==p?void 0:p.org_scoped_roles)?a:[]).map(e=>e.id).includes(null!=(n=null==v||null==(t=v.role_ids)?void 0:t[0])?n:-1);return(0,s.jsxs)(s.Fragment,{children:[c&&(0,s.jsx)(Q.y,{}),u&&(0,s.jsx)(S.A,{error:d,subject:"Failed to retrieve organization members"}),g&&(0,s.jsx)(S.A,{error:x,subject:"Failed to retrieve organization roles"}),m&&(0,s.jsx)("div",{className:"rounded w-full overflow-hidden overflow-x-scroll",children:(0,s.jsx)(nZ.A,{active:!j,children:(0,s.jsx)(N.A,{head:[(0,s.jsx)(N.A.th,{children:"User"},"header-user"),(0,s.jsx)(N.A.th,{className:"w-24"},"header-status"),(0,s.jsx)(N.A.th,{className:"text-center w-32",children:"Enabled MFA"},"header-mfa"),(0,s.jsxs)(N.A.th,{className:"flex items-center space-x-1",children:[(0,s.jsx)("span",{children:"Role"}),(0,s.jsxs)(y.m_,{children:[(0,s.jsx)(y.k$,{asChild:!0,children:(0,s.jsx)(F.$,{asChild:!0,type:"text",className:"px-1",children:(0,s.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/platform/access-control",children:(0,s.jsx)(aK.A,{size:14,className:"text-foreground-light"})})})}),(0,s.jsx)(y.ZI,{side:"bottom",children:"How to configure access control?"})]})]},"header-role"),(0,s.jsx)(N.A.th,{},"header-action")],body:[...h&&m&&!b?[(0,s.jsx)(N.A.tr,{children:(0,s.jsx)(N.A.td,{colSpan:12,className:"!p-0",children:(0,s.jsx)(tk.Z,{type:"note",title:"You are currently assigned with project scoped roles in this organization",description:"All the members within the organization will not be visible to you",className:"m-0 bg-alternative border-0 rounded-none"})})},"project-scope-notice")]:[],...j.map(e=>(0,s.jsx)(rp,{member:e},e.gotrue_id)),...r.length>0&&0===j.length?[(0,s.jsx)(N.A.tr,{className:"bg-panel-secondary-light",children:(0,s.jsx)(N.A.td,{colSpan:12,children:(0,s.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,s.jsx)(e6.A,{size:16,strokeWidth:2}),(0,s.jsxs)("p",{className:"text-foreground-light",children:['No users matched the search query "',r,'"']})]})})},"no-results")]:[],(0,s.jsx)(N.A.tr,{className:"bg-panel-secondary-light",children:(0,s.jsx)(N.A.td,{colSpan:12,children:(0,s.jsxs)("p",{className:"text-foreground-light",children:[r?"".concat(j.length," of "):"",f.length||"0"," ",1==f.length?"user":"users"]})})},"footer")]})})})]})},rh=()=>{var e;let t=(0,n.FO)(),[a,o]=(0,aP.U)(eH.rS.LAST_VISITED_ORGANIZATION,""),{organizationMembersCreate:d,organizationMembersDelete:c}=(0,l.x)(["organization_members:create","organization_members:delete"]),{slug:u}=(0,$.g)(),m=(0,tB.useRouter)(),{profile:p}=(0,a3.xc)(),x=(0,i.a)(),y=null==x?void 0:x.is_owner,{data:f}=(0,nz.m)(),{refetch:j}=(0,aC.Ad)(),{data:v}=sZ({slug:u}),{data:b}=(0,sX.Q)({slug:u}),N=null!=(e=null==v?void 0:v.org_scoped_roles)?e:[],{rolesAddable:S}=nW(null==x?void 0:x.slug,N,null!=f?f:[]),[w,_]=(0,h.useState)(!1),[C,I]=(0,h.useState)(""),E=S.length>0,T=!y||y&&n$(b,N),{mutate:R}=nO({onSuccess:async()=>{_(!1),M(!1),await j(),g.oR.success("Successfully left ".concat(null==x?void 0:x.name)),t?(o(""),m.push("/organizations")):m.push("/projects")},onError:e=>{_(!1),g.oR.error("Failed to leave organization: ".concat(null==e?void 0:e.message))}}),[k,M]=(0,h.useState)(!1),P=async()=>{if(!u)return console.error("Org slug is required");_(!0),R({slug:u,gotrueId:p.gotrue_id})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.Vw,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-source-file":"TeamSettings.tsx",children:[t&&(0,s.jsx)(r.Dm,{children:"Team"}),(0,s.jsxs)(r.tn,{"data-sentry-element":"ScaffoldFilterAndContent","data-sentry-source-file":"TeamSettings.tsx",children:[(0,s.jsxs)(r.HJ,{className:"w-full flex-col md:flex-row gap-2 justify-between","data-sentry-element":"ScaffoldActionsContainer","data-sentry-source-file":"TeamSettings.tsx",children:[(0,s.jsx)(nF.p,{size:"tiny",autoComplete:"off",icon:(0,s.jsx)(nD.A,{size:12}),value:C,onChange:e=>I(e.target.value),name:"email",id:"email",placeholder:"Filter members","data-sentry-element":"Input","data-sentry-source-file":"TeamSettings.tsx"}),(0,s.jsxs)(r.fh,{className:"w-full md:w-auto","data-sentry-element":"ScaffoldActionsGroup","data-sentry-source-file":"TeamSettings.tsx",children:[d&&E&&void 0!==p&&void 0!==x&&(0,s.jsx)(nJ,{}),c&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(A.G,{type:"default",loading:w,disabled:!T,tooltip:{content:{side:"bottom",text:T?void 0:"An organization requires at least 1 owner"}},onClick:()=>M(!0),children:"Leave team"})})]})]}),(0,s.jsx)(r.Rf,{className:"w-full","data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"TeamSettings.tsx",children:(0,s.jsx)(rx,{searchString:C,"data-sentry-element":"MembersView","data-sentry-source-file":"TeamSettings.tsx"})})]})]}),(0,s.jsx)(a6.A,{size:"medium",visible:k,title:"Confirm to leave organization",confirmLabel:"Leave",variant:"warning",alert:{title:"All of your user content will be permanently removed.",description:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Leaving the organization will delete all of your saved content in the projects of the organization, which includes:"}),(0,s.jsxs)("ul",{className:"list-disc pl-4",children:[(0,s.jsxs)("li",{children:["SQL snippets ",(0,s.jsx)("span",{className:"text-foreground",children:"(both private and shared)"})]}),(0,s.jsx)("li",{children:"Custom reports"}),(0,s.jsx)("li",{children:"Log Explorer queries"})]})]})},onCancel:()=>M(!1),onConfirm:()=>P(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"TeamSettings.tsx",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to leave this organization? This is permanent."})})]})},rg=()=>(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"DPA","data-sentry-source-file":"DPA.tsx",children:[(0,s.jsxs)(r.xp,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"DPA.tsx",children:[(0,s.jsx)("p",{className:"text-base m-0",children:"Data Processing Addendum (DPA)"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,s.jsx)("p",{children:"All organizations can access and use our DPA as part of their GDPR compliance. This is only to access the document. Please ignore this if you have sent the signed document to us."}),(0,s.jsxs)("p",{children:["Please review these details and add data specific to user processing where required. Sign and return the signed DPA document to"," ",(0,s.jsx)("a",{href:"mailto:privacy@supabase.com",target:"_blank",className:"text-brand hover:text-brand",children:"privacy@supabase.com"})," ","for the document to be considered executed."]})]})]}),(0,s.jsx)(r.Rf,{className:"flex items-center justify-center h-full","data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"DPA.tsx",children:(0,s.jsx)(F.$,{asChild:!0,type:"default",iconRight:(0,s.jsx)(ez.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"DPA.tsx",children:(0,s.jsx)("a",{download:!0,target:"_blank",rel:"noreferrer noopener",href:"https://supabase.com/downloads/docs/Supabase+DPA+250314.pdf",children:"View DPA"})})})]}),ry=()=>(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"TIA","data-sentry-source-file":"TIA.tsx",children:[(0,s.jsxs)(r.xp,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"TIA.tsx",children:[(0,s.jsx)("p",{className:"text-base m-0",children:"Transfer Impact Assessment (TIA)"}),(0,s.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,s.jsx)("p",{children:"All organizations can access and use our TIA as part of their GDPR-compliant data transfer process."})})]}),(0,s.jsx)(r.Rf,{className:"flex items-center justify-center h-full","data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"TIA.tsx",children:(0,s.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+TIA+250314.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,s.jsx)(F.$,{type:"default",iconRight:(0,s.jsx)(ez.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"TIA.tsx",children:"View TIA"})})})]});async function rf(e,t){let{orgSlug:a,docType:s}=e;if(!a)throw Error("orgSlug is required");if("standard-security-questionnaire"===s){let{data:e,error:s}=await (0,_.Jt)("/platform/organizations/{slug}/documents/standard-security-questionnaire",{params:{path:{slug:a}},signal:t});return s&&(0,_.H4)(s),e}if("soc2-type-2-report"===s){let{data:e,error:s}=await (0,_.Jt)("/platform/organizations/{slug}/documents/soc2-type-2-report",{params:{path:{slug:a}},signal:t});if(s)throw s;return e}}let rj=()=>{let e=(0,i.a)(),t=null==e?void 0:e.slug,a=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions"),n=null==e?void 0:e.plan,l=async e=>{try{let t=await rf({orgSlug:e,docType:"standard-security-questionnaire"});(null==t?void 0:t.fileUrl)&&window.open(t.fileUrl,"_blank")}catch(e){g.oR.error("Failed to download Security Questionnaire: ".concat(e.message))}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"SecurityQuestionnaire.tsx",children:[(0,s.jsxs)(r.xp,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"SecurityQuestionnaire.tsx",children:[(0,s.jsx)("p",{className:"text-base m-0",children:"Standard Security Questionnaire"}),(0,s.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,s.jsx)("p",{children:"Organizations on Team Plan or above have access to our standard security questionnaire."})})]}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"SecurityQuestionnaire.tsx",children:a?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==n?void 0:n.id)==="free"||(null==n?void 0:n.id)==="pro"?(0,s.jsx)(ec(),{href:"/org/".concat(t,"/billing?panel=subscriptionPlan&source=securityQuestionnaire"),children:(0,s.jsx)(F.$,{type:"default",children:"Upgrade to Team"})}):(0,s.jsx)(F.$,{type:"default",icon:(0,s.jsx)(L.A,{}),onClick:()=>{t&&l(t)},children:"Download Questionnaire"})})}):(0,s.jsx)(u.A,{resourceText:"access our security questionnaire"})})]})})},rv=()=>{let e=(0,i.a)(),t=null==e?void 0:e.slug,a=(0,m.SE)(c.aG.BILLING_READ,"stripe.subscriptions"),n=null==e?void 0:e.plan,[l,o]=(0,h.useState)(!1),d=async e=>{try{let t=await rf({orgSlug:e,docType:"soc2-type-2-report"});(null==t?void 0:t.fileUrl)&&window.open(t.fileUrl,"_blank"),o(!1)}catch(e){g.oR.error("Failed to download SOC2 report: ".concat(e.message))}};return(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"SOC2","data-sentry-source-file":"SOC2.tsx",children:[(0,s.jsxs)(r.xp,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"SOC2.tsx",children:[(0,s.jsx)("p",{className:"text-base m-0",children:"SOC2 Type 2"}),(0,s.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,s.jsx)("p",{children:"Organizations on Team Plan or above have access to our most recent SOC2 Type 2 report."})})]}),(0,s.jsxs)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"SOC2.tsx",children:[a?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==n?void 0:n.id)==="free"||(null==n?void 0:n.id)==="pro"?(0,s.jsx)(ec(),{href:"/org/".concat(t,"/billing?panel=subscriptionPlan&source=soc2"),children:(0,s.jsx)(F.$,{type:"default",children:"Upgrade to Team"})}):(0,s.jsx)(F.$,{type:"default",icon:(0,s.jsx)(L.A,{}),onClick:()=>o(!0),children:"Download SOC2 Type 2 Report"})}):(0,s.jsx)(u.A,{resourceText:"access our SOC2 Type 2 report"}),(0,s.jsx)(a6.A,{visible:l,size:"large",title:"Non-Disclosure Agreement to access Supabase's SOC2 Report",confirmLabel:"I agree",confirmLabelLoading:"Downloading",onCancel:()=>o(!1),onConfirm:()=>{t&&d(t)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"SOC2.tsx",children:(0,s.jsxs)("ol",{className:"list-decimal list-inside text-sm text-foreground-light pl-30",children:[(0,s.jsx)("li",{children:"The information that you are about to access is confidential."}),(0,s.jsx)("li",{children:'Your access to our SOC 2 materials is governed by confidentiality obligations contained in the agreement between Supabase, Inc ("Supabase", "we", "our" or "us") and the Supabase customer that has authorized you to access our platform to obtain this information (our "Customer").'}),(0,s.jsx)("li",{children:"You must ensure that you treat the information in our SOC 2 materials in accordance with those confidentiality obligations, as communicated to you by the Customer."}),(0,s.jsxs)("li",{children:['By clicking "I agree" below or otherwise accessing our SOC 2 materials, you:',(0,s.jsxs)("ol",{className:"list-[lower-roman] list-inside pl-4",children:[(0,s.jsx)("li",{children:"acknowledge that you have read and understood this Confidentiality Notice;"}),(0,s.jsx)("li",{children:"confirm that you have been authorized by the Customer to access this information, and your use of our SOC 2 materials is subject to the confidentiality obligations owed by the Customer to us."})]})]}),(0,s.jsx)("li",{children:"This Confidentiality Notice does not substitute or supersede any agreement between us and the Customer, or any internal rules or policies that the Customer requires you to comply with in your access to and use of confidential information. However, your failure to comply with this Confidentiality Notice may be used to determine whether the Customer has complied with its confidentiality obligations to us."})]})})]})]})},rb=()=>(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"HIPAA.tsx",children:[(0,s.jsxs)(r.xp,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"HIPAA.tsx",children:[(0,s.jsx)("p",{className:"text-base m-0",children:"HIPAA"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,s.jsx)("p",{children:"This is only for HIPAA requests. Please ignore this if you already have HIPAA enabled."}),(0,s.jsx)("p",{children:"Organizations on the Team Plan or above are eligible for a paid HIPAA compliance add-on. You can submit a request here and we will get back to you on the pricing and process for your use case."}),(0,s.jsx)("p",{children:"Organizations on the Free or Pro Plan can also submit a request for HIPAA. Note that you are still required to upgrade to the Team Plan after your request is approved."})]})]}),(0,s.jsx)(r.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"HIPAA.tsx",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)("a",{href:"https://forms.supabase.com/hipaa2",target:"_blank",rel:"noreferrer noopener",children:(0,s.jsx)(F.$,{type:"default",iconRight:(0,s.jsx)(ez.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"HIPAA.tsx",children:"Request HIPAA"})})})})]})}),rN=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.eh,{id:"dpa","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,s.jsx)(rg,{"data-sentry-element":"DPA","data-sentry-source-file":"Documents.tsx"})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,s.jsx)(r.eh,{id:"tia","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,s.jsx)(ry,{"data-sentry-element":"TIA","data-sentry-source-file":"Documents.tsx"})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,s.jsx)(r.eh,{id:"soc2","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,s.jsx)(rv,{"data-sentry-element":"SOC2","data-sentry-source-file":"Documents.tsx"})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,s.jsx)(r.eh,{id:"hipaa","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,s.jsx)(rb,{"data-sentry-element":"HIPAA","data-sentry-source-file":"Documents.tsx"})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,s.jsx)(r.eh,{id:"security-questionnaire","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,s.jsx)(rj,{"data-sentry-element":"SecurityQuestionnaire","data-sentry-source-file":"Documents.tsx"})}),(0,s.jsx)(r.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,s.jsx)(r.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,s.jsx)(r.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"Documents.tsx",children:(0,s.jsxs)("p",{className:"sticky space-y-6 top-12 text-sm text-foreground-light m-0 whitespace-nowrap",children:[(0,s.jsx)(ec(),{href:"/support/new",className:"hover:underline","data-sentry-element":"Link","data-sentry-source-file":"Documents.tsx",children:"Submit a support request"})," ","if you require additional documents for financial or tax reasons, such as a W-9 form."]})})})]})},99667:(e,t,a)=>{a.d(t,{$:()=>r});var s=a(80263),n=a(2);let r=e=>{let{loading:t}=e;return(0,s.jsx)("div",{className:"relative overflow-hidden w-full h-px bg-border m-auto","data-sentry-component":"LoadingLine","data-sentry-source-file":"LoadingLine.tsx",children:(0,s.jsx)("span",{className:(0,n.cn)("absolute w-[80px] h-px ml-auto mr-auto left-0 right-0 text-center block top-0","transition-all","line-loading-bg-light dark:line-loading-bg",t&&"animate-line-loading-slower opacity-100",t?"opacity-100":"opacity-0")})})}}}]);