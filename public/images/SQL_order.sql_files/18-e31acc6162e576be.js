!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0acd82a6-128f-4ad6-996a-f328f286d208",e._sentryDebugIdIdentifier="sentry-dbid-0acd82a6-128f-4ad6-996a-f328f286d208")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[18],{2081:(e,t,a)=>{a.d(t,{A:()=>d});var s=a(80263),n=a(64238),r=a(81372),i=a(53239),l=a(90206),o=a(16601),c=a(2);let d=e=>{var t;let{text:a,asyncText:d,iconOnly:u=!1,children:m,onClick:p,copyLabel:x="Copy",copiedLabel:h="Copied",...f}=e,[g,b]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{if(!g)return;let e=setTimeout(()=>b(!1),2e3);return()=>clearTimeout(e)},[g]),(0,s.jsx)(o.$,{onClick:async e=>{let t=d?await d():a;b(!0),await (0,l.lW)(t),null==p||p(e)},...f,className:(0,c.cn)({"px-1":u},f.className),icon:g?(0,s.jsx)(n.A,{strokeWidth:2,className:"text-brand"}):null!=(t=f.icon)?t:(0,s.jsx)(r.A,{}),"data-sentry-element":"Button","data-sentry-component":"CopyButton","data-sentry-source-file":"CopyButton.tsx",children:!u&&(0,s.jsx)(s.Fragment,{children:null!=m?m:g?h:x})})}},3454:(e,t,a)=>{a.d(t,{b:()=>s});let s={list:e=>["projects",e,"database-publications"]}},7298:(e,t,a)=>{a.d(t,{k:()=>o});var s=a(25222),n=a(53239),r=a(82489),i=a(58897);let l=e=>(0,s.ZA)("schema",s.tU.withDefault(e)),o=()=>{let{ref:e}=(0,r.g)(),t=e&&e.length>0&&window.localStorage.getItem(i.rS.LAST_SELECTED_SCHEMA(e))||"public",[a,s]=l((0,n.useMemo)(()=>t,[e]));return(0,n.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(i.rS.LAST_SELECTED_SCHEMA(e),a)},[a,e]),{selectedSchema:a,setSelectedSchema:s}}},9418:(e,t,a)=>{a.d(t,{A:()=>o});var s=a(80263),n=a(60045),r=a(93274),i=a(65904),l=a(88601);let o=e=>{let{children:t}=e,a=(0,i.Lh)(),o=(0,i.SE)(n.aG.TENANT_SQL_ADMIN_READ,"tables");return a&&!o?(0,s.jsx)(l.S,{isBlocking:!1,children:(0,s.jsx)(r.A,{isFullPage:!0,resourceText:"view tables from this project"})}):(0,s.jsx)(s.Fragment,{children:t})}},10670:(e,t,a)=>{a.d(t,{$:()=>C});var s=a(80263),n=a(7086),r=a(82489),i=a(96591),l=a(2),o=a(88601),c=a(95903),d=a(36085),u=a(10170),m=a(3732);function p(e){let{hideTabs:t}=e,{showSidebar:a,setShowSidebar:n}=(0,u.qM)();return(0,s.jsxs)(m.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"CollapseButton","data-sentry-source-file":"CollapseButton.tsx",children:[(0,s.jsx)(m.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"CollapseButton.tsx",children:(0,s.jsx)("button",{className:(0,l.cn)("flex items-center justify-center w-10 h-10 hover:bg-surface-100 shrink-0",!t&&"border-b border-b-default"),onClick:()=>n(!a),children:a?(0,s.jsx)(c.A,{size:16,strokeWidth:1.5,className:"text-foreground-lighter hover:text-foreground-light"}):(0,s.jsx)(d.A,{size:16,strokeWidth:1.5,className:"text-foreground-lighter hover:text-foreground-light"})})}),(0,s.jsxs)(m.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"CollapseButton.tsx",children:["Collapse"," sidebar"]})]})}var x=a(26779),h=a(47625),f=a(88712),g=a(37055),b=a(97318),y=a(23278),v=a(52385),j=a(79175),w=a(93479),N=a(62517),S=a(87604),A=a(53239),_=a(58604);let k=e=>{var t;let{tab:a,index:n,openTabs:i,onClose:o}=e,c=(0,v.useRouter)(),{ref:d}=(0,r.g)(),u=c.query.schema||"public",{attributes:m,listeners:p,setNodeRef:x,transform:b,transition:N,isDragging:k}=(0,h.gl)({id:a.id}),E={transform:S.Ks.Transform.toString(b),transition:N,zIndex:+!!k},R=(0,A.useMemo)(()=>"r"===a.type&&i.filter(e=>"r"===e.type).some(e=>{var t;return(null==(t=e.metadata)?void 0:t.schema)!==u}),[i,u,a.type]);return(0,s.jsxs)(g.P.div,{ref:x,style:E,...m,layoutId:a.id,transition:{duration:.045},animate:{opacity:+!k},className:(0,l.cn)("flex items-center h-10 first-of-type:border-l"),"data-sentry-element":"unknown","data-sentry-component":"SortableTab","data-sentry-source-file":"SortableTab.tsx",children:[(0,s.jsxs)(w.Xi,{value:a.id,onDoubleClick:()=>(0,j.UH)(d,a.id),className:(0,l.cn)("flex items-center gap-2 pl-3 pr-2.5 text-xs","bg-dash-sidebar/50 dark:bg-surface-100/50","data-[state=active]:bg-dash-sidebar dark:data-[state=active]:bg-surface-100","border-b border-default","data-[state=active]:border-b-background-dash-sidebar dark:data-[state=active]:border-b-background-surface-100","relative group h-full","hover:bg-surface-300 dark:hover:bg-surface-100",a.isPreview&&"italic font-light"),...p,"data-sentry-element":"TabsTrigger_Shadcn_","data-sentry-source-file":"SortableTab.tsx",children:[(0,s.jsx)(_.L,{type:a.type,"data-sentry-element":"EntityTypeIcon","data-sentry-source-file":"SortableTab.tsx"}),(0,s.jsxs)("div",{className:"flex items-center gap-0",children:[(0,s.jsx)(f.N,{mode:"popLayout",initial:!0,"data-sentry-element":"AnimatePresence","data-sentry-source-file":"SortableTab.tsx",children:R&&(0,s.jsxs)(g.P.span,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"text-foreground-muted group-data-[state=active]:text-foreground-lighter",children:[null==a||null==(t=a.metadata)?void 0:t.schema,"."]})}),(0,s.jsx)("span",{children:a.label||"Untitled"})]}),(0,s.jsx)("span",{role:"button",onClick:e=>{e.preventDefault(),e.stopPropagation()},className:"p-0.5 ml-1 opacity-0 group-hover:opacity-100 hover:bg-200 rounded-sm cursor-pointer",onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onPointerDown:e=>{e.preventDefault(),e.stopPropagation(),o(a.id)},children:(0,s.jsx)(y.A,{size:12,className:"text-foreground-light","data-sentry-element":"X","data-sentry-source-file":"SortableTab.tsx"})}),(0,s.jsx)("div",{className:"absolute w-full top-0 left-0 right-0 h-px bg-foreground opacity-0 group-data-[state=active]:opacity-100"})]}),n<i.length&&(0,s.jsx)("div",{role:"separator",className:"h-full w-px bg-border"},"separator-".concat(a.id))]})};var E=a(12532);let R=e=>{let{tab:t}=e,{ref:a}=(0,r.g)(),n=(0,j.IT)(a),i=(0,E.s)(n).tabsMap[t];return i?(0,s.jsxs)(g.P.div,{layoutId:t,transition:{duration:.045},animate:{opacity:.7},className:"flex relative items-center gap-2 px-3 text-xs bg-dash-sidebar dark:bg-surface-100 shadow-lg rounded-sm h-10","data-sentry-element":"unknown","data-sentry-component":"TabPreview","data-sentry-source-file":"TabPreview.tsx",children:[(0,s.jsx)(_.L,{type:i.type,"data-sentry-element":"EntityTypeIcon","data-sentry-source-file":"TabPreview.tsx"}),(0,s.jsx)("span",{children:i.label||"Untitled"}),(0,s.jsx)("div",{className:"absolute w-full top-0 left-0 right-0 h-px bg-foreground-muted"})]}):null},T=()=>{var e;let{ref:t}=(0,r.g)(),a=(0,v.useRouter)(),n=(0,u.qM)(),i=(0,N.l)(),o=(0,j.ZG)(t),c=(0,x.FR)((0,x.MS)(x.AN,{activationConstraint:{distance:1}})),d=o.openTabs.map(e=>o.tabsMap[e]).filter(e=>void 0!==e),m=a.asPath.includes("/new"),S=i?d.filter(e=>{var t;return null==(t=j.qm[i])?void 0:t.includes(e.type)}):[],A=e=>{(0,j.cO)({ref:t,id:e,router:a,editor:i,onClearDashboardHistory:()=>{t&&i&&n.setDashboardHistory(t,"table"===i?"editor":i,void 0)}})};return(0,s.jsxs)(x.Mp,{sensors:c,onDragEnd:e=>{let{active:s,over:n}=e;if(!n||s.id===n.id)return;let r=o.openTabs.indexOf(s.id.toString()),i=o.openTabs.indexOf(n.id.toString());r!==i&&(0,j.Lz)(t,r,i,s.id.toString(),a)},"data-sentry-element":"DndContext","data-sentry-component":"EditorTabs","data-sentry-source-file":"Tabs.tsx",children:[(0,s.jsxs)(w.tU,{className:"w-full flex",value:m?"new":null!=(e=o.activeTab)?e:void 0,onValueChange:e=>{(0,j.I1)(t,e,a)},"data-sentry-element":"Tabs_Shadcn_","data-sentry-source-file":"Tabs.tsx",children:[(0,s.jsx)(p,{hideTabs:!1,"data-sentry-element":"CollapseButton","data-sentry-source-file":"Tabs.tsx"}),(0,s.jsxs)(w.j7,{className:"bg-surface-200 dark:bg-alternative rounded-b-none gap-0 h-10 flex items-center w-full z-[1] border-none overflow-clip overflow-x-auto ","data-sentry-element":"TabsList_Shadcn_","data-sentry-source-file":"Tabs.tsx",children:[(0,s.jsx)(h.gB,{items:S.map(e=>e.id),strategy:h.m$,"data-sentry-element":"SortableContext","data-sentry-source-file":"Tabs.tsx",children:S.map((e,t)=>(0,s.jsx)(k,{tab:e,index:t,openTabs:d,onClose:()=>A(e.id)},e.id))}),m&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(w.Xi,{value:"new",className:(0,l.cn)("flex items-center gap-2 px-3 text-xs","bg-dash-sidebar/50 dark:bg-surface-100/50","data-[state=active]:bg-dash-sidebar dark:data-[state=active]:bg-surface-100","relative group h-full border-t-2 !border-b-0","hover:bg-surface-300 dark:hover:bg-surface-100"),children:[(0,s.jsx)(b.A,{size:16,strokeWidth:1.5,className:"text-foreground-lighter"}),(0,s.jsx)("div",{className:"flex items-center gap-0",children:(0,s.jsx)("span",{children:"New"})}),(0,s.jsx)("span",{role:"button",onClick:e=>{e.preventDefault(),e.stopPropagation()},className:"ml-1 opacity-0 group-hover:opacity-100 hover:bg-200 rounded-sm cursor-pointer",onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onPointerDown:e=>{e.preventDefault(),e.stopPropagation(),A("new")},children:(0,s.jsx)(y.A,{size:12,className:"text-foreground-light"})})," ",(0,s.jsx)("div",{className:"absolute w-full -bottom-[1px] left-0 right-0 h-px bg-dash-sidebar dark:bg-surface-100 opacity-0 group-data-[state=active]:opacity-100"})]})}),(0,s.jsx)(f.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-source-file":"Tabs.tsx",children:!m&&(0,s.jsx)(g.P.button,{className:"flex items-center justify-center w-10 h-10 hover:bg-surface-100 shrink-0 border-b",onClick:()=>a.push("/project/".concat(a.query.ref,"/").concat("table"===i?"editor":"sql","/new?skip=true")),initial:{opacity:0,scale:.8,x:-10},animate:{opacity:1,scale:1,x:0},transition:{duration:.2},children:(0,s.jsx)(b.A,{size:16,strokeWidth:1.5,className:"text-foreground-lighter hover:text-foreground-light"})})}),(0,s.jsx)("div",{className:"grow h-full border-b pr-6"})]})]}),(0,s.jsx)(x.Hd,{dropAnimation:null,"data-sentry-element":"DragOverlay","data-sentry-source-file":"Tabs.tsx",children:o.activeTab?(0,s.jsx)(R,{tab:o.activeTab}):null})]})},C=e=>{let{children:t,title:a,product:c,...d}=e,{ref:u}=(0,r.g)(),m=(0,n.usePathname)(),x=(0,N.l)(),h=(0,i.mh)(),f=(0,i.Uq)(),g=m==="/project/".concat(u,"/editor")||m==="/project/".concat(u,"/sql");return(0,s.jsx)(o.S,{resizableSidebar:!0,title:a,product:c,...d,"data-sentry-element":"ProjectLayoutWithAuth","data-sentry-component":"EditorBaseLayout","data-sentry-source-file":"EditorBaseLayout.tsx",children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:["table"===x&&h||"sql"===x&&f?(0,s.jsx)("div",{className:(0,l.cn)("h-10 flex items-center",g?"bg-surface-100":"bg-surface-200 dark:bg-alternative"),children:g?(0,s.jsx)(p,{hideTabs:g}):(0,s.jsx)(T,{})}):null,(0,s.jsx)("div",{className:"h-full",children:t})]})})}},16175:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},21292:(e,t,a)=>{a.d(t,{A:()=>b});var s=a(80263),n=a(60045),r=a(98667),i=a(64238),l=a(97318),o=a(53239),c=a(45969),d=a(15665),u=a(65904),m=a(16601),p=a(81250),x=a(98883),h=a(10738),f=a(50854),g=a(83405);let b=e=>{let{className:t,disabled:a=!1,size:b="tiny",showError:y=!0,selectedSchemaName:v,supportSelectAll:j=!1,excludedSchemas:w=[],onSelectSchema:N,onSelectCreateSchema:S}=e,[A,_]=(0,o.useState)(!1),k=(0,u.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:E}=(0,c.Om)(),{data:R,isLoading:T,isSuccess:C,isError:L,error:I,refetch:z}=(0,d.w$)({projectRef:null==E?void 0:E.ref,connectionString:null==E?void 0:E.connectionString}),M=(R||[]).filter(e=>!w.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[T&&(0,s.jsx)(m.$,{type:"default",className:"w-full [&>span]:w-full",size:b,disabled:!0,children:(0,s.jsx)(p.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),y&&L&&(0,s.jsxs)(x.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,s.jsx)(x.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,s.jsxs)(x.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==I?void 0:I.message]}),(0,s.jsx)(m.$,{type:"default",size:"tiny",onClick:()=>z(),children:"Reload schemas"})]}),C&&(0,s.jsxs)(h.AM,{open:A,onOpenChange:_,modal:!1,children:[(0,s.jsx)(h.Wv,{asChild:!0,children:(0,s.jsx)(m.$,{size:b,disabled:a,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,s.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:v?(0,s.jsxs)("div",{className:"w-full flex gap-1",children:[(0,s.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,s.jsx)("p",{className:"text-foreground",children:"*"===v?"All schemas":v})]}):(0,s.jsx)("div",{className:"w-full flex gap-1",children:(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schemaâ€¦"})})})}),(0,s.jsx)(h.hl,{className:"p-0 min-w-[200px]",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,s.jsxs)(f.uB,{children:[(0,s.jsx)(f.G7,{placeholder:"Find schema..."}),(0,s.jsxs)(f.oI,{children:[(0,s.jsx)(f.xL,{children:"No schemas found"}),(0,s.jsx)(f.L$,{children:(0,s.jsxs)(g.FK,{className:(M||[]).length>7?"h-[210px]":"",children:[j&&(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{N("*"),_(!1)},onClick:()=>{N("*"),_(!1)},children:[(0,s.jsx)("span",{children:"All schemas"}),"*"===v&&(0,s.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==M?void 0:M.map(e=>(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{N(e.name),_(!1)},onClick:()=>{N(e.name),_(!1)},children:[(0,s.jsx)("span",{children:e.name}),v===e.name&&(0,s.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==S&&k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.fx,{}),(0,s.jsx)(f.L$,{children:(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{S(),_(!1)},onClick:()=>{S(),_(!1)},children:[(0,s.jsx)(l.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},21355:(e,t,a)=>{a.d(t,{A:()=>x});var s=a(17702),n=a(56947),r=a(53434),i=a.n(r),l=a(53239),o=a(66933),c=a(92589),d=a(3807),u=a(66001),m=a(81028);let p=(e,t)=>(0,l.useMemo)(()=>0!==e.length&&(0,c.l8)(e[0][t])?null==e?void 0:e.map(e=>(e[t]=(0,c.RT)(e[t]),e)):e,[JSON.stringify(e)]),x=function(e){var t,a,r,x,h;let{projectRef:f,table:g,filterOverride:b,limit:y}=e,v=(0,o.Et)(o.Z8),[j,w]=(0,l.useState)(new Date().toISOString()),{timestampStart:N,timestampEnd:S,filters:A,search:_}=(0,u.B)(),k=(0,l.useMemo)(()=>N||v.calcFrom(),[N,v]),E=(0,l.useMemo)(()=>S||v.calcTo(),[S,v]),R=(0,l.useMemo)(()=>({...A,...b,..._?{search_query:_}:{}}),[JSON.stringify(A),JSON.stringify(b),_]),T=(0,l.useMemo)(()=>({project:f,iso_timestamp_start:k,iso_timestamp_end:E,sql:(0,c.qr)(g,R,y)}),[f,k,E,g,R,y]),C=(0,l.useMemo)(()=>["projects",f,"logs",T],[f,T]),{data:L,isSuccess:I,isLoading:z,isRefetching:M,error:D,fetchNextPage:P,isFetchingNextPage:O,refetch:q}=(0,s.q)(C,async e=>{let{signal:t,pageParam:a}=e,{data:s,error:n}=await (0,d.Jt)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:f},query:{...T,iso_timestamp_end:a||T.iso_timestamp_end}},signal:t});if(n)throw n;return s},{refetchOnWindowFocus:!1,getNextPageParam(e){var t,a;if((null!=(a=null==(t=e.result)?void 0:t.length)?a:0)===0)return;let s=e.result.length,{timestamp:n}=e.result[s-1];return i().utc(Number(n/1e3)).toISOString()}}),{logData:W,error:H,oldestTimestamp:F}=(0,l.useMemo)(()=>{var e,t;let a=[],s=D?D.message:null;null==L||null==(e=L.pages)||e.forEach(e=>{(null==e?void 0:e.result)&&(a=[...a,...e.result]),!s&&(null==e?void 0:e.error)&&(s=e.error)});let n=a.length>0?null==(t=a[a.length-1])?void 0:t.timestamp:void 0;return{logData:a,error:s,oldestTimestamp:n}},[null==L?void 0:L.pages]),B=(0,l.useMemo)(()=>(0,c.oZ)(g,R),[g,R]),V=(0,l.useMemo)(()=>["projects",f,"logs-count",{projectRef:f,sql:B,iso_timestamp_start:j,iso_timestamp_end:E,table:g,mergedFilters:R}],[f,B,j,E,g,R]),{data:$}=(0,n.I)(V,async e=>{let{signal:t}=e,{data:a,error:s}=await (0,d.Jt)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:f},query:{project:f,sql:B,iso_timestamp_start:j,iso_timestamp_end:E}},signal:t});if(s)throw s;return a},{refetchOnWindowFocus:!1,refetchInterval:6e4,enabled:!H&&!!L&&(null==L||null==(t=L.pages)?void 0:t.length)>0}),J=null!=(x=null==$||null==(r=$.result)||null==(a=r[0])?void 0:a.count)?x:0,U=(0,l.useMemo)(()=>(0,c.tS)(g,T,R),[g,T,R]),Q=(0,l.useMemo)(()=>["projects",f,"logs-chart",{projectRef:f,sql:U,iso_timestamp_start:k,iso_timestamp_end:E}],[f,U,k,E]),{data:G,refetch:Z}=(0,n.I)(Q,async e=>{let{signal:t}=e,{data:a,error:s}=await (0,d.Jt)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:f},query:{iso_timestamp_start:k,iso_timestamp_end:E,project:f,sql:U}},signal:t});if(s)throw s;return a},{refetchOnWindowFocus:!1}),K=(0,l.useCallback)(async()=>{w(new Date().toISOString()),Z(),q()},[q,Z]),Y=p(null!=(h=null==G?void 0:G.result)?h:[],"timestamp"),{data:X,error:ee}=(0,m.m)(Y,"timestamp","count",0,k,E||new Date().toISOString());return{newCount:J,logData:W,isSuccess:I,isLoading:z||M,isLoadingOlder:O,error:H||ee,filters:R,params:T,oldestTimestamp:F?String(F):void 0,eventChartData:X,refresh:K,loadOlder:()=>P()}}},29819:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]])},34398:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(80263),n=a(53239),r=a(81250);let i=(0,n.memo)(function(){return(0,s.jsx)("div",{className:"px-4 flex flex-col gap-0",children:[{width:"w-40",opacity:"opacity-100"},{width:"w-32",opacity:"opacity-100"},{width:"w-20",opacity:"opacity-75"},{width:"w-40",opacity:"opacity-50"},{width:"w-20",opacity:"opacity-25"}].map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-row h-6 items-center gap-3 ".concat(e.opacity),children:[(0,s.jsx)(r.E,{className:"h-4 w-5"}),(0,s.jsx)(r.E,{className:"h-4 ".concat(e.width)})]},t))})})},34551:(e,t,a)=>{a.d(t,{H:()=>c});var s=a(32144),n=a(80251),r=a(73969),i=a(3807),l=a(3454);async function o(e){let{projectRef:t,connectionString:a,id:s,tables:n,publish_insert:r,publish_update:l,publish_delete:o,publish_truncate:c}=e,d=new Headers;a&&d.set("x-connection-encrypted",a);let u={id:s};void 0!==n&&(u.tables=n),void 0!==r&&(u.publish_insert=r),void 0!==l&&(u.publish_update=l),void 0!==o&&(u.publish_delete=o),void 0!==c&&(u.publish_truncate=c);let{data:m,error:p}=await (0,i.F6)("/platform/pg-meta/{ref}/publications",{params:{header:{"x-connection-encrypted":a},path:{ref:t},query:{id:s}},body:u,headers:d});return p&&(0,i.H4)(p),m}let c=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,s.jE)();return(0,n.n)(e=>o(e),{async onSuccess(t,a,s){let{projectRef:n}=a;await i.invalidateQueries(l.b.list(n)),await (null==e?void 0:e(t,a,s))},async onError(e,a,s){void 0===t?r.oR.error("Failed to update database publication: ".concat(e.message)):t(e,a,s)},...a})}},34994:(e,t,a)=>{a.d(t,{p:()=>l});var s=a(56947),n=a(3807),r=a(71897);async function i(e,t){let{projectRef:a,connectionString:s}=e;if(!a)throw Error("projectRef is required");let r=new Headers;s&&r.set("x-connection-encrypted",s);let{data:i,error:l}=await (0,n.Jt)("/platform/pg-meta/{ref}/types",{params:{header:{"x-connection-encrypted":s},path:{ref:a}},headers:Object.fromEntries(r),signal:t});return l&&(0,n.H4)(l),i}let l=function(e){let{projectRef:t,connectionString:a}=e,{enabled:n=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(r.K.list(t),e=>{let{signal:s}=e;return i({projectRef:t,connectionString:a},s)},{enabled:n&&void 0!==t,...l})}},46635:(e,t,a)=>{a.d(t,{AL:()=>c,J5:()=>u,J_:()=>o,N1:()=>l,aw:()=>d,fX:()=>g,mL:()=>m,mN:()=>p,wB:()=>x,wy:()=>f,x0:()=>h});var s=a(86631),n=a.n(s),r=a(14506),i=a.n(r);let l=["int2","int4","int8","float4","float8","numeric","double precision"],o=["json","jsonb"],c=["text","varchar"],d=["timestamp","timestamptz"],u=["date"],m=["time","timetz"],p=n()(d,u,m),x=["uuid","bool","vector","bytea"],h=i()(n()(l,o,c,p,x)),f={varchar:{alternative:"text",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_varchar.28n.29_by_default"},json:{alternative:"jsonb",reference:"https://www.postgresql.org/docs/current/datatype-json.html"},timetz:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timetz"},timestamp:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timestamp_.28without_time_zone.29"}},g=[{name:"int2",description:"Signed two-byte integer",type:"number"},{name:"int4",description:"Signed four-byte integer",type:"number"},{name:"int8",description:"Signed eight-byte integer",type:"number"},{name:"float4",description:"Single precision floating-point number (4 bytes)",type:"number"},{name:"float8",description:"Double precision floating-point number (8 bytes)",type:"number"},{name:"numeric",description:"Exact numeric of selectable precision",type:"number"},{name:"json",description:"Textual JSON data",type:"json"},{name:"jsonb",description:"Binary JSON data, decomposed",type:"json"},{name:"text",description:"Variable-length character string",type:"text"},{name:"varchar",description:"Variable-length character string",type:"text"},{name:"uuid",description:"Universally unique identifier",type:"text"},{name:"date",description:"Calendar date (year, month, day)",type:"time"},{name:"time",description:"Time of day (no time zone)",type:"time"},{name:"timetz",description:"Time of day, including time zone",type:"time"},{name:"timestamp",description:"Date and time (no time zone)",type:"time"},{name:"timestamptz",description:"Date and time, including time zone",type:"time"},{name:"bool",description:"Logical boolean (true/false)",type:"bool"},{name:"bytea",description:"Variable-length binary string",type:"others"}]},47781:(e,t,a)=>{a.d(t,{K:()=>h,T:()=>b});var s=a(80263),n=a(53239),r=a(3732),i=a(2),l=a(53434),o=a.n(l),c=a(27344),d=a.n(c),u=a(37361),m=a.n(u);o().extend(d()),o().extend(m());let p=e=>o().unix(Number(e)/1e3/1e3).toISOString(),x=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},h=e=>{let{utcTimestamp:t,format:a}=e,s=x(t)?p(t):t;return o().utc(s).local().format(a)},f=e=>{let{utcTimestamp:t,format:a}=e,s=x(t)?p(t):t;return o().utc(s).format(a)},g=e=>{let{utcTimestamp:t}=e,a=x(t)?p(t):t;return o().utc(a).fromNow()},b=e=>{let{utcTimestamp:t,className:a,displayAs:l="local",format:o="DD MMM  HH:mm:ss",labelFormat:c="DD MMM HH:mm:ss"}=e,d=h({utcTimestamp:t,format:o}),u=f({utcTimestamp:t,format:o}),m=g({utcTimestamp:t}),[p,x]=(0,n.useState)("start"),b=(0,n.useRef)(null),y=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,n.useEffect)(()=>{let e=()=>{if(b.current){let e=b.current.getBoundingClientRect(),t=window.innerHeight;x(e.top<t/2?"start":"end")}};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let v=e=>{let{label:t,value:a}=e,[r,l]=(0,n.useState)(!1);return(0,s.jsxs)("div",{onPointerDown:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault(),navigator.clipboard.writeText(a),l(!0),setTimeout(()=>{l(!1)},1e3)},className:(0,i.cn)("relative cursor-pointer flex gap-y-2 gap-x-0.5 hover:bg-surface-100 px-2 py-1 group",{"bg-surface-100":r}),"data-sentry-component":"TooltipRow","data-sentry-source-file":"index.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-2 text-left truncate",children:[(0,s.jsx)("p",{children:t}),(0,s.jsx)("div",{className:"border-t w-full border-dashed"})]}),(0,s.jsxs)("div",{className:"relative flex items-center gap-x-2 flex-grow",children:[(0,s.jsx)("div",{className:"border-t w-full border-dashed z-10"}),r&&(0,s.jsx)("span",{className:"flex items-center justify-end w-full absolute inset-0 flex items-right text-brand-600 bg-surface-100",children:"Copied!"}),(0,s.jsx)("span",{className:"flex items-center gap-x-2 justify-end whitespace-nowrap",children:a})]})]})};return(0,s.jsxs)(r.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"TimestampInfo","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(r.k$,{asChild:!0,ref:b,className:"text-xs ".concat(a," border-b border-transparent hover:border-dashed hover:border-foreground-light"),"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"index.tsx",children:(0,s.jsx)("span",{children:"local"===l?h({utcTimestamp:t,format:c}):f({utcTimestamp:t,format:c})})}),(0,s.jsxs)(r.ZI,{align:p,side:"right",className:"font-mono p-0 py-1 min-w-80","data-sentry-element":"TooltipContent","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(v,{label:"UTC",value:u,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(v,{label:y,value:d,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(v,{label:"Relative",value:m,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(v,{label:"Timestamp",value:String(t),"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"})]})]})}},48552:(e,t,a)=>{a.d(t,{j:()=>c});var s=a(56947),n=a(3807),r=a(83634),i=a(58897),l=a(98621);async function o(e,t,a){let{projectRef:s,connectionString:r,schema:i}=e;if(!s)throw Error("projectRef is required");let l=new Headers(a);r&&l.set("x-connection-encrypted",r);let{data:o,error:c}=await (0,n.Jt)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":r},path:{ref:s},query:{included_schemas:i||"",excluded_schemas:""}},headers:l,signal:t});return c&&(0,n.H4)(c),o}let c=function(e){let{projectRef:t,connectionString:a,schema:n}=e,{enabled:c=!0,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=(0,r.KT)(),m=(null==u?void 0:u.status)===i.BU.ACTIVE_HEALTHY;return(0,s.I)(l.S.list(t,n),e=>{let{signal:s}=e;return o({projectRef:t,connectionString:a,schema:n},s)},{enabled:c&&void 0!==t&&m,...d})}},49257:(e,t,a)=>{a.d(t,{k:()=>s});let s={list:e=>["projects",e,"views"],listBySchema:(e,t)=>[...s.list(e),t]}},50205:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},58604:(e,t,a)=>{a.d(t,{L:()=>d});var s=a(80263),n=a(33096),r=a(27321),i=a(64773),l=a(40435),o=a(52491),c=a(2);let d=e=>{var t,a,d;let{type:u,size:m=15,strokeWidth:p=1.5,isActive:x}=e;return"sql"===u?(0,s.jsx)(o.ty,{size:m,className:(0,c.cn)("transition-colors","fill-foreground-muted","group-aria-selected:fill-foreground","w-4 h-4","-ml-0.5"),strokeWidth:p}):u===n.z.TABLE?(0,s.jsx)(r.A,{size:m,strokeWidth:p,className:(0,c.cn)("text-foreground-muted group-hover:text-foreground-lighter group-aria-selected:text-foreground",x&&"text-foreground-light","transition-colors")}):"schema"===u?(0,s.jsx)(i.A,{size:m,strokeWidth:p}):u===n.z.VIEW?(0,s.jsx)(l.A,{size:m,strokeWidth:p,className:(0,c.cn)("text-foreground-muted group-hover:text-foreground-lighter",x&&"text-foreground-lighter","transition-colors")}):(0,s.jsx)("div",{className:(0,c.cn)("flex items-center justify-center text-xs h-4 w-4 rounded-[2px] font-bold",u===n.z.FOREIGN_TABLE&&"text-yellow-900 bg-yellow-500",u===n.z.MATERIALIZED_VIEW&&"text-purple-1000 bg-purple-500",u===n.z.PARTITIONED_TABLE&&"text-foreground-light bg-border-stronger"),"data-sentry-component":"EntityTypeIcon","data-sentry-source-file":"EntityTypeIcon.tsx",children:null==(d=Object.entries(n.z).find(e=>{let[,t]=e;return t===u}))||null==(a=d[0])||null==(t=a[0])?void 0:t.toUpperCase()})}},60334:(e,t,a)=>{a.d(t,{A:()=>o});var s=a(80263),n=a(53239),r=a(55335),i=a(80109),l=a(16601);let o=e=>{let{visible:t=!1,danger:a=!1,title:o="",description:c="",size:d="small",buttonLabel:u="",buttonLoadingLabel:m="",onSelectCancel:p=()=>{},onSelectConfirm:x=()=>{}}=e;(0,n.useEffect)(()=>{t&&f(!1)},[t]);let[h,f]=(0,n.useState)(!1),g=()=>{f(!0),x()};return(0,s.jsx)(r.A,{header:o,visible:t,title:o,description:c,size:d,hideFooter:!0,onCancel:p,"data-sentry-element":"Modal","data-sentry-component":"ConfirmModal","data-sentry-source-file":"ConfirmDialog.tsx",children:(0,s.jsx)(i.A,{initialValues:{},validateOnBlur:!0,onSubmit:()=>g(),validate:()=>[],"data-sentry-element":"Form","data-sentry-source-file":"ConfirmDialog.tsx",children:()=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(r.A.Content,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.$,{block:!0,htmlType:"button",type:"default",onClick:p,disabled:h,children:"Cancel"}),(0,s.jsx)(l.$,{htmlType:"submit",block:!0,type:a?"danger":"primary",disabled:h,loading:h,children:m&&h?m:u||"Confirm"})]})})})})})}},63004:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},66001:(e,t,a)=>{a.d(t,{B:()=>l});var s=a(25222);let n={search:"",timestampStart:"",timestampEnd:"",filters:{}},r=e=>(0,s.Cp)({parse:t=>null!=t?t:e,serialize:e=>e||""}),i=e=>(0,s.Cp)({parse:t=>{if(!t)return e;try{return JSON.parse(t)}catch(t){return e}},serialize:e=>{if(!e)return"";try{return JSON.stringify(e)}catch(e){return""}}});function l(){let[e,t]=(0,s.ZA)("s",r(n.search)),[a,l]=(0,s.ZA)("its",r(n.timestampStart)),[o,c]=(0,s.ZA)("ite",r(n.timestampEnd)),[d,u]=(0,s.ZA)("log",r("")),[m,p]=(0,s.ZA)("f",i(n.filters)),x=e||n.search,h=a||n.timestampStart,f=o||n.timestampEnd,g=m||n.filters,b=e=>{t(e||n.search)},y=e=>{p(e||n.filters)};return{search:x,timestampStart:h,timestampEnd:f,selectedLogId:d||null,filters:g,setSearch:b,setTimeRange:(e,t)=>{l(e||n.timestampStart),c(t||n.timestampEnd)},setSelectedLogId:e=>{u(e||"")},setFilters:y,updateFilter:(e,t)=>{y({...g,[e]:t})},reset:()=>{b(n.search),l(n.timestampStart),c(n.timestampEnd),u(""),p(n.filters)}}}},68280:(e,t,a)=>{a.d(t,{_:()=>l});var s=a(56947),n=a(3807),r=a(3454);async function i(e,t){let{projectRef:a,connectionString:s}=e;if(!a)throw Error("projectRef is required");let r=new Headers;s&&r.set("x-connection-encrypted",s);let{data:i,error:l}=await (0,n.Jt)("/platform/pg-meta/{ref}/publications",{params:{header:{"x-connection-encrypted":s},path:{ref:a}},headers:r,signal:t});return l&&(0,n.H4)(l),i}let l=function(e){let{projectRef:t,connectionString:a}=e,{enabled:n=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(r.b.list(t),e=>{let{signal:s}=e;return i({projectRef:t,connectionString:a},s)},{enabled:n&&void 0!==t,...l})}},69223:(e,t,a)=>{a.d(t,{S:()=>n,t:()=>s});let s=(e,t,a,s,n)=>{let r=(null==s?void 0:s.find(s=>{var r,i;return(null==s||null==(r=s.metadata)?void 0:r.name)===e&&(null==s||null==(i=s.metadata)?void 0:i.schema)===n&&(null==s?void 0:s.name)===t&&a.includes(null==s?void 0:s.level)}))||null;return{hasLint:null!==r,count:+!!r,matchingLint:r}},n=(e,t)=>{if(0===t.length)return"";let a=e.columns.map(e=>'"'.concat(e.name,'"')).join(", "),s=t.map(t=>{let a={...t};"idx"in a&&delete a.idx;let s=Object.entries(a).map(t=>{var a;let[s,n]=t,{dataType:r,format:i}=null!=(a=e.columns.find(e=>e.name===s))?a:{};return null===n?"null":"ARRAY"===r?"'".concat(JSON.stringify(n).replace("[","{").replace(/.$/,"}"),"'"):(null==i?void 0:i.includes("json"))?"".concat(JSON.stringify(n).replace(/\\"/g,'"').replace(/'/g,"''").replace('"',"'").replace(/.$/,"'")):"'".concat(n,"'")});return"(".concat(s.join(", "),")")}).join(", ");return'INSERT INTO "'.concat(e.schema,'"."').concat(e.name,'" (').concat(a,") VALUES ").concat(s,";")}},70639:(e,t,a)=>{a.d(t,{Ay:()=>l});var s=a(80263),n=a(90709);a(53239);var r=a(77690);let i=e=>{let{open:t,children:a,className:r,...i}=e;return(0,s.jsx)(n.bL,{asChild:i.asChild,defaultOpen:i.defaultOpen,open:t,onOpenChange:i.onOpenChange,disabled:i.disabled,className:r,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:a})};i.Trigger=function(e){let{children:t,asChild:a}=e;return(0,s.jsx)(n.l9,{asChild:a,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},i.Content=function(e){let{asChild:t,children:a,className:i}=e,l=(0,r.A)("collapsible");return(0,s.jsx)(n.UC,{asChild:t,className:[l.content,i].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:a})};let l=i},71391:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]])},78294:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]])},78960:(e,t,a)=>{a.d(t,{g:()=>i,w:()=>r});var s=a(10497),n=a(79175);let r=e=>{var t,a;let{ref:r,schemas:i,entities:l}=e,o=l.map(e=>(0,n.lW)(e.type,{id:e.id})),c=(0,s.PR)(r),d=[];for(let e of i)d.push(...null==c||null==(t=c.items)?void 0:t.filter(t=>{var a;return(null==(a=t.metadata)?void 0:a.schema)===e}).map(e=>e.id));let u=[...d.filter(e=>!o.includes(e))];(0,s.Yg)(r,u);let m=(0,n.IT)(r),p=[];for(let e of i)p.push(...null==m||null==(a=m.openTabs)?void 0:a.filter(t=>{var a;return(null==(a=m.tabsMap[t].metadata)?void 0:a.schema)===e}));let x=[...p.filter(e=>!e.startsWith("sql")&&!e.startsWith("schema")&&!o.includes(e))];(0,n.Xn)(r,x),m.openTabs.map(e=>m.tabsMap[e]).filter(e=>{var t;return null==(t=n.qm.table)?void 0:t.includes(e.type)}).forEach(e=>{let t=null==l?void 0:l.find(t=>{var a;return(null==(a=e.metadata)?void 0:a.tableId)===t.id});t&&t.name!==e.label&&(0,n.Nt)(r,e.id,{label:t.name})})},i=e=>{let{ref:t,snippets:a}=e,r=[...a.filter(e=>"sql"===e.type).map(e=>(0,n.lW)("sql",{id:e.id})),"sql-templates","sql-quickstarts"],i=(0,n.IT)(t),l=i.openTabs.filter(e=>e.startsWith("sql")&&!r.includes(e));(0,n.Xn)(t,l);let o=(0,s.Nq)(t,"sql");(0,s.Yg)(t,o?o.filter(e=>!r.includes(e.id)).map(e=>e.id):[]),i.openTabs.map(e=>i.tabsMap[e]).filter(e=>{var t;return null==(t=n.qm.sql)?void 0:t.includes(e.type)}).forEach(e=>{let s=null==a?void 0:a.find(t=>{var a;return(null==(a=e.metadata)?void 0:a.sqlId)===t.id});s&&s.name!==e.label&&(0,n.Nt)(t,e.id,{label:s.name})})}},81028:(e,t,a)=>{a.d(t,{m:()=>r});var s=a(92589),n=a(53239);let r=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.useMemo)(()=>{var e;let[a,n]=t;if(!(null==(e=a[0])?void 0:e[n]))return{data:a,error:void 0,isError:!1};try{return{data:(0,s.mu)(...t).sort((e,a)=>new Date(e[t[1]])-new Date(a[t[1]])),error:void 0,isError:!1}}catch(e){return{data:[],error:e,isError:!0}}},[JSON.stringify(t[0]),...t])}},82260:(e,t,a)=>{a.d(t,{G_:()=>o});var s=a(56947),n=a(77570),r=a(68324);let i=e=>{let{id:t}=e;if(!t)throw Error("id is required");return"\n    with table_info as (\n      select \n        n.nspname::text as schema,\n        c.relname::text as name,\n        to_regclass(concat('\"', n.nspname, '\".\"', c.relname, '\"')) as regclass\n      from pg_class c\n      join pg_namespace n on n.oid = c.relnamespace\n      where c.oid = ".concat(t,"\n    )\n    select pg_get_viewdef(t.regclass, true) as definition\n    from table_info t\n  ").trim()};async function l(e,t){let{projectRef:a,connectionString:s,id:r}=e,l=i({id:r}),{result:o}=await (0,n.E)({projectRef:a,connectionString:s,sql:l,queryKey:["view-definition",r]},t);return o[0].definition.trim()}let o=function(e){let{projectRef:t,connectionString:a,id:n}=e,{enabled:i=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(r.c.viewDefinition(t,n),e=>{let{signal:s}=e;return l({projectRef:t,connectionString:a,id:n},s)},{enabled:i&&void 0!==t&&void 0!==n&&!isNaN(n),...o})}},83745:(e,t,a)=>{a.d(t,{Jv:()=>eu,RH:()=>em,Ay:()=>ep});var s=a(80263),n=a(60045),r=a(95137),i=a.n(r),l=a(68656),o=a(47136),c=a(16175),d=a(94328),u=a(63320),m=a.n(u),p=a(77191),x=a.n(p),h=a(53239),f=a(73969),g=a(82489),b=a(5942),y=a(50205),v=a(26629),j=a(19692);let w=(0,a(47370).A)("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);var N=a(69223),S=a(45969),A=a(28071),_=a(79319),k=a(48552),E=a(68280),R=a(34551),T=a(88688),C=a(97195),L=a(87662),I=a(36567),z=a(65904),M=a(45479),D=a(25718),P=a(36365),O=a(38041),q=a(3732),W=a(16601),H=a(2),F=a(10738),B=a(60334),V=a(36212),$=a(49440),J=a(32144),U=a(82260),Q=a(70600),G=a(23957),Z=a(83405),K=a(13947),Y=a(62719);function X(e){let{table:t,isAutofixViewSecurityModalOpen:a,setIsAutofixViewSecurityModalOpen:n}=e,{project:r}=(0,S.Om)(),i=(0,J.jE)(),{isSuccess:l,isLoading:o,data:c}=(0,U.G_)({id:null==t?void 0:t.id,projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString},{enabled:a&&(0,C.b4)(t)}),{mutate:d}=(0,G.Y)({onSuccess:async()=>{f.oR.success("View security changed successfully"),n(!1),await i.invalidateQueries(Q.O.lint(null==r?void 0:r.ref))},onError:e=>{f.oR.error("Failed to autofix view security: ".concat(e.message))}});return(0,C.b4)(t)?(0,s.jsxs)(V.A,{visible:a,size:"xlarge",title:"Confirm autofixing view security",confirmLabel:"Confirm",onCancel:()=>n(!1),onConfirm:()=>(function(){let e='\n	ALTER VIEW "'.concat(t.schema,'"."').concat(t.name,'" SET (security_invoker = on);\n	');d({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,sql:e})})(),"data-sentry-element":"ConfirmationModal","data-sentry-component":"ViewEntityAutofixSecurityModal","data-sentry-source-file":"ViewEntityAutofixSecurityModal.tsx",children:[(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Setting ",(0,s.jsx)("code",{children:"security_invoker=on"})," ensures the View runs with the permissions of the querying user, reducing the risk of unintended data exposure."]}),(0,s.jsxs)("div",{className:"flex items-center gap-8 mt-8",children:[(0,s.jsxs)("div",{className:" border rounded-md w-1/2",children:[(0,s.jsx)("div",{className:"p-4 pb-0 bg-200 font-mono text-sm font-semibold",children:"Existing query"}),(0,s.jsxs)(Z.FK,{className:"h-[225px] px-4 py-2","data-sentry-element":"ScrollArea","data-sentry-source-file":"ViewEntityAutofixSecurityModal.tsx",children:[o&&(0,s.jsx)(Y.y,{}),l&&(0,s.jsx)(K.X,{children:"create view ".concat(t.schema,".").concat(t.name," as\n ").concat(c)})]})]}),(0,s.jsxs)("div",{className:" border rounded-md w-1/2",children:[(0,s.jsx)("div",{className:"p-4 pb-0 bg-200 font-mono text-sm font-semibold",children:"Updated query"}),(0,s.jsxs)(Z.FK,{className:"h-[225px] px-4 py-2","data-sentry-element":"ScrollArea","data-sentry-source-file":"ViewEntityAutofixSecurityModal.tsx",children:[o&&(0,s.jsx)(Y.y,{}),l&&(0,s.jsx)(K.X,{children:"create view ".concat(t.schema,".").concat(t.name," with (security_invoker = on) as\n ").concat(c)})]})]})]})]}):null}let ee=e=>{var t;let{table:a}=e,{ref:r}=(0,g.g)(),{project:i}=(0,S.Om)(),l=(0,D.a)(),{data:o=[]}=(0,T.b)({projectRef:null==i?void 0:i.ref}),c=(0,C.KO)(a),d=(0,C.bL)(a),u=(0,C.eg)(a),p=(0,C.rW)(a),x=(0,M.x)("realtime:all"),b=P.i.includes(a.schema),{mutate:J}=(0,L.e)({onError:e=>{f.oR.error("Failed to toggle RLS: ".concat(e.message))},onSettled:()=>{ey()}}),[U,Q]=(0,h.useState)(!1),[G,Z]=(0,h.useState)(!1),[K,Y]=(0,h.useState)(!1),ee=0===(0,O.Ir)().selectedRows.size,et=null==i?void 0:i.ref,{data:ea}=(0,k.j)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString}),es=(null!=ea?ea:[]).filter(e=>e.schema===a.schema&&e.table===a.name),{data:en}=(0,E._)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString}),er=(null!=en?en:[]).find(e=>"supabase_realtime"===e.name),ei=null!=(t=null==er?void 0:er.tables)?t:[],el=ei.some(e=>e.id===(null==a?void 0:a.id)),{mutate:eo,isLoading:ec}=(0,R.H)({onSuccess:()=>{Q(!1)},onError:e=>{f.oR.error("Failed to toggle realtime for ".concat(a.name,": ").concat(e.message))}}),ed=(0,z.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"tables"),eu=(0,z.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"columns"),em="public"===a.schema,{hasLint:ep,matchingLint:ex}=(0,N.t)(a.name,"security_definer_view",["ERROR","WARN"],o,a.schema),{hasLint:eh,matchingLint:ef}=(0,N.t)(a.name,"materialized_view_in_api",["ERROR","WARN"],o,a.schema),{mutate:eg}=(0,I.h)(),eb=async()=>{var e,t;if(!i)return console.error("Project is required");if(!er)return console.error("Unable to find realtime publication");let s=ei.some(e=>e.id==a.id),n=s?ei.filter(e=>e.id!=a.id).map(e=>"".concat(e.schema,".").concat(e.name)):["".concat(a.schema,".").concat(a.name)].concat(ei.map(e=>"".concat(e.schema,".").concat(e.name)));eg({action:"realtime_toggle_table_clicked",properties:{newState:s?"disabled":"enabled",origin:"tableGridHeader"},groups:{project:null!=(e=null==i?void 0:i.ref)?e:"Unknown",organization:null!=(t=null==l?void 0:l.slug)?t:"Unknown"}}),eo({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,id:er.id,tables:n})},ey=()=>{Z(!1)},ev=async()=>{let e={id:a.id,rls_enabled:!(c&&a.rls_enabled)};J({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,id:e.id,schema:a.schema,payload:e})};return(0,s.jsxs)("div",{className:"sb-grid-header__inner","data-sentry-component":"GridHeaderActions","data-sentry-source-file":"GridHeaderActions.tsx",children:[ee&&(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[!ed&&!eu&&(0,s.jsxs)(q.m_,{children:[(0,s.jsx)(q.k$,{asChild:!0,children:(0,s.jsx)("div",{className:"border border-strong rounded bg-overlay-hover px-3 py-1 text-xs",children:"Viewing as read-only"})}),(0,s.jsx)(q.ZI,{side:"bottom",children:"You need additional permissions to manage your project's data"})]}),c&&!b?a.rls_enabled?(0,s.jsx)(s.Fragment,{children:es.length<1&&!b?(0,s.jsx)(_.G,{asChild:!0,type:"default",className:"group",icon:(0,s.jsx)(y.A,{strokeWidth:1.5,className:"text-foreground-muted"}),tooltip:{content:{side:"bottom",className:"w-[280px]",text:"RLS is enabled for this table, but no policies are set. Select queries may return 0 results."}},children:(0,s.jsx)(m(),{passHref:!0,href:"/project/".concat(et,"/auth/policies?search=").concat(a.id,"&schema=").concat(a.schema),children:"Add RLS policy"})}):(0,s.jsx)(W.$,{asChild:!0,type:es.length<1&&!b?"warning":"default",className:"group",icon:b||es.length>0?(0,s.jsx)("div",{className:(0,H.cn)("flex items-center justify-center rounded-full bg-border-stronger h-[16px]",es.length>9?" px-1":"w-[16px]",""),children:(0,s.jsx)("span",{className:"text-[11px] text-foreground font-mono text-center",children:es.length})}):(0,s.jsx)(y.A,{strokeWidth:1.5}),children:(0,s.jsxs)(m(),{passHref:!0,href:"/project/".concat(et,"/auth/policies?search=").concat(a.id,"&schema=").concat(a.schema),children:["Auth ",es.length>1?"policies":"policy"]})})}):(0,s.jsxs)(F.AM,{modal:!1,children:[(0,s.jsx)(F.Wv,{asChild:!0,children:(0,s.jsx)(W.$,{type:"warning",icon:(0,s.jsx)(v.A,{strokeWidth:1.5}),children:"RLS disabled"})}),(0,s.jsxs)(F.hl,{portal:!0,className:"min-w-[395px] text-sm",align:"end",children:[(0,s.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.A,{size:16})," Row Level Security (RLS)"]}),(0,s.jsxs)("div",{className:"grid gap-2 mt-4 text-foreground-light text-sm",children:[(0,s.jsx)("p",{children:"You can restrict and control who can read, write and update data in this table using Row Level Security."}),(0,s.jsx)("p",{children:"With RLS enabled, anonymous users will not be able to read/write data in the table."}),!b&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(W.$,{type:"default",onClick:()=>Z(!G),children:"Enable RLS for this table"})})]})]})]}):null,u&&ep&&(0,s.jsxs)(F.AM,{modal:!1,children:[(0,s.jsx)(F.Wv,{asChild:!0,children:(0,s.jsx)(W.$,{type:"warning",icon:(0,s.jsx)(j.A,{strokeWidth:1.5}),children:"Security Definer view"})}),(0,s.jsxs)(F.hl,{portal:!0,className:"min-w-[395px] text-sm",align:"end",children:[(0,s.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{size:16})," Secure your View"]}),(0,s.jsxs)("div",{className:"grid gap-2 mt-4 text-foreground-light text-sm",children:[(0,s.jsx)("p",{children:"This view is defined with the Security Definer property, giving it permissions of the view's creator (Postgres), rather than the permissions of the querying user."}),(0,s.jsx)("p",{children:"Since this view is in the public schema, it is accessible via your project's APIs."}),(0,s.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,s.jsx)(W.$,{type:"secondary",onClick:()=>{Y(!0)},children:"Autofix"}),(0,s.jsx)(W.$,{type:"default",asChild:!0,children:(0,s.jsx)(m(),{target:"_blank",href:"/project/".concat(r,"/advisors/security?preset=").concat(null==ex?void 0:ex.level,"&id=").concat(null==ex?void 0:ex.cache_key),children:"Learn more"})})]})]})]})]}),p&&eh&&(0,s.jsxs)(F.AM,{modal:!1,children:[(0,s.jsx)(F.Wv,{asChild:!0,children:(0,s.jsx)(W.$,{type:"warning",icon:(0,s.jsx)(j.A,{strokeWidth:1.5}),children:"Security Definer view"})}),(0,s.jsxs)(F.hl,{portal:!0,className:"min-w-[395px] text-sm",align:"end",children:[(0,s.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{size:16})," Secure your View"]}),(0,s.jsxs)("div",{className:"grid gap-2 mt-4 text-foreground-light text-sm",children:[(0,s.jsx)("p",{children:"This view is defined with the Security Definer property, giving it permissions of the view's creator (Postgres), rather than the permissions of the querying user."}),(0,s.jsx)("p",{children:"Since this view is in the public schema, it is accessible via your project's APIs."}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(W.$,{type:"default",asChild:!0,children:(0,s.jsx)(m(),{target:"_blank",href:"/project/".concat(r,"/advisors/security?preset=").concat(null==ef?void 0:ef.level,"&id=").concat(null==ef?void 0:ef.cache_key),children:"Learn more"})})})]})]})]}),d&&"public"===a.schema&&(0,s.jsxs)(F.AM,{modal:!1,children:[(0,s.jsx)(F.Wv,{asChild:!0,children:(0,s.jsx)(W.$,{type:"warning",icon:(0,s.jsx)(j.A,{strokeWidth:1.5}),children:"Unprotected Data API access"})}),(0,s.jsxs)(F.hl,{portal:!0,className:"min-w-[395px] text-sm",align:"end",children:[(0,s.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{size:16})," Secure Foreign table"]}),(0,s.jsxs)("div",{className:"grid gap-2 mt-4 text-foreground-light text-sm",children:[(0,s.jsxs)("p",{children:["Foreign tables do not enforce RLS, which may allow unrestricted access. To secure them, either move foreign tables to a private schema not exposed by PostgREST, or ",(0,s.jsx)("a",{href:"",children:"disable PostgREST access"})," entirely."]}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(W.$,{type:"default",asChild:!0,children:(0,s.jsx)(m(),{target:"_blank",href:"https://supabase.com/docs/guides/database/extensions/wrappers/overview#security",children:"Learn more"})})})]})]})]}),(0,s.jsx)($.g,{serviceRoleLabel:"postgres"}),c&&x&&(0,s.jsxs)(W.$,{type:"default",icon:(0,s.jsx)(w,{strokeWidth:1.5,className:el?"text-brand":"text-foreground-muted"}),onClick:()=>Q(!0),children:["Realtime ",el?"on":"off"]}),em&&(0,s.jsx)(A.A,{section:["entities",a.name]})]}),(0,s.jsx)(V.A,{visible:U,loading:ec,title:"".concat(el?"Disable":"Enable"," realtime for ").concat(a.name),confirmLabel:"".concat(el?"Disable":"Enable"," realtime"),confirmLabelLoading:"".concat(el?"Disabling":"Enabling"," realtime"),onCancel:()=>Q(!1),onConfirm:()=>eb(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"GridHeaderActions.tsx",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm",children:["Once realtime has been ",el?"disabled":"enabled",", the table will"," ",el?"no longer ":"","broadcast any changes to authorized subscribers."]}),!el&&(0,s.jsxs)("p",{className:"text-sm",children:["You may also select which events to broadcast to subscribers on the"," ",(0,s.jsx)(m(),{href:"/project/".concat(r,"/database/publications"),className:"text-brand",children:"database publications"})," ","settings."]})]})}),(0,s.jsx)(X,{table:a,isAutofixViewSecurityModalOpen:K,setIsAutofixViewSecurityModalOpen:Y,"data-sentry-element":"ViewEntityAutofixSecurityModal","data-sentry-source-file":"GridHeaderActions.tsx"}),c&&(0,s.jsx)(B.A,{danger:a.rls_enabled,visible:G,title:"Confirm to enable Row Level Security",description:"Are you sure you want to enable Row Level Security for this table?",buttonLabel:"Enable RLS",buttonLoadingLabel:"Updating",onSelectCancel:ey,onSelectConfirm:ev})]})};var et=a(2628),ea=a(41518),es=a(45732),en=a(29127),er=a(9594),ei=a(33656),el=a(92974),eo=a(16580),ec=a(41647),ed=a(87890);let eu=5e5,em=(0,s.jsxs)(s.Fragment,{children:["Sorry! We're unable to support exporting row counts larger than $",eu.toLocaleString()," at the moment. Alternatively, you may consider using",(0,s.jsx)(m(),{href:"https://supabase.com/docs/reference/cli/supabase-db-dump",target:"_blank",children:"pg_dump"})," ","via our CLI instead."]}),ep=e=>{let{sorts:t,filters:a,customHeader:n}=e,r=(0,O.Ir)();return(0,s.jsx)("div",{"data-sentry-component":"Header","data-sentry-source-file":"Header.tsx",children:(0,s.jsxs)("div",{className:"flex h-10 items-center justify-between bg-dash-sidebar dark:bg-surface-100 px-1.5 py-1.5 gap-2 overflow-x-auto ",children:[n?(0,s.jsx)(s.Fragment,{children:n}):(0,s.jsx)(s.Fragment,{children:r.selectedRows.size>0?(0,s.jsx)(eh,{sorts:t,filters:a}):(0,s.jsx)(ex,{})}),(0,s.jsx)(ee,{table:r.originalTable,"data-sentry-element":"GridHeaderActions","data-sentry-source-file":"Header.tsx"})]})})},ex=()=>{var e;let{ref:t}=(0,g.g)(),a=(0,er.ap)(),r=(0,O.Ir)(),i=(0,D.a)(),d=r.editable&&(null!=(e=r.table.columns)?e:[]).length>0?a.onAddRow:void 0,u=r.editable?a.onAddColumn:void 0,m=r.editable?a.onImportData:void 0,p=(0,z.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"columns"),{filters:x,sorts:f,setParams:y}=(0,es.o)(),v=(0,h.useCallback)(e=>{r.setEnforceExactCount(!1),r.setPage(1);let a=(0,b.E9)(e);y(e=>({filter:a,sort:e.sort})),t&&(0,b.$S)({projectRef:t,tableName:r.table.name,schema:r.table.schema,filters:a})},[t,r.table.name,r.table.schema,y]),j=(0,h.useCallback)(e=>{let a=(0,b.Aw)(e);y(e=>({filter:e.filter,sort:a})),t&&(0,b.$S)({projectRef:t,tableName:r.table.name,schema:r.table.schema,sorts:a})},[t,r.table.name,r.table.schema,y]),{mutate:w}=(0,I.h)();return(0,s.jsxs)("div",{className:"flex items-center gap-4","data-sentry-component":"DefaultHeader","data-sentry-source-file":"Header.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(ec.A,{filters:x,onApplyFilters:v,"data-sentry-element":"FilterPopover","data-sentry-source-file":"Header.tsx"}),(0,s.jsx)(ed.c,{sorts:f,onApplySorts:j,"data-sentry-element":"SortPopover","data-sentry-source-file":"Header.tsx"})]}),(void 0!==d||void 0!==u)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-[20px] w-px border-r border-control"}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:p&&(0,s.jsxs)(ei.rI,{children:[(0,s.jsx)(ei.ty,{asChild:!0,children:(0,s.jsx)(W.$,{"data-testid":"table-editor-insert-new-row",type:"primary",size:"tiny",icon:(0,s.jsx)(l.A,{strokeWidth:1.5}),children:"Insert"})}),(0,s.jsx)(ei.SQ,{side:"bottom",align:"start",children:[...void 0!==d?[(0,s.jsxs)(ei._2,{className:"group space-x-2",onClick:d,children:[(0,s.jsxs)("div",{className:"-mt-2 pr-1.5",children:[(0,s.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px]"}),(0,s.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px] my-[2px]"}),(0,s.jsx)("div",{className:(0,H.cn)(["border border-foreground-light w-[15px] h-[4px] translate-x-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-x-0"])})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Insert row"}),(0,s.jsxs)("p",{className:"text-foreground-light",children:["Insert a new row into ",r.table.name]})]})]},"add-row")]:[],...void 0!==u?[(0,s.jsxs)(ei._2,{className:"group space-x-2",onClick:u,children:[(0,s.jsxs)("div",{className:"flex -mt-2 pr-1.5",children:[(0,s.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px]"}),(0,s.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px] mx-[2px]"}),(0,s.jsx)("div",{className:(0,H.cn)(["border border-foreground-light w-[4px] h-[15px] -translate-y-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-y-0"])})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Insert column"}),(0,s.jsxs)("p",{className:"text-foreground-light",children:["Insert a new column into ",r.table.name]})]})]},"add-column")]:[],...void 0!==m?[(0,s.jsxs)(ei._2,{className:"group space-x-2",onClick:()=>{var e;m(),w({action:"import_data_button_clicked",properties:{tableType:"Existing Table"},groups:{project:null!=t?t:"Unknown",organization:null!=(e=null==i?void 0:i.slug)?e:"Unknown"}})},children:[(0,s.jsxs)("div",{className:"relative -mt-2",children:[(0,s.jsx)(o.A,{size:18,strokeWidth:1.5,className:"-translate-x-[2px]"}),(0,s.jsx)(c.A,{className:(0,H.cn)("transition duration-200 absolute bottom-0 right-0 translate-y-1 opacity-0 bg-brand-400 rounded-full","group-data-[highlighted]:translate-y-0 group-data-[highlighted]:text-brand group-data-[highlighted]:opacity-100"),strokeWidth:3,size:12})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Import data from CSV"}),(0,s.jsx)("p",{className:"text-foreground-light",children:"Insert new rows from a CSV"})]})]},"import-data")]:[]]})]})})]})]})},eh=e=>{var t,a;let{sorts:n,filters:r}=e,{project:o}=(0,S.Om)(),c=(0,er.ap)(),u=(0,O.Ir)(),m=(0,en.RY)(),p=void 0!==m.role,[g,b]=(0,h.useState)(!1),{data:y}=(0,ea.vs)({projectRef:null==o?void 0:o.ref,connectionString:null==o?void 0:o.connectionString,tableId:u.table.id,sorts:n,filters:r,page:u.page,limit:c.rowsPerPage,roleImpersonationState:m}),{data:v}=(0,et.gt)({projectRef:null==o?void 0:o.ref,connectionString:null==o?void 0:o.connectionString,tableId:u.table.id,filters:r,enforceExactCount:u.enforceExactCount,roleImpersonationState:m},{keepPreviousData:!0}),j=null!=(t=null==y?void 0:y.rows)?t:[],w=null!=(a=null==v?void 0:v.count)?a:0,A=()=>{u.setSelectedRows(new Set(j.map(e=>e.idx)),!0)};async function k(){if(b(!0),u.allRowsSelected&&w>eu)return f.oR.error((0,s.jsx)("div",{className:"prose text-sm text-foreground",children:em})),b(!1);if(!o)return f.oR.error("Project is required"),b(!1);let e=u.allRowsSelected?(0,f.oR)((0,s.jsx)(el.t,{progress:0,message:"Exporting all rows from ".concat(u.table.name)}),{closeButton:!1,duration:1/0}):f.oR.loading("Exporting ".concat(u.selectedRows.size," row").concat(u.selectedRows.size>1?"s":""," from ").concat(u.table.name)),t=u.allRowsSelected?await (0,ea.HQ)({projectRef:o.ref,connectionString:o.connectionString,table:u.table,filters:r,sorts:n,roleImpersonationState:m,progressCallback:t=>{let a=Math.min(t/w*100,100);(0,f.oR)((0,s.jsx)(el.t,{progress:a,message:"Exporting all rows from ".concat(u.table.name)}),{id:e,closeButton:!1,duration:1/0})}}):j.filter(e=>u.selectedRows.has(e.idx));if(0===t.length){f.oR.dismiss(e),f.oR.error("Export failed, please try exporting again"),b(!1);return}let a=t.map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e)),l=new Blob([x().unparse(a,{columns:u.table.columns.map(e=>e.name)})],{type:"text/csv;charset=utf-8;"});f.oR.success("Downloaded ".concat(t.length," rows to CSV"),{id:e,closeButton:!0,duration:4e3}),i()(l,"".concat(u.table.name,"_rows.csv")),b(!1)}async function E(){if(b(!0),u.allRowsSelected&&w>eu)return f.oR.error((0,s.jsx)("div",{className:"prose text-sm text-foreground",children:em})),b(!1);if(!o)return f.oR.error("Project is required"),b(!1);if(u.allRowsSelected&&0===w)return f.oR.error("Export failed, please try exporting again"),b(!1);let e=u.allRowsSelected?(0,f.oR)((0,s.jsx)(el.t,{progress:0,message:"Exporting all rows from ".concat(u.table.name)}),{closeButton:!1,duration:1/0}):f.oR.loading("Exporting ".concat(u.selectedRows.size," row").concat(u.selectedRows.size>1?"s":""," from ").concat(u.table.name)),t=u.allRowsSelected?await (0,ea.HQ)({projectRef:o.ref,connectionString:o.connectionString,table:u.table,filters:r,sorts:n,roleImpersonationState:m,progressCallback:t=>{let a=Math.min(t/w*100,100);(0,f.oR)((0,s.jsx)(el.t,{progress:a,message:"Exporting all rows from ".concat(u.table.name)}),{id:e,closeButton:!1,duration:1/0})}}):j.filter(e=>u.selectedRows.has(e.idx));if(0===t.length){f.oR.error("Export failed, please exporting try again"),b(!1);return}let a=new Blob([(0,N.S)(u.table,t)],{type:"text/sql;charset=utf-8;"});f.oR.success("Downloading ".concat(t.length," rows to SQL"),{id:e,closeButton:!0,duration:4e3}),i()(a,"".concat(u.table.name,"_rows.sql")),b(!1)}return(0,en.sc)(()=>{(u.allRowsSelected||u.selectedRows.size>0)&&u.setSelectedRows(new Set)}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2","data-sentry-component":"RowHeader","data-sentry-source-file":"Header.tsx",children:[u.editable&&(0,s.jsx)(_.G,{type:"default",size:"tiny",icon:(0,s.jsx)(d.A,{}),onClick:()=>{let e=u.allRowsSelected?w:u.selectedRows.size,t=Array.from(u.selectedRows),a=j.filter(e=>t.includes(e.idx));c.onDeleteRows(a,{allRowsSelected:u.allRowsSelected,numRows:e,callback:()=>{u.setSelectedRows(new Set)}})},disabled:u.allRowsSelected&&p,tooltip:{content:{side:"bottom",text:u.allRowsSelected&&p?"Table truncation is not supported when impersonating a role":void 0}},children:u.allRowsSelected?"Delete all rows in table":u.selectedRows.size>1?"Delete ".concat(u.selectedRows.size," rows"):"Delete ".concat(u.selectedRows.size," row")}),(0,s.jsxs)(ei.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"Header.tsx",children:[(0,s.jsx)(ei.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"Header.tsx",children:(0,s.jsx)(W.$,{type:"default",size:"tiny",iconRight:(0,s.jsx)(l.A,{}),loading:g,disabled:g,"data-sentry-element":"Button","data-sentry-source-file":"Header.tsx",children:"Export"})}),(0,s.jsxs)(ei.SQ,{className:"w-40","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"Header.tsx",children:[(0,s.jsx)(ei._2,{onClick:k,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"Header.tsx",children:(0,s.jsx)("span",{className:"text-foreground-light",children:"Export to CSV"})}),(0,s.jsx)(ei._2,{onClick:E,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"Header.tsx",children:"Export to SQL"})]})]}),!u.allRowsSelected&&w>j.length&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-6 ml-0.5",children:(0,s.jsx)(eo.w,{orientation:"vertical"})}),(0,s.jsx)(W.$,{type:"text",onClick:()=>A(),children:"Select all rows in table"})]})]})}},86401:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},87598:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},93274:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(80263),n=a(65325);let r=e=>{let{resourceText:t,isFullPage:a=!1}=e,r=()=>(0,s.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(n.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return a?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)("div",{className:"w-[550px]",children:(0,s.jsx)(r,{})})}):(0,s.jsx)(r,{})}},96240:(e,t,a)=>{a.d(t,{A:()=>ef});var s=a(80263),n=a(60045),r=a(53667),i=a.n(r),l=a(97318),o=a(77072),c=a(53239),d=a(82489),u=a(98662),m=a(96591),p=a(98303),x=a(34398),h=a(98474),f=a(79319),g=a(94330),b=a(21292),y=a(15665),v=a(33096),j=a(7677),w=a(52213),N=a(65904),S=a(89756),A=a(7298),_=a(36365),k=a(9594),E=a(98883),R=a(16601),T=a(10738),C=a(44728),L=a(27863),I=a(63505),z=a(45969),M=a(78960),D=a(95137),P=a.n(D),O=a(86401),q=a(81372),W=a(12015),H=a(87467),F=a(26629),B=a(10822),V=a(94328),$=a(19692),J=a(63320),U=a.n(J),Q=a(77191),G=a.n(Q),Z=a(73969),K=a(12532),Y=a(83745),X=a(5942),ee=a(69223),et=a(58604),ea=a(88688),es=a(30873),en=a(97195),er=a(41518),ei=a(90206),el=a(79175),eo=a(2),ec=a(52491),ed=a(3732),eu=a(33656);let em=e=>{let{entity:t,isActive:a,tableHasLints:n,viewHasLints:r,materializedViewHasLints:i}=e,l="";switch(t.type){case v.z.TABLE:n&&(l="RLS disabled");break;case v.z.VIEW:r&&(l="Security definer view");break;case v.z.MATERIALIZED_VIEW:i&&(l="Security definer view");break;case v.z.FOREIGN_TABLE:l="RLS is not enforced on foreign tables"}return l?(0,s.jsxs)(ed.m_,{disableHoverableContent:!0,children:[(0,s.jsx)(ed.k$,{className:"min-w-4",children:(0,s.jsx)($.A,{size:14,strokeWidth:2,className:(0,eo.cn)("min-w-4",a?"text-warning-600":"text-warning-500")})}),(0,s.jsx)(ed.ZI,{side:"bottom",children:(0,s.jsx)("span",{children:l})})]}):null},ep=e=>{let{id:t,projectRef:a,item:n,isLocked:r,isActive:i}=e,{project:l}=(0,z.Om)(),o=(0,k.ap)(),{selectedSchema:c}=(0,A.k)(),u=(0,m.mh)(),p=(0,el.lW)(n.type,{id:n.id}),x=(0,el.IT)(a),h=!!u&&x.previewTabId===p,f=Object.values((0,K.s)(x).tabsMap).some(e=>{var t;return(null==(t=e.metadata)?void 0:t.tableId)===n.id}),g=Number(t)===n.id,b=g&&!r,{data:y=[]}=(0,ea.b)({projectRef:null==l?void 0:l.ref}),j=(0,ee.t)(n.name,"rls_disabled_in_public",["ERROR"],y,c).hasLint,N=(0,ee.t)(n.name,"security_definer_view",["ERROR","WARN"],y,c).hasLint,S=(0,ee.t)(n.name,"materialized_view_in_api",["ERROR","WARN"],y,c).hasLint,_=async()=>{if(d.pe&&!(null==l?void 0:l.connectionString))return console.error("Connection string is required");let e=Z.oR.loading("Exporting ".concat(n.name," as CSV..."));try{let t=await (0,w.Ap)({id:n.id,projectRef:a,connectionString:null==l?void 0:l.connectionString});if((0,en.KO)(t)&&t.live_rows_estimate>Y.Jv)return Z.oR.error((0,s.jsx)("div",{className:"text-foreground prose text-sm",children:Y.RH}),{id:e});let r=t&&(0,X.rH)(t);if(!r)return Z.oR.error("Failed to export table: ".concat(n.name),{id:e});let i=(await (0,er.HQ)({projectRef:a,connectionString:null==l?void 0:l.connectionString,table:r})).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e));if(i.length>0){let e=G().unparse(i,{columns:r.columns.map(e=>e.name)}),t=new Blob([e],{type:"text/csv;charset=utf-8;"});P()(t,"".concat(n.name,"_rows.csv"))}Z.oR.success("Successfully exported ".concat(n.name," as CSV"),{id:e})}catch(t){Z.oR.error("Failed to export table: ".concat(t.message),{id:e})}},E=async()=>{if(d.pe&&!(null==l?void 0:l.connectionString))return console.error("Connection string is required");let e=Z.oR.loading("Exporting ".concat(n.name," as SQL..."));try{let t=await (0,w.Ap)({id:n.id,projectRef:a,connectionString:null==l?void 0:l.connectionString});if((0,en.KO)(t)&&t.live_rows_estimate>Y.Jv)return Z.oR.error((0,s.jsx)("div",{className:"text-foreground prose text-sm",children:Y.RH}),{id:e});let r=t&&(0,X.rH)(t);if(!r)return Z.oR.error("Failed to export table: ".concat(n.name),{id:e});let i=(await (0,er.HQ)({projectRef:a,connectionString:null==l?void 0:l.connectionString,table:r})).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e));if(i.length>0){let e=(0,ee.S)(r,i),t=new Blob([e],{type:"text/sql;charset=utf-8;"});P()(t,"".concat(n.name,"_rows.sql"))}Z.oR.success("Successfully exported ".concat(n.name," as SQL"),{id:e})}catch(t){Z.oR.error("Failed to export table: ".concat(t.message),{id:e})}};return(0,s.jsx)(es.tv,{title:n.name,id:String(n.id),href:"/project/".concat(a,"/editor/").concat(n.id,"?schema=").concat(n.schema),role:"button","aria-label":"View ".concat(n.name),className:(0,eo.cn)((0,ec.u2)({isSelected:g&&!h,isOpened:f&&!h,isPreview:h}),"px-4"),onDoubleClick:e=>{e.preventDefault();let t=(0,el.lW)(n.type,{id:n.id});(0,el.UH)(a,t)},"data-sentry-element":"EditorTablePageLink","data-sentry-component":"EntityListItem","data-sentry-source-file":"EntityListItem.tsx",children:(0,s.jsxs)(s.Fragment,{children:[g&&(0,s.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),(0,s.jsxs)(ed.m_,{disableHoverableContent:!0,"data-sentry-element":"Tooltip","data-sentry-source-file":"EntityListItem.tsx",children:[(0,s.jsx)(ed.k$,{className:"min-w-4","data-sentry-element":"TooltipTrigger","data-sentry-source-file":"EntityListItem.tsx",children:(0,s.jsx)(et.L,{type:n.type,isActive:g,"data-sentry-element":"EntityTypeIcon","data-sentry-source-file":"EntityListItem.tsx"})}),(0,s.jsx)(ed.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"EntityListItem.tsx",children:(e=>{var t,a,s,n;return null==(n=Object.entries(v.z).find(t=>{let[,a]=t;return a===e}))||null==(s=n[0])||null==(a=s.toLowerCase())||null==(t=a.split("_"))?void 0:t.join(" ")})(n.type)})]}),(0,s.jsxs)("div",{className:(0,eo.cn)("truncate","overflow-hidden text-ellipsis whitespace-nowrap flex items-center gap-2 relative w-full",g&&"text-foreground"),children:[(0,s.jsx)("span",{className:(0,eo.cn)(g?"text-foreground":"text-foreground-light group-hover:text-foreground","text-sm","transition","truncate"),children:n.name}),(0,s.jsx)(em,{entity:n,isActive:g,tableHasLints:j,viewHasLints:N,materializedViewHasLints:S,"data-sentry-element":"EntityTooltipTrigger","data-sentry-source-file":"EntityListItem.tsx"})]}),b&&(0,s.jsxs)(eu.rI,{children:[(0,s.jsx)(eu.ty,{className:"text-foreground-lighter transition-all text-transparent group-hover:text-foreground data-[state=open]:text-foreground",children:(0,s.jsx)(O.A,{size:14,strokeWidth:2})}),(0,s.jsxs)(eu.SQ,{side:"bottom",align:"start",className:"w-44",children:[(0,s.jsxs)(eu._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),(0,ei.lW)(n.name)},children:[(0,s.jsx)(q.A,{size:12}),(0,s.jsx)("span",{children:"Copy name"})]},"copy-name"),n.type===v.z.TABLE&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eu.mB,{}),(0,s.jsxs)(eu._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),o.onEditTable()},children:[(0,s.jsx)(W.A,{size:12}),(0,s.jsx)("span",{children:"Edit table"})]},"edit-table"),(0,s.jsxs)(eu._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),o.onDuplicateTable()},children:[(0,s.jsx)(H.A,{size:12}),(0,s.jsx)("span",{children:"Duplicate table"})]},"duplicate-table"),(0,s.jsx)(eu._2,{className:"space-x-2",asChild:!0,children:(0,s.jsxs)(U(),{href:"/project/".concat(a,"/auth/policies?schema=").concat(c,"&search=").concat(n.id),children:[(0,s.jsx)(F.A,{size:12}),(0,s.jsx)("span",{children:"View policies"})]},"view-policies")},"view-policies"),(0,s.jsxs)(eu.lv,{children:[(0,s.jsxs)(eu.nV,{className:"gap-x-2",children:[(0,s.jsx)(B.A,{size:12}),"Export data"]}),(0,s.jsxs)(eu.M5,{children:[(0,s.jsx)(eu._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),_()},children:(0,s.jsx)("span",{children:"Export table as CSV"})},"download-table-csv"),(0,s.jsx)(eu._2,{className:"gap-x-2",onClick:e=>{e.stopPropagation(),E()},children:(0,s.jsx)("span",{children:"Export table as SQL"})},"download-table-sql")]})]}),(0,s.jsx)(eu.mB,{}),(0,s.jsxs)(eu._2,{className:"gap-x-2",onClick:e=>{e.stopPropagation(),o.onDeleteTable()},children:[(0,s.jsx)(V.A,{size:12}),(0,s.jsx)("span",{children:"Delete table"})]},"delete-table")]})]})]})]})})};var ex=a(2767);let eh=()=>(0,s.jsx)(I.Q5,{title:"No tables or views",description:"Any tables or views you create will be listed here.",className:"mx-4","data-sentry-element":"InnerSideBarEmptyPanel","data-sentry-component":"TableMenuEmptyState","data-sentry-source-file":"TableMenuEmptyState.tsx",children:(0,s.jsx)("div",{className:"top-0 left-6 flex flex-col opacity-50 cursor-not-allowed bg-dash-sidebar h-content -mb-7 pointer-events-none scale-75",children:(0,s.jsxs)("div",{className:"relative h-content",children:[(0,s.jsxs)("div",{className:"absolute inset-0 pointer-events-none z-10",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-transparent from-80% to-100% to-background-surface-100 dark:to-background-surface-75"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent from-50% to-100% to-background-surface-100 dark:to-background-surface-75"})]}),(0,s.jsx)("div",{className:"absolute left-[150px] bottom-[21px] text-foreground-muted z-10 pointer-events-none",children:(0,s.jsx)(ex.A,{size:16,className:"text-foreground-light",strokeWidth:1.5,"data-sentry-element":"Pointer","data-sentry-source-file":"TableMenuEmptyState.tsx"})}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"border-l pointer-events-none",children:(0,s.jsxs)("div",{className:(0,eo.cn)("group",(0,ec.u2)({isSelected:2===t,isOpened:2===t,isPreview:!1}),"px-4 min-w-40"),"aria-selected":2===t,children:[2===t&&(0,s.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),(0,s.jsx)(et.L,{type:"r"}),"postgres_table_".concat(t)]})},"some-".concat(t)))]})})}),ef=()=>{var e,t,a;let{ref:r,id:D}=(0,d.g)(),P=(0,u.d)(),O=D?Number(D):void 0,q=(0,k.ap)(),W=(0,m.mh)(),{selectedSchema:H,setSelectedSchema:F}=(0,A.k)(),[B,V]=(0,c.useState)(!1),[$,J]=(0,c.useState)(""),[U,Q]=(0,c.useState)(Object.values(v.z)),[G,Z]=(0,S.M)("table-editor-sort","alphabetical"),{project:K}=(0,z.Om)(),{data:Y,isLoading:X,isSuccess:ee,isError:et,error:ea,hasNextPage:es,isFetchingNextPage:en,fetchNextPage:er}=(0,j.kD)({projectRef:null==K?void 0:K.ref,connectionString:null==K?void 0:K.connectionString,schemas:[H],search:$.trim()||void 0,sort:G,filterTypes:U},{keepPreviousData:!!$}),ei=(0,c.useMemo)(()=>null==Y?void 0:Y.pages.flatMap(e=>e.data.entities),[null==Y?void 0:Y.pages]),{data:el}=(0,y.w$)({projectRef:null==K?void 0:K.ref,connectionString:null==K?void 0:K.connectionString}),eo=null==el?void 0:el.find(e=>e.name===H),ec=(0,N.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"tables"),[ed]=i()((null!=el?el:[]).sort((e,t)=>e.name.localeCompare(t.name)),e=>{var t;return _.i.includes(null!=(t=null==e?void 0:e.name)?t:"")}),eu=ed.some(e=>e.id===(null==eo?void 0:eo.id)),{data:em}=(0,w.Pk)({projectRef:null==K?void 0:K.ref,connectionString:null==K?void 0:K.connectionString,id:O});return(0,c.useEffect)(()=>{(null==em?void 0:em.schema)&&F(em.schema)},[null==em?void 0:em.schema]),(0,c.useEffect)(()=>{W&&r&&ei&&!$&&(0,M.w)({ref:r,schemas:[H],entities:ei})},[ei]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col flex-grow gap-5 pt-5 h-full",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-1.5",children:[(0,s.jsx)(b.A,{className:"mx-4",selectedSchemaName:H,onSelectSchema:e=>{J(""),F(e)},onSelectCreateSchema:()=>q.onAddSchema(),"data-sentry-element":"SchemaSelector","data-sentry-source-file":"TableEditorMenu.tsx"}),(0,s.jsx)("div",{className:"grid gap-3 mx-4",children:eu?(0,s.jsxs)(E.Fc,{children:[(0,s.jsx)(E.XL,{className:"text-sm",children:"Viewing protected schema"}),(0,s.jsxs)(E.TN,{className:"text-xs",children:[(0,s.jsx)("p",{className:"mb-2",children:"This schema is managed by Supabase and is read-only through the table editor"}),(0,s.jsx)(R.$,{type:"default",size:"tiny",onClick:()=>V(!0),children:"Learn more"})]})]}):(0,s.jsx)(f.G,{block:!0,title:"Create a new table",name:"New table",disabled:!ec,size:"tiny",icon:(0,s.jsx)(l.A,{size:14,strokeWidth:1.5,className:"text-foreground-muted"}),type:"default",className:"justify-start",onClick:q.onAddTable,tooltip:{content:{side:"bottom",text:ec?void 0:"You need additional permissions to create tables"}},children:"New table"})})]}),(0,s.jsxs)("div",{className:"flex flex-auto flex-col gap-2 pb-4",children:[(0,s.jsxs)(I.a0,{className:"mx-2","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,s.jsx)(I.RK,{autoFocus:!P,name:"search-tables",value:$,placeholder:"Search tables...","aria-labelledby":"Search tables",onChange:e=>J(e.target.value),"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,s.jsxs)(I.i9,{value:G,onValueChange:e=>Z(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,s.jsx)(I.Pl,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"TableEditorMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,s.jsx)(I.Pl,{value:"grouped-alphabetical","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"TableEditorMenu.tsx",children:"Entity Type"},"grouped-alphabetical")]})}),(0,s.jsxs)(T.AM,{"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,s.jsx)(T.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,s.jsx)(R.$,{type:5!==U.length?"default":"dashed",className:"h-[32px] md:h-[28px] px-1.5",icon:(0,s.jsx)(o.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"TableEditorMenu.tsx"})}),(0,s.jsx)(T.hl,{className:"p-0 w-56",side:"bottom",align:"center","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,s.jsxs)("div",{className:"px-3 pt-3 pb-2 flex flex-col gap-y-2",children:[(0,s.jsx)("p",{className:"text-xs",children:"Show entity types"}),(0,s.jsx)("div",{className:"flex flex-col",children:Object.entries(v.z).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"group flex items-center justify-between py-0.5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)(C.S,{id:t,name:t,checked:U.includes(a),onCheckedChange:()=>{U.includes(a)?Q(U.filter(e=>e!==a)):Q(U.concat([a]))}}),(0,s.jsx)(L.J,{htmlFor:t,className:"capitalize text-xs",children:t.toLowerCase().replace("_"," ")})]}),(0,s.jsx)(R.$,{size:"tiny",type:"default",onClick:()=>Q([a]),className:"transition opacity-0 group-hover:opacity-100 h-auto px-1 py-0.5",children:"Select only"})]},t)})})]})})]})]}),X&&(0,s.jsx)(x.A,{}),et&&(0,s.jsx)("div",{className:"mx-4",children:(0,s.jsx)(h.A,{error:null!=ea?ea:null,subject:"Failed to retrieve tables"})}),ee&&(0,s.jsxs)(s.Fragment,{children:[0===$.length&&(null!=(e=null==ei?void 0:ei.length)?e:0)<=0&&(0,s.jsx)(eh,{}),$.length>0&&(null!=(t=null==ei?void 0:ei.length)?t:0)<=0&&(0,s.jsx)(I.Q5,{className:"mx-2",title:"No results found",description:'Your search for "'.concat($,'" did not return any results')}),(null!=(a=null==ei?void 0:ei.length)?a:0)>0&&(0,s.jsx)("div",{className:"flex flex-1 flex-grow","data-testid":"tables-list",children:(0,s.jsx)(g.A,{items:ei,ItemComponent:ep,itemProps:{projectRef:null==K?void 0:K.ref,id:Number(O),isLocked:eu},getItemSize:()=>28,hasNextPage:es,isLoadingNextPage:en,onLoadNextPage:()=>er()})})]})]})]}),(0,s.jsx)(p.b,{visible:B,onClose:()=>V(!1),"data-sentry-element":"ProtectedSchemaModal","data-sentry-source-file":"TableEditorMenu.tsx"})]})}},98040:(e,t,a)=>{a.d(t,{A:()=>g});var s=a(80263),n=a(10726),r=a(33584),i=a.n(r),l=a(53239),o=a(48591),c=a(33745),d=a(71787),u=a(77690),m=a(2),p=a(34214);let x=(0,l.createContext)({onChange:e=>{},selected:void 0});var h=a(64238);function f(e){let{children:t,className:a,buttonClassName:r,descriptionText:h,error:f,icon:g,id:b="",name:y="",label:v,labelOptional:j,layout:w,value:N,onChange:S,onFocus:A,onBlur:_,style:k,size:E="medium",defaultValue:R,validation:T,disabled:C,optionsWidth:L}=e,[I,z]=(0,l.useState)(void 0),[M,D]=(0,l.useState)({}),P=(0,u.A)("listbox"),O=(0,l.useRef)(null),{formContextOnChange:q,values:W,errors:H,handleBlur:F,touched:B,fieldLevelValidation:V}=(0,p.x)();W&&!N&&(N=W[b||y],R=W[b||y]),f||(H&&!f&&(f=H[b||y]),f=B&&B[b||y]?f:void 0),(0,l.useEffect)(()=>{void 0!==N&&z(N)},[N]),(0,l.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(L||(null==(e=O.current)?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,l.useEffect)(()=>{var e;let a=i()(t);function s(e){return a.find(t=>t.props.value===e)}if(N){z(N);let e=s(N);D((null==e?void 0:e.props)?e.props:void 0);return}if(I){let e=s(I);D((null==e?void 0:e.props)?e.props:void 0);return}if(R){z(R);let e=s(I);D((null==e?void 0:e.props)?e.props:void 0);return}D(null==(e=a[0])?void 0:e.props)},[I]);let $=[P.container,P.base,r],J=[P.addOnBefore];return f&&$.push(P.variants.error),f||$.push(P.variants.standard),g&&J.push(P.with_icon),E&&$.push(P.size[E]),C&&$.push(P.disabled),(0,s.jsx)(o.H,{label:v,labelOptional:j,layout:w,id:b,error:f,descriptionText:h,className:a,style:k,size:E,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,s.jsxs)(n.bL,{"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:[(0,s.jsx)(n.l9,{asChild:!0,disabled:C,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,s.jsxs)("button",{"data-size":E,ref:O,className:(0,m.cn)($),onBlur:function(e){F&&F(e),_&&_(e)},onFocus:A,name:y,id:b,children:[(0,s.jsxs)("span",{className:(0,m.cn)(J),children:[g&&(0,s.jsx)(d.A,{size:E,icon:g}),(null==M?void 0:M.addOnBefore)&&(0,s.jsx)(M.addOnBefore,{}),(0,s.jsx)("span",{className:P.label,children:null==M?void 0:M.label})]}),(0,s.jsx)("span",{className:P.chevron_container,children:(0,s.jsx)("svg",{className:P.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),f&&(0,s.jsx)("div",{className:P.actions_container,children:f&&(0,s.jsx)(c.A,{size:E})})]})}),(0,s.jsx)(n.UC,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:P.options_container,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,s.jsx)("div",{children:(0,s.jsx)(x.Provider,{value:{onChange:function(e){S&&S(e),z(e);let t={};t.target={type:"select",name:y,id:b,value:e,checked:void 0},q&&q(t),T&&V(b,T(e))},selected:I},"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:t})})})]})})}f.Option=function(e){let{id:t,value:a,label:r,disabled:i=!1,children:l,className:o="",addOnBefore:c}=e,d=(0,u.A)("listbox");return(0,s.jsx)(x.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:r,selected:u}=e,p=u===a;return(0,s.jsxs)(n.q7,{className:(0,m.cn)(d.option,p?d.option_active:" ",i?d.option_disabled:" ",o),onSelect:()=>i?{}:r(a),children:[(0,s.jsxs)("div",{className:d.option_inner,children:[c&&c({active:p,selected:u}),(0,s.jsx)("span",{children:"function"==typeof l?l({active:p,selected:u}):l})]}),p?(0,s.jsx)("span",{className:(0,m.cn)(d.option_check,p?d.option_check_active:""),children:(0,s.jsx)(h.A,{className:d.option_check_icon,"aria-hidden":"true"})}):null]},t)}})};let g=f},98911:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(80263),n=a(2);let r=e=>{let{max:t=100,value:a=0,barClass:r="bg-foreground",bgClass:i="",type:l="vertical",borderClass:o="",labelBottom:c="",labelBottomClass:d="tabular-nums",labelTop:u="",labelTopClass:m=""}=e;if("horizontal"===l){let e=Number(a/t*100),l=c||u;return(0,s.jsxs)("div",{className:"flex flex-col w-full",children:[l&&(0,s.jsxs)("div",{className:"flex align-baseline justify-between pb-1 space-x-8",children:[(0,s.jsx)("p",{className:(0,n.cn)("text-foreground text-sm truncate capitalize-sentence",u.length>0&&"max-w-[75%]",d),children:c}),(0,s.jsx)("p",{className:(0,n.cn)("text-foreground-light text-sm",m),children:u})]}),(0,s.jsx)("div",{className:"relative rounded h-1 overflow-hidden w-full border p-0 ".concat(i||"bg-surface-400"," ").concat(o||"border-none"),children:(0,s.jsx)("div",{className:"absolute rounded inset-x-0 bottom-0 h-1 ".concat(r," transition-all"),style:{width:"".concat(e,"%")}})})]})}{let e=Number(a/t*35);return e<2&&(e=2),(0,s.jsx)("div",{className:"relative rounded w-5 overflow-hidden border p-1 ".concat(i||"bg-gray-400"," ").concat(o||"border-none"),style:{height:35},children:(0,s.jsx)("div",{className:"absolute inset-x-0 bottom-0 w-5 ".concat(r),style:{height:e}})})}}}}]);