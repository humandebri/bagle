# 営業日カレンダー機能 セットアップガイド

## 1. Supabaseでテーブルを作成

### 手順

1. [Supabaseダッシュボード](https://app.supabase.com)にログイン

2. プロジェクトを選択

3. 左側メニューから「SQL Editor」を選択

4. 新しいクエリを作成し、以下のファイルの内容をコピー＆ペースト：
   ```
   app/admin/business-calendar/sql/create_tables_supabase.sql
   ```

5. 「Run」ボタンをクリックして実行

6. 成功メッセージが表示されることを確認

### 確認事項

実行後、以下のテーブルが作成されているか確認：
- `business_days` - 営業日管理
- `business_hours` - 営業時間管理
- `recurring_holidays` - 定期休業日管理

## 2. 動作確認

### 管理画面の確認

1. 開発サーバーを起動
   ```bash
   npm run dev
   ```

2. 管理者アカウントでログイン

3. 管理画面にアクセス
   ```
   http://localhost:3000/admin/business-calendar
   ```

4. 各タブが正しく表示されることを確認
   - カレンダータブ
   - 営業時間タブ
   - 定期休業日タブ

### フロントエンドの確認

1. ホームページにアクセス
   ```
   http://localhost:3000
   ```

2. 営業日カレンダーセクションまでスクロール

3. カレンダーが表示されることを確認

## 3. テストデータの追加（オプション）

管理画面から以下のテストデータを追加してみてください：

### カレンダータブ
- 任意の日付をクリック
- 「休業日」に変更して保存
- カレンダーに赤色で表示されることを確認

### 営業時間タブ
- 任意の曜日の「編集」をクリック
- 営業時間を変更して保存
- 一覧に反映されることを確認

### 定期休業日タブ
- 「新規追加」をクリック
- パターン名：「第2火曜日」
- 設定して保存

## 4. トラブルシューティング

### エラー: relation "business_days" does not exist
- SQLが正しく実行されていません
- SQL Editorで再度実行してください

### エラー: permission denied
- RLSポリシーが正しく設定されていない可能性があります
- 管理者権限でログインしているか確認してください

### カレンダーが表示されない
1. ブラウザのコンソールでエラーを確認
2. ネットワークタブでAPIレスポンスを確認
3. Supabaseのログを確認

### 保存できない
1. 管理者権限があるか確認
   ```sql
   SELECT * FROM profiles WHERE user_id = 'あなたのuser_id';
   ```
2. is_adminがtrueになっているか確認

## 5. 本番環境へのデプロイ

1. 本番環境のSupabaseでも同じSQLを実行

2. 環境変数が正しく設定されているか確認
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`

3. デプロイ後、動作確認を実施

## サポート

問題が解決しない場合は、以下の情報を含めてお問い合わせください：
- エラーメッセージ
- ブラウザコンソールのログ
- 実行した手順